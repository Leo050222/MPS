{
  "Problem_ID": 36,
  "Chunk_Type": "T3",
  "Class_ID": "D1961",
  "Multiple_Synthesis_Class": "MP2",
  "Sub_Class_ID": [
    {
      "A747": "A747_DG_1"
    },
    {
      "A1561": "A1561_DG_1"
    }
  ],
  "Synthesis_Trace": "DG-DG",
  "Synthesis_Status": "Continuable",
  "Math_Problem": "Let $S$ be the set $\\{1,2, \\ldots, 2012\\}$. A perfectutation is a bijective function $h$ from $S$ to itself such that there exists an $a \\in S$ such that $h(a) \\neq a$, and that for any pair of integers $a \\in S$ and $b \\in S$ such that $h(a) \\neq a, h(b) \\neq b$, there exists a positive integer $k$ such that $h^{k}(a)=b$. Let $n$ be the number of ordered pairs of perfectutations $(f, g)$ such that $f(g(i))=g(f(i))$ for all $i \\in S$, but $f \\neq g$. Find the remainder when $n$ is divided by 2011. Instead of determining the remainder when the number of ordered pairs of distinct commuting perfectutations is divided by the prime, simply find $m = p - 2010$, where $p$ is that prime. Find the largest positive integer $n$ for which there exist $n$ finite sets $X_{1}, X_{2}, \\ldots, X_{n}$ with the property that for every $m \\leq a<b<c \\leq n$, the equation $\\left|X_{a} \\cup X_{b} \\cup X_{c}\\right|=\\lceil\\sqrt{a b c}\\rceil$ holds.",
  "Connecting_Sentence": [
    {
      "A747": "Instead of determining the remainder when the number of ordered pairs of distinct commuting perfectutations is divided by the prime, simply find $m = p - 2010$, where $p$ is that prime."
    },
    {
      "A1561": "None"
    }
  ],
  "Synthesised_By": [
    {
      "A747": "Let $S$ be the set \\{1,2, \\ldots, 2012\\}. A perfectutation is a bijective function $h$ from $S$ to itself such that there exists an $a \\in S$ such that $h(a) \\neq a$, and that for any pair of integers $a \\in S$ and $b \\in S$ such that $h(a) \\neq a, h(b) \\neq b$, there exists a positive integer $k$ such that $h^{k}(a)=b$. Let $n$ be the number of ordered pairs of perfectutations $(f, g)$ such that $f(g(i))=g(f(i))$ for all $i \\in S$, but $f \\neq g$. Find the remainder when $n$ is divided by 2011 . Instead of determining the remainder when the number of ordered pairs of distinct commuting perfectutations is divided by the prime, simply find $m = p - 2010$, where $p$ is that prime."
    },
    {
      "A1561": "Find the largest positive integer \\(n\\) for which there exist \\(n\\) finite sets \\(X_{1}, X_{2}, \\ldots, X_{n}\\) with the property that for every \\(1 \\leq a<b<c \\leq n\\), the equation \\(\\left|X_{a} \\cup X_{b} \\cup X_{c}\\right|=\\lceil\\sqrt{a b c}\\rceil\\) holds."
    }
  ],
  "Original_Problem": [
    {
      "A747": "Let $S$ be the set \\{1,2, \\ldots, 2012\\}. A perfectutation is a bijective function $h$ from $S$ to itself such that there exists an $a \\in S$ such that $h(a) \\neq a$, and that for any pair of integers $a \\in S$ and $b \\in S$ such that $h(a) \\neq a, h(b) \\neq b$, there exists a positive integer $k$ such that $h^{k}(a)=b$. Let $n$ be the number of ordered pairs of perfectutations $(f, g)$ such that $f(g(i))=g(f(i))$ for all $i \\in S$, but $f \\neq g$. Find the remainder when $n$ is divided by 2011 ."
    },
    {
      "A1561": "Find the largest positive integer \\(n\\) for which there exist \\(n\\) finite sets \\(X_{1}, X_{2}, \\ldots, X_{n}\\) with the property that for every \\(1 \\leq a<b<c \\leq n\\), the equation \\(\\left|X_{a} \\cup X_{b} \\cup X_{c}\\right|=\\lceil\\sqrt{a b c}\\rceil\\) holds."
    }
  ],
  "Problem_Type": [
    {
      "A747": [
        "Mathematics -> Discrete Mathematics -> Combinatorics"
      ]
    },
    {
      "A1561": [
        "Mathematics -> Discrete Mathematics -> Combinatorics",
        "Mathematics -> Algebra -> Intermediate Algebra -> Inequalities"
      ]
    }
  ],
  "Problem_Level": [
    {
      "A747": "KbsdJames_Omni-MATH_5.25"
    },
    {
      "A1561": "KbsdJames_Omni-MATH_5.0"
    }
  ],
  "Problem_Source": [
    {
      "A747": "HMMT_2"
    },
    {
      "A1561": "HMMT_2"
    }
  ],
  "Problem_Length": [
    {
      "A747": 501
    },
    {
      "A1561": 259
    }
  ],
  "Synthesised_Problem_Length": 938,
  "Ground_Truth": [
    {
      "A747": "2"
    },
    {
      "A1561": "4"
    }
  ],
  "Predicted_Answer": [
    {
      "A747": "2"
    },
    {
      "A1561": "4"
    }
  ],
  "Connecting_Point": [
    {
      "B1961": {
        "1": "(p - 2010)"
      }
    }
  ],
  "Delta_Factor": [
    {
      "A747": 0.14
    },
    {
      "A1561": 0.25
    }
  ],
  "Delta_Value": [
    {
      "A747": {
        "p": "2011"
      }
    },
    {
      "A1561": {
        "|X4|": "2"
      }
    }
  ],
  "Delta_Depth": [
    {
      "A747": {
        "p": 5
      }
    },
    {
      "A1561": {
        "|X4|": 10
      }
    }
  ],
  "Delta_Source": [
    {
      "A747": "derived"
    },
    {
      "A1561": "derived"
    }
  ],
  "Delta_Value_Order": [
    {
      "A747": 1
    },
    {
      "A1561": 1
    }
  ],
  "Delta_Variable_Names": [
    {
      "A747": [
        "p"
      ]
    },
    {
      "A1561": [
        "X"
      ]
    }
  ],
  "Delta_Socket": [
    {
      "A747": {
        "2011": 2011.0
      }
    },
    {
      "A1561": {
        "1": 1.0
      }
    }
  ],
  "Source_Delta_Socket": [
    {
      "A747": "goal"
    },
    {
      "A1561": "goal"
    }
  ],
  "Delta_Socket_Order": [
    {
      "A747": 1
    },
    {
      "A1561": 1
    }
  ],
  "Variable_Names": [
    {
      "A747": [
        "S",
        "h",
        "a",
        "b",
        "k",
        "n",
        "f",
        "g",
        "i"
      ]
    },
    {
      "A1561": []
    }
  ],
  "Total_Claims": [
    {
      "A747": 37
    },
    {
      "A1561": 40
    }
  ],
  "Total_Delta": [
    {
      "A747": 1
    },
    {
      "A1561": 1
    }
  ],
  "Total_Delta_Socket": [
    {
      "A747": 1
    },
    {
      "A1561": 1
    }
  ],
  "Max_Delta_Factor": [
    {
      "A747": 0.14
    },
    {
      "A1561": 0.25
    }
  ],
  "Min_Delta_Factor": [
    {
      "A747": 0.14
    },
    {
      "A1561": 0.25
    }
  ],
  "Max_Delta_Depth": [
    {
      "A747": 5
    },
    {
      "A1561": 10
    }
  ],
  "Min_Delta_Depth": [
    {
      "A747": 5
    },
    {
      "A1561": 10
    }
  ],
  "Claims": [
    {
      "id": "A747_C1",
      "type": "goal",
      "expr": "Find the remainder when n is divided by 2011, where n is the number of ordered pairs (f,g) of perfectutations with f ≠ g and f ∘ g = g ∘ f"
    },
    {
      "id": "A747_C2",
      "type": "context",
      "expr": "S = {1, 2, …, 2012}"
    },
    {
      "id": "A747_C3",
      "type": "context",
      "expr": "2011 is a prime number"
    },
    {
      "id": "A747_C4",
      "type": "context",
      "expr": "A perfectutation is a bijection h: S → S such that there exists a ∈ S with h(a) ≠ a, and all non-fixed points are in a single cycle"
    },
    {
      "id": "A747_C5",
      "type": "derived",
      "expr": "p = 2011"
    },
    {
      "id": "A747_C6",
      "type": "derived",
      "expr": "The number of perfectutations f with exactly k fixed points is \binom{2012}{k} (2011 - k)! for 0 ≤ k ≤ 2010"
    },
    {
      "id": "A747_C7",
      "type": "derived",
      "expr": "For such f, let B be the set of fixed points of f, |B| = k; A = S \\ B, |A| = m = 2012 - k"
    },
    {
      "id": "A747_C8",
      "type": "derived",
      "expr": "If f(g(i)) = g(f(i)) for all i, then g(B) = B and g(A) = A"
    },
    {
      "id": "A747_C9",
      "type": "derived",
      "expr": "Since g is a perfectutation, its unique cycle of length ≥ 2 is entirely contained in A or entirely in B"
    },
    {
      "id": "A747_C10",
      "type": "derived",
      "expr": "Case 1: The cycle is in B, so g fixes A pointwise, and g|_B is a perfectutation on B"
    },
    {
      "id": "A747_C11",
      "type": "derived",
      "expr": "The number of such g|_B is \\sum_{l=2}^{k} \binom{k}{l} (l-1)!"
    },
    {
      "id": "A747_C12",
      "type": "derived",
      "expr": "\\sum_{l=2}^{k} \binom{k}{l} (l-1)! = \\sum_{m=0}^{k-2} \frac{k!}{m! (k-m)}"
    },
    {
      "id": "A747_C13",
      "type": "derived",
      "expr": "Case 2: The cycle is in A, so g fixes B pointwise, and g|_A is a perfectutation on A that commutes with f|_A"
    },
    {
      "id": "A747_C14",
      "type": "derived",
      "expr": "f|_A is an m-cycle"
    },
    {
      "id": "A747_C15",
      "type": "derived",
      "expr": "The permutations on A that commute with f|_A are the powers (f|_A)^r for r = 0, 1, …, m-1"
    },
    {
      "id": "A747_C16",
      "type": "derived",
      "expr": "(f|_A)^r is an m-cycle if and only if gcd(r, m) = 1"
    },
    {
      "id": "A747_C17",
      "type": "derived",
      "expr": "The number of such is φ(m)"
    },
    {
      "id": "A747_C18",
      "type": "derived",
      "expr": "f itself corresponds to r=1 in case 2"
    },
    {
      "id": "A747_C19",
      "type": "derived",
      "expr": "The total number of g commuting with f is \\sum_{j=0}^{k-2} \frac{k!}{j! (k-j)} + φ(2012 - k)"
    },
    {
      "id": "A747_C20",
      "type": "derived",
      "expr": "The number of g ≠ f commuting with f is that minus 1"
    },
    {
      "id": "A747_C21",
      "type": "derived",
      "expr": "n = \\sum_{k=0}^{2010} \binom{2012}{k} (2011 - k)! \\left( \\sum_{j=0}^{k-2} \frac{k!}{j! (k-j)} + φ(2012 - k) - 1 \right)"
    },
    {
      "id": "A747_C23",
      "type": "derived",
      "expr": "2012 ≡ 1 (mod p)"
    },
    {
      "id": "A747_C24",
      "type": "derived",
      "expr": "By Wilson's Theorem, (p-1)! = 2010! ≡ -1 (mod p)"
    },
    {
      "id": "A747_C25",
      "type": "derived",
      "expr": "For k=1, the inner sum from 0 to -1 is 0"
    },
    {
      "id": "A747_C26",
      "type": "derived",
      "expr": "φ(2011) = φ(p) = p-1 = 2010"
    },
    {
      "id": "A747_C27",
      "type": "derived",
      "expr": "For k=1, the expression inside is 0 + 2010 - 1 = 2009"
    },
    {
      "id": "A747_C28",
      "type": "derived",
      "expr": "2009 ≡ -2 (mod 2011)"
    },
    {
      "id": "A747_C29",
      "type": "derived",
      "expr": "\binom{2012}{1} = 2012 ≡ 1 (mod p)"
    },
    {
      "id": "A747_C30",
      "type": "derived",
      "expr": "(2011 - 1)! = 2010! ≡ -1 (mod p)"
    },
    {
      "id": "A747_C31",
      "type": "derived",
      "expr": "The contribution for k=1 is 2012 × 2010! × 2009 ≡ 1 × (-1) × (-2) ≡ 2 (mod p)"
    },
    {
      "id": "A747_C32",
      "type": "derived",
      "expr": "For k=0, (2011 - 0)! = 2011! ≡ 0 (mod p)"
    },
    {
      "id": "A747_C33",
      "type": "derived",
      "expr": "Thus the term for k=0 ≡ 0 (mod p)"
    },
    {
      "id": "A747_C34",
      "type": "derived",
      "expr": "For 2 ≤ k ≤ 2010, \binom{2012}{k} ≡ 0 (mod p) because the numerator includes p and k! not divisible by p (k < p)"
    },
    {
      "id": "A747_C35",
      "type": "derived",
      "expr": "(2011 - k)! ≢ 0 (mod p) for 2 ≤ k ≤ 2010 since 2011 - k ≤ 2009 < p"
    },
    {
      "id": "A747_C36",
      "type": "derived",
      "expr": "Thus the term for 2 ≤ k ≤ 2010 ≡ 0 (mod p)"
    },
    {
      "id": "A747_C37",
      "type": "derived",
      "expr": "All terms for k ≠ 1 ≡ 0 (mod p)"
    },
    {
      "id": "A747_C38",
      "type": "final",
      "expr": "n ≡ 2 (mod 2011)"
    },
    {
      "id": "A1561_C1",
      "type": "derived",
      "expr": "largest positive integer n s.t. exists finite sets X1,...,Xn with |Xa ∪ Xb ∪ Xc| = ceil(sqrt(a b c)) for all 1 ≤ a < b < c ≤ n"
    },
    {
      "id": "A1561_C2",
      "type": "context",
      "expr": "ceil(sqrt(6)) = 3"
    },
    {
      "id": "A1561_C3",
      "type": "context",
      "expr": "ceil(sqrt(8)) = 3"
    },
    {
      "id": "A1561_C4",
      "type": "context",
      "expr": "ceil(sqrt(12)) = 4"
    },
    {
      "id": "A1561_C5",
      "type": "context",
      "expr": "ceil(sqrt(24)) = 5"
    },
    {
      "id": "A1561_C6",
      "type": "context",
      "expr": "ceil(sqrt(10)) = 4"
    },
    {
      "id": "A1561_C7",
      "type": "context",
      "expr": "ceil(sqrt(40)) = 7"
    },
    {
      "id": "A1561_C8",
      "type": "context",
      "expr": "ceil(sqrt(20)) = 5"
    },
    {
      "id": "A1561_C9",
      "type": "context",
      "expr": "for all finite sets A,B,C,D: |A ∪ B ∪ C| + |A ∪ B ∪ D| ≥ |A ∪ B ∪ C ∪ D| ≥ |B ∪ C ∪ D|"
    },
    {
      "id": "A1561_C10",
      "type": "derived",
      "expr": "exist pairwise disjoint finite sets X1,X2,X3,X4 with |X1|=0, |X2|=1, |X3|=2, |X4|=2"
    },
    {
      "id": "A1561_C11",
      "type": "derived",
      "expr": "|X1 ∪ X2 ∪ X3| = 3"
    },
    {
      "id": "A1561_C12",
      "type": "derived",
      "expr": "|X1 ∪ X2 ∪ X4| = 3"
    },
    {
      "id": "A1561_C13",
      "type": "derived",
      "expr": "|X1 ∪ X3 ∪ X4| = 4"
    },
    {
      "id": "A1561_C14",
      "type": "derived",
      "expr": "|X2 ∪ X3 ∪ X4| = 5"
    },
    {
      "id": "A1561_C15",
      "type": "derived",
      "expr": "exists X1,...,X4 satisfying the property for n=4"
    },
    {
      "id": "A1561_C16",
      "type": "derived",
      "expr": "assume exists X1,...,X5 satisfying the property for n=5"
    },
    {
      "id": "A1561_C17",
      "type": "derived",
      "expr": "|X1 ∪ X2 ∪ X4| = 3"
    },
    {
      "id": "A1561_C18",
      "type": "derived",
      "expr": "|X1 ∪ X2 ∪ X5| = 4"
    },
    {
      "id": "A1561_C19",
      "type": "derived",
      "expr": "|X2 ∪ X4 ∪ X5| = 7"
    },
    {
      "id": "A1561_C20",
      "type": "derived",
      "expr": "3 + 4 = 7"
    },
    {
      "id": "A1561_C21",
      "type": "derived",
      "expr": "|X1 ∪ X2 ∪ X4 ∪ X5| ≥ 7"
    },
    {
      "id": "A1561_C22",
      "type": "derived",
      "expr": "7 ≥ |X1 ∪ X2 ∪ X4 ∪ X5|"
    },
    {
      "id": "A1561_C23",
      "type": "derived",
      "expr": "|X1 ∪ X2 ∪ X4 ∪ X5| = 7"
    },
    {
      "id": "A1561_C24",
      "type": "derived",
      "expr": "|(X1 ∪ X2 ∪ X4) ∪ (X1 ∪ X2 ∪ X5)| + |(X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5)| = 7"
    },
    {
      "id": "A1561_C25",
      "type": "derived",
      "expr": "|(X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5)| = 0"
    },
    {
      "id": "A1561_C26",
      "type": "derived",
      "expr": "(X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5) = ∅"
    },
    {
      "id": "A1561_C27",
      "type": "derived",
      "expr": "(X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5) = (X1 ∪ X2) ∪ (X4 ∩ X5)"
    },
    {
      "id": "A1561_C28",
      "type": "derived",
      "expr": "(X1 ∪ X2) ∪ (X4 ∩ X5) = ∅"
    },
    {
      "id": "A1561_C29",
      "type": "derived",
      "expr": "X1 ∪ X2 = ∅"
    },
    {
      "id": "A1561_C30",
      "type": "derived",
      "expr": "X4 ∩ X5 = ∅"
    },
    {
      "id": "A1561_C31",
      "type": "derived",
      "expr": "X1 = ∅ ∧ X2 = ∅"
    },
    {
      "id": "A1561_C32",
      "type": "derived",
      "expr": "|X1 ∪ X4 ∪ X5| = 5"
    },
    {
      "id": "A1561_C33",
      "type": "derived",
      "expr": "|X4 ∪ X5| = 5"
    },
    {
      "id": "A1561_C34",
      "type": "derived",
      "expr": "|X4 ∪ X5| = 7"
    },
    {
      "id": "A1561_C35",
      "type": "derived",
      "expr": "5 = 7"
    },
    {
      "id": "A1561_C36",
      "type": "derived",
      "expr": "contradiction"
    },
    {
      "id": "A1561_C37",
      "type": "derived",
      "expr": "no such X1,...,X5 exist"
    },
    {
      "id": "A1561_C38",
      "type": "derived",
      "expr": "for n ≥ 5, no such X1,...,Xn exist"
    },
    {
      "id": "A1561_C39",
      "type": "derived",
      "expr": "exists for n=4 and not for n > 4"
    },
    {
      "id": "A1561_C40",
      "type": "final",
      "expr": "largest n = 4"
    },
    {
      "id": "B1961_C1",
      "type": "goal",
      "expr": "largest positive integer n s.t. exists finite sets X1,...,Xn with |Xa ∪ Xb ∪ Xc| = ceil(sqrt(a b c)) for all (p - 2010) ≤ a < b < c ≤ n"
    }
  ],
  "Steps": [
    {
      "id": "A747_S1",
      "rule": "problem setup",
      "premises": [
        "A747_C1: Find the remainder when n is divided by 2011, where n is the number of ordered pairs (f,g) of perfectutations with f ≠ g and f ∘ g = g ∘ f"
      ],
      "conclusions": [
        "A747_C2: S = {1, 2, …, 2012}",
        "A747_C3: 2011 is a prime number",
        "A747_C4: A perfectutation is a bijection h: S → S such that there exists a ∈ S with h(a) ≠ a, and all non-fixed points are in a single cycle"
      ]
    },
    {
      "id": "A747_S2",
      "rule": "definition",
      "premises": [
        "A747_C3: 2011 is a prime number"
      ],
      "conclusions": [
        "A747_C5: p = 2011"
      ]
    },
    {
      "id": "A747_S3",
      "rule": "counting perfectutations",
      "premises": [
        "A747_C2: S = {1, 2, …, 2012}",
        "A747_C4: A perfectutation is a bijection h: S → S such that there exists a ∈ S with h(a) ≠ a, and all non-fixed points are in a single cycle"
      ],
      "conclusions": [
        "A747_C6: The number of perfectutations f with exactly k fixed points is \binom{2012}{k} (2011 - k)! for 0 ≤ k ≤ 2010"
      ]
    },
    {
      "id": "A747_S4",
      "rule": "define sets for f",
      "premises": [
        "A747_C6: The number of perfectutations f with exactly k fixed points is \binom{2012}{k} (2011 - k)! for 0 ≤ k ≤ 2010"
      ],
      "conclusions": [
        "A747_C7: For such f, let B be the set of fixed points of f, |B| = k; A = S \\ B, |A| = m = 2012 - k"
      ]
    },
    {
      "id": "A747_S5",
      "rule": "commuting implies set preservation",
      "premises": [
        "A747_C7: For such f, let B be the set of fixed points of f, |B| = k; A = S \\ B, |A| = m = 2012 - k"
      ],
      "conclusions": [
        "A747_C8: If f(g(i)) = g(f(i)) for all i, then g(B) = B and g(A) = A"
      ]
    },
    {
      "id": "A747_S6",
      "rule": "single cycle and set preservation",
      "premises": [
        "A747_C8: If f(g(i)) = g(f(i)) for all i, then g(B) = B and g(A) = A",
        "A747_C4: A perfectutation is a bijection h: S → S such that there exists a ∈ S with h(a) ≠ a, and all non-fixed points are in a single cycle"
      ],
      "conclusions": [
        "A747_C9: Since g is a perfectutation, its unique cycle of length ≥ 2 is entirely contained in A or entirely in B"
      ]
    },
    {
      "id": "A747_S7",
      "rule": "case analysis",
      "premises": [
        "A747_C9: Since g is a perfectutation, its unique cycle of length ≥ 2 is entirely contained in A or entirely in B"
      ],
      "conclusions": [
        "A747_C10: Case 1: The cycle is in B, so g fixes A pointwise, and g|_B is a perfectutation on B"
      ]
    },
    {
      "id": "A747_S8",
      "rule": "counting perfectutations on k elements",
      "premises": [
        "A747_C10: Case 1: The cycle is in B, so g fixes A pointwise, and g|_B is a perfectutation on B",
        "A747_C7: For such f, let B be the set of fixed points of f, |B| = k; A = S \\ B, |A| = m = 2012 - k"
      ],
      "conclusions": [
        "A747_C11: The number of such g|_B is \\sum_{l=2}^{k} \binom{k}{l} (l-1)!"
      ]
    },
    {
      "id": "A747_S9",
      "rule": "change of index l = k - m",
      "premises": [
        "A747_C11: The number of such g|_B is \\sum_{l=2}^{k} \binom{k}{l} (l-1)!"
      ],
      "conclusions": [
        "A747_C12: \\sum_{l=2}^{k} \binom{k}{l} (l-1)! = \\sum_{m=0}^{k-2} \frac{k!}{m! (k-m)}"
      ]
    },
    {
      "id": "A747_S10",
      "rule": "case analysis",
      "premises": [
        "A747_C9: Since g is a perfectutation, its unique cycle of length ≥ 2 is entirely contained in A or entirely in B"
      ],
      "conclusions": [
        "A747_C13: Case 2: The cycle is in A, so g fixes B pointwise, and g|_A is a perfectutation on A that commutes with f|_A"
      ]
    },
    {
      "id": "A747_S11",
      "rule": "by definition of f",
      "premises": [
        "A747_C7: For such f, let B be the set of fixed points of f, |B| = k; A = S \\ B, |A| = m = 2012 - k",
        "A747_C6: The number of perfectutations f with exactly k fixed points is \binom{2012}{k} (2011 - k)! for 0 ≤ k ≤ 2010"
      ],
      "conclusions": [
        "A747_C14: f|_A is an m-cycle"
      ]
    },
    {
      "id": "A747_S12",
      "rule": "centralizer of cycle",
      "premises": [
        "A747_C14: f|_A is an m-cycle"
      ],
      "conclusions": [
        "A747_C15: The permutations on A that commute with f|_A are the powers (f|_A)^r for r = 0, 1, …, m-1"
      ]
    },
    {
      "id": "A747_S13",
      "rule": "cycle condition for powers",
      "premises": [
        "A747_C15: The permutations on A that commute with f|_A are the powers (f|_A)^r for r = 0, 1, …, m-1",
        "A747_C14: f|_A is an m-cycle"
      ],
      "conclusions": [
        "A747_C16: (f|_A)^r is an m-cycle if and only if gcd(r, m) = 1"
      ]
    },
    {
      "id": "A747_S14",
      "rule": "counting generators",
      "premises": [
        "A747_C16: (f|_A)^r is an m-cycle if and only if gcd(r, m) = 1"
      ],
      "conclusions": [
        "A747_C17: The number of such is φ(m)"
      ]
    },
    {
      "id": "A747_S15",
      "rule": "identification",
      "premises": [
        "A747_C15: The permutations on A that commute with f|_A are the powers (f|_A)^r for r = 0, 1, …, m-1"
      ],
      "conclusions": [
        "A747_C18: f itself corresponds to r=1 in case 2"
      ]
    },
    {
      "id": "A747_S16",
      "rule": "add disjoint cases",
      "premises": [
        "A747_C12: \\sum_{l=2}^{k} \binom{k}{l} (l-1)! = \\sum_{m=0}^{k-2} \frac{k!}{m! (k-m)}",
        "A747_C17: The number of such is φ(m)"
      ],
      "conclusions": [
        "A747_C19: The total number of g commuting with f is \\sum_{j=0}^{k-2} \frac{k!}{j! (k-j)} + φ(2012 - k)"
      ]
    },
    {
      "id": "A747_S17",
      "rule": "subtract identity case",
      "premises": [
        "A747_C19: The total number of g commuting with f is \\sum_{j=0}^{k-2} \frac{k!}{j! (k-j)} + φ(2012 - k)",
        "A747_C18: f itself corresponds to r=1 in case 2"
      ],
      "conclusions": [
        "A747_C20: The number of g ≠ f commuting with f is that minus 1"
      ]
    },
    {
      "id": "A747_S18",
      "rule": "sum over f",
      "premises": [
        "A747_C20: The number of g ≠ f commuting with f is that minus 1",
        "A747_C6: The number of perfectutations f with exactly k fixed points is \binom{2012}{k} (2011 - k)! for 0 ≤ k ≤ 2010"
      ],
      "conclusions": [
        "A747_C21: n = \\sum_{k=0}^{2010} \binom{2012}{k} (2011 - k)! \\left( \\sum_{j=0}^{k-2} \frac{k!}{j! (k-j)} + φ(2012 - k) - 1 \right)"
      ]
    },
    {
      "id": "A747_S19",
      "rule": "congruence computation",
      "premises": [
        "A747_C2: S = {1, 2, …, 2012}",
        "A747_C5: p = 2011"
      ],
      "conclusions": [
        "A747_C23: 2012 ≡ 1 (mod p)"
      ]
    },
    {
      "id": "A747_S20",
      "rule": "Wilson's Theorem",
      "premises": [
        "A747_C3: 2011 is a prime number"
      ],
      "conclusions": [
        "A747_C24: By Wilson's Theorem, (p-1)! = 2010! ≡ -1 (mod p)"
      ]
    },
    {
      "id": "A747_S21",
      "rule": "empty sum",
      "premises": [
        "A747_C21: n = \\sum_{k=0}^{2010} \binom{2012}{k} (2011 - k)! \\left( \\sum_{j=0}^{k-2} \frac{k!}{j! (k-j)} + φ(2012 - k) - 1 \right)"
      ],
      "conclusions": [
        "A747_C25: For k=1, the inner sum from 0 to -1 is 0"
      ]
    },
    {
      "id": "A747_S22",
      "rule": "Euler totient for prime",
      "premises": [
        "A747_C3: 2011 is a prime number"
      ],
      "conclusions": [
        "A747_C26: φ(2011) = φ(p) = p-1 = 2010"
      ]
    },
    {
      "id": "A747_S23",
      "rule": "substitution for k=1",
      "premises": [
        "A747_C25: For k=1, the inner sum from 0 to -1 is 0",
        "A747_C26: φ(2011) = φ(p) = p-1 = 2010"
      ],
      "conclusions": [
        "A747_C27: For k=1, the expression inside is 0 + 2010 - 1 = 2009"
      ]
    },
    {
      "id": "A747_S24",
      "rule": "congruence",
      "premises": [
        "A747_C27: For k=1, the expression inside is 0 + 2010 - 1 = 2009",
        "A747_C5: p = 2011"
      ],
      "conclusions": [
        "A747_C28: 2009 ≡ -2 (mod 2011)"
      ]
    },
    {
      "id": "A747_S25",
      "rule": "compute binomial",
      "premises": [
        "A747_C23: 2012 ≡ 1 (mod p)"
      ],
      "conclusions": [
        "A747_C29: \binom{2012}{1} = 2012 ≡ 1 (mod p)"
      ]
    },
    {
      "id": "A747_S26",
      "rule": "factorial congruence",
      "premises": [
        "A747_C24: By Wilson's Theorem, (p-1)! = 2010! ≡ -1 (mod p)"
      ],
      "conclusions": [
        "A747_C30: (2011 - 1)! = 2010! ≡ -1 (mod p)"
      ]
    },
    {
      "id": "A747_S27",
      "rule": "modular multiplication",
      "premises": [
        "A747_C29: \binom{2012}{1} = 2012 ≡ 1 (mod p)",
        "A747_C30: (2011 - 1)! = 2010! ≡ -1 (mod p)",
        "A747_C28: 2009 ≡ -2 (mod 2011)"
      ],
      "conclusions": [
        "A747_C31: The contribution for k=1 is 2012 × 2010! × 2009 ≡ 1 × (-1) × (-2) ≡ 2 (mod p)"
      ]
    },
    {
      "id": "A747_S28",
      "rule": "factorial divisible by p",
      "premises": [
        "A747_C6: The number of perfectutations f with exactly k fixed points is \binom{2012}{k} (2011 - k)! for 0 ≤ k ≤ 2010"
      ],
      "conclusions": [
        "A747_C32: For k=0, (2011 - 0)! = 2011! ≡ 0 (mod p)"
      ]
    },
    {
      "id": "A747_S29",
      "rule": "term zero",
      "premises": [
        "A747_C32: For k=0, (2011 - 0)! = 2011! ≡ 0 (mod p)"
      ],
      "conclusions": [
        "A747_C33: Thus the term for k=0 ≡ 0 (mod p)"
      ]
    },
    {
      "id": "A747_S30",
      "rule": "divisibility of binomial",
      "premises": [
        "A747_C5: p = 2011",
        "A747_C2: S = {1, 2, …, 2012}"
      ],
      "conclusions": [
        "A747_C34: For 2 ≤ k ≤ 2010, \binom{2012}{k} ≡ 0 (mod p) because the numerator includes p and k! not divisible by p (k < p)"
      ]
    },
    {
      "id": "A747_S31",
      "rule": "factorial not divisible",
      "premises": [
        "A747_C5: p = 2011"
      ],
      "conclusions": [
        "A747_C35: (2011 - k)! ≢ 0 (mod p) for 2 ≤ k ≤ 2010 since 2011 - k ≤ 2009 < p"
      ]
    },
    {
      "id": "A747_S32",
      "rule": "product zero",
      "premises": [
        "A747_C34: For 2 ≤ k ≤ 2010, \binom{2012}{k} ≡ 0 (mod p) because the numerator includes p and k! not divisible by p (k < p)",
        "A747_C35: (2011 - k)! ≢ 0 (mod p) for 2 ≤ k ≤ 2010 since 2011 - k ≤ 2009 < p",
        "A747_C6: The number of perfectutations f with exactly k fixed points is \binom{2012}{k} (2011 - k)! for 0 ≤ k ≤ 2010"
      ],
      "conclusions": [
        "A747_C36: Thus the term for 2 ≤ k ≤ 2010 ≡ 0 (mod p)"
      ]
    },
    {
      "id": "A747_S33",
      "rule": "all other terms zero",
      "premises": [
        "A747_C33: Thus the term for k=0 ≡ 0 (mod p)",
        "A747_C36: Thus the term for 2 ≤ k ≤ 2010 ≡ 0 (mod p)",
        "A747_C21: n = \\sum_{k=0}^{2010} \binom{2012}{k} (2011 - k)! \\left( \\sum_{j=0}^{k-2} \frac{k!}{j! (k-j)} + φ(2012 - k) - 1 \right)"
      ],
      "conclusions": [
        "A747_C37: All terms for k ≠ 1 ≡ 0 (mod p)"
      ]
    },
    {
      "id": "A747_S34",
      "rule": "sum modulo p",
      "premises": [
        "A747_C31: The contribution for k=1 is 2012 × 2010! × 2009 ≡ 1 × (-1) × (-2) ≡ 2 (mod p)",
        "A747_C37: All terms for k ≠ 1 ≡ 0 (mod p)"
      ],
      "conclusions": [
        "A747_C38: n ≡ 2 (mod 2011)"
      ]
    },
    {
      "id": "A1561_S1",
      "rule": "problem setup",
      "premises": [
        "A1561_C1: largest positive integer n s.t. exists finite sets X1,...,Xn with |Xa ∪ Xb ∪ Xc| = ceil(sqrt(a b c)) for all 1 ≤ a < b < c ≤ n"
      ],
      "conclusions": [
        "A1561_C2: ceil(sqrt(6)) = 3",
        "A1561_C3: ceil(sqrt(8)) = 3",
        "A1561_C4: ceil(sqrt(12)) = 4",
        "A1561_C5: ceil(sqrt(24)) = 5",
        "A1561_C6: ceil(sqrt(10)) = 4",
        "A1561_C7: ceil(sqrt(40)) = 7",
        "A1561_C8: ceil(sqrt(20)) = 5",
        "A1561_C9: for all finite sets A,B,C,D: |A ∪ B ∪ C| + |A ∪ B ∪ D| ≥ |A ∪ B ∪ C ∪ D| ≥ |B ∪ C ∪ D|"
      ]
    },
    {
      "id": "A1561_S2",
      "rule": "explicit construction",
      "premises": [
        "A1561_C2: ceil(sqrt(6)) = 3",
        "A1561_C3: ceil(sqrt(8)) = 3",
        "A1561_C4: ceil(sqrt(12)) = 4",
        "A1561_C5: ceil(sqrt(24)) = 5"
      ],
      "conclusions": [
        "A1561_C10: exist pairwise disjoint finite sets X1,X2,X3,X4 with |X1|=0, |X2|=1, |X3|=2, |X4|=2"
      ]
    },
    {
      "id": "A1561_S3",
      "rule": "disjoint union cardinality",
      "premises": [
        "A1561_C10: exist pairwise disjoint finite sets X1,X2,X3,X4 with |X1|=0, |X2|=1, |X3|=2, |X4|=2"
      ],
      "conclusions": [
        "A1561_C11: |X1 ∪ X2 ∪ X3| = 3"
      ]
    },
    {
      "id": "A1561_S4",
      "rule": "disjoint union cardinality",
      "premises": [
        "A1561_C10: exist pairwise disjoint finite sets X1,X2,X3,X4 with |X1|=0, |X2|=1, |X3|=2, |X4|=2"
      ],
      "conclusions": [
        "A1561_C12: |X1 ∪ X2 ∪ X4| = 3"
      ]
    },
    {
      "id": "A1561_S5",
      "rule": "disjoint union cardinality",
      "premises": [
        "A1561_C10: exist pairwise disjoint finite sets X1,X2,X3,X4 with |X1|=0, |X2|=1, |X3|=2, |X4|=2"
      ],
      "conclusions": [
        "A1561_C13: |X1 ∪ X3 ∪ X4| = 4"
      ]
    },
    {
      "id": "A1561_S6",
      "rule": "disjoint union cardinality",
      "premises": [
        "A1561_C10: exist pairwise disjoint finite sets X1,X2,X3,X4 with |X1|=0, |X2|=1, |X3|=2, |X4|=2"
      ],
      "conclusions": [
        "A1561_C14: |X2 ∪ X3 ∪ X4| = 5"
      ]
    },
    {
      "id": "A1561_S7",
      "rule": "verification of condition",
      "premises": [
        "A1561_C11: |X1 ∪ X2 ∪ X3| = 3",
        "A1561_C12: |X1 ∪ X2 ∪ X4| = 3",
        "A1561_C13: |X1 ∪ X3 ∪ X4| = 4",
        "A1561_C14: |X2 ∪ X3 ∪ X4| = 5",
        "A1561_C2: ceil(sqrt(6)) = 3",
        "A1561_C3: ceil(sqrt(8)) = 3",
        "A1561_C4: ceil(sqrt(12)) = 4",
        "A1561_C5: ceil(sqrt(24)) = 5"
      ],
      "conclusions": [
        "A1561_C15: exists X1,...,X4 satisfying the property for n=4"
      ]
    },
    {
      "id": "A1561_S8",
      "rule": "assumption for contradiction",
      "premises": [
        "A1561_C1: largest positive integer n s.t. exists finite sets X1,...,Xn with |Xa ∪ Xb ∪ Xc| = ceil(sqrt(a b c)) for all 1 ≤ a < b < c ≤ n",
        "A1561_C6: ceil(sqrt(10)) = 4",
        "A1561_C7: ceil(sqrt(40)) = 7",
        "A1561_C8: ceil(sqrt(20)) = 5"
      ],
      "conclusions": [
        "A1561_C16: assume exists X1,...,X5 satisfying the property for n=5"
      ]
    },
    {
      "id": "A1561_S9",
      "rule": "property application",
      "premises": [
        "A1561_C16: assume exists X1,...,X5 satisfying the property for n=5",
        "A1561_C3: ceil(sqrt(8)) = 3"
      ],
      "conclusions": [
        "A1561_C17: |X1 ∪ X2 ∪ X4| = 3"
      ]
    },
    {
      "id": "A1561_S10",
      "rule": "property application",
      "premises": [
        "A1561_C16: assume exists X1,...,X5 satisfying the property for n=5",
        "A1561_C6: ceil(sqrt(10)) = 4"
      ],
      "conclusions": [
        "A1561_C18: |X1 ∪ X2 ∪ X5| = 4"
      ]
    },
    {
      "id": "A1561_S11",
      "rule": "property application",
      "premises": [
        "A1561_C16: assume exists X1,...,X5 satisfying the property for n=5",
        "A1561_C7: ceil(sqrt(40)) = 7"
      ],
      "conclusions": [
        "A1561_C19: |X2 ∪ X4 ∪ X5| = 7"
      ]
    },
    {
      "id": "A1561_S12",
      "rule": "arithmetic addition",
      "premises": [
        "A1561_C17: |X1 ∪ X2 ∪ X4| = 3",
        "A1561_C18: |X1 ∪ X2 ∪ X5| = 4"
      ],
      "conclusions": [
        "A1561_C20: 3 + 4 = 7"
      ]
    },
    {
      "id": "A1561_S13",
      "rule": "inequality application",
      "premises": [
        "A1561_C9: for all finite sets A,B,C,D: |A ∪ B ∪ C| + |A ∪ B ∪ D| ≥ |A ∪ B ∪ C ∪ D| ≥ |B ∪ C ∪ D|",
        "A1561_C19: |X2 ∪ X4 ∪ X5| = 7"
      ],
      "conclusions": [
        "A1561_C21: |X1 ∪ X2 ∪ X4 ∪ X5| ≥ 7"
      ]
    },
    {
      "id": "A1561_S14",
      "rule": "subadditivity",
      "premises": [
        "A1561_C17: |X1 ∪ X2 ∪ X4| = 3",
        "A1561_C18: |X1 ∪ X2 ∪ X5| = 4"
      ],
      "conclusions": [
        "A1561_C22: 7 ≥ |X1 ∪ X2 ∪ X4 ∪ X5|"
      ]
    },
    {
      "id": "A1561_S15",
      "rule": "equality from bounds",
      "premises": [
        "A1561_C20: 3 + 4 = 7",
        "A1561_C21: |X1 ∪ X2 ∪ X4 ∪ X5| ≥ 7",
        "A1561_C22: 7 ≥ |X1 ∪ X2 ∪ X4 ∪ X5|"
      ],
      "conclusions": [
        "A1561_C23: |X1 ∪ X2 ∪ X4 ∪ X5| = 7"
      ]
    },
    {
      "id": "A1561_S16",
      "rule": "inclusion-exclusion identity",
      "premises": [
        "A1561_C17: |X1 ∪ X2 ∪ X4| = 3",
        "A1561_C18: |X1 ∪ X2 ∪ X5| = 4"
      ],
      "conclusions": [
        "A1561_C24: |(X1 ∪ X2 ∪ X4) ∪ (X1 ∪ X2 ∪ X5)| + |(X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5)| = 7"
      ]
    },
    {
      "id": "A1561_S17",
      "rule": "equality implication",
      "premises": [
        "A1561_C20: 3 + 4 = 7",
        "A1561_C23: |X1 ∪ X2 ∪ X4 ∪ X5| = 7",
        "A1561_C24: |(X1 ∪ X2 ∪ X4) ∪ (X1 ∪ X2 ∪ X5)| + |(X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5)| = 7"
      ],
      "conclusions": [
        "A1561_C25: |(X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5)| = 0"
      ]
    },
    {
      "id": "A1561_S18",
      "rule": "empty intersection",
      "premises": [
        "A1561_C25: |(X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5)| = 0"
      ],
      "conclusions": [
        "A1561_C26: (X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5) = ∅"
      ]
    },
    {
      "id": "A1561_S19",
      "rule": "intersection formula",
      "premises": [
        "A1561_C26: (X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5) = ∅"
      ],
      "conclusions": [
        "A1561_C27: (X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5) = (X1 ∪ X2) ∪ (X4 ∩ X5)"
      ]
    },
    {
      "id": "A1561_S20",
      "rule": "empty set implication",
      "premises": [
        "A1561_C27: (X1 ∪ X2 ∪ X4) ∩ (X1 ∪ X2 ∪ X5) = (X1 ∪ X2) ∪ (X4 ∩ X5)"
      ],
      "conclusions": [
        "A1561_C28: (X1 ∪ X2) ∪ (X4 ∩ X5) = ∅"
      ]
    },
    {
      "id": "A1561_S21",
      "rule": "disjoint components",
      "premises": [
        "A1561_C28: (X1 ∪ X2) ∪ (X4 ∩ X5) = ∅"
      ],
      "conclusions": [
        "A1561_C29: X1 ∪ X2 = ∅",
        "A1561_C30: X4 ∩ X5 = ∅"
      ]
    },
    {
      "id": "A1561_S22",
      "rule": "empty union implies empty sets",
      "premises": [
        "A1561_C29: X1 ∪ X2 = ∅"
      ],
      "conclusions": [
        "A1561_C31: X1 = ∅ ∧ X2 = ∅"
      ]
    },
    {
      "id": "A1561_S23",
      "rule": "property application",
      "premises": [
        "A1561_C16: assume exists X1,...,X5 satisfying the property for n=5",
        "A1561_C8: ceil(sqrt(20)) = 5"
      ],
      "conclusions": [
        "A1561_C32: |X1 ∪ X4 ∪ X5| = 5"
      ]
    },
    {
      "id": "A1561_S24",
      "rule": "empty set union",
      "premises": [
        "A1561_C32: |X1 ∪ X4 ∪ X5| = 5",
        "A1561_C31: X1 = ∅ ∧ X2 = ∅"
      ],
      "conclusions": [
        "A1561_C33: |X4 ∪ X5| = 5"
      ]
    },
    {
      "id": "A1561_S25",
      "rule": "empty set union",
      "premises": [
        "A1561_C19: |X2 ∪ X4 ∪ X5| = 7",
        "A1561_C31: X1 = ∅ ∧ X2 = ∅"
      ],
      "conclusions": [
        "A1561_C34: |X4 ∪ X5| = 7"
      ]
    },
    {
      "id": "A1561_S26",
      "rule": "equality",
      "premises": [
        "A1561_C33: |X4 ∪ X5| = 5",
        "A1561_C34: |X4 ∪ X5| = 7"
      ],
      "conclusions": [
        "A1561_C35: 5 = 7"
      ]
    },
    {
      "id": "A1561_S27",
      "rule": "contradiction",
      "premises": [
        "A1561_C35: 5 = 7"
      ],
      "conclusions": [
        "A1561_C36: contradiction"
      ]
    },
    {
      "id": "A1561_S28",
      "rule": "negation of assumption",
      "premises": [
        "A1561_C16: assume exists X1,...,X5 satisfying the property for n=5",
        "A1561_C36: contradiction"
      ],
      "conclusions": [
        "A1561_C37: no such X1,...,X5 exist"
      ]
    },
    {
      "id": "A1561_S29",
      "rule": "implication for larger n",
      "premises": [
        "A1561_C37: no such X1,...,X5 exist"
      ],
      "conclusions": [
        "A1561_C38: for n ≥ 5, no such X1,...,Xn exist"
      ]
    },
    {
      "id": "A1561_S30",
      "rule": "combine existence and non-existence",
      "premises": [
        "A1561_C15: exists X1,...,X4 satisfying the property for n=4",
        "A1561_C38: for n ≥ 5, no such X1,...,Xn exist"
      ],
      "conclusions": [
        "A1561_C39: exists for n=4 and not for n > 4"
      ]
    },
    {
      "id": "A1561_S31",
      "rule": "final conclusion",
      "premises": [
        "A1561_C39: exists for n=4 and not for n > 4"
      ],
      "conclusions": [
        "A1561_C40: largest n = 4"
      ]
    },
    {
      "id": "B1961_S1",
      "rule": "problem connection",
      "premises": [
        "B1961_C1: largest positive integer n s.t. exists finite sets X1,...,Xn with |Xa ∪ Xb ∪ Xc| = ceil(sqrt(a b c)) for all (p - 2010) ≤ a < b < c ≤ n",
        "A747_C5: p = 2011"
      ],
      "conclusions": [
        "A1561_C1: largest positive integer n s.t. exists finite sets X1,...,Xn with |Xa ∪ Xb ∪ Xc| = ceil(sqrt(a b c)) for all 1 ≤ a < b < c ≤ n"
      ]
    }
  ]
}
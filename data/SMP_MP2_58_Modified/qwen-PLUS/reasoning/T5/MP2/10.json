{
  "Problem_ID": 10,
  "Chunk_Type": "T5",
  "Class_ID": "B659",
  "Multiple_Synthesis_Class": "MP2",
  "Sub_Class_ID": [
    {
      "A3223": "A3223_DG_1"
    },
    {
      "A3232": "A3232_DG_1"
    }
  ],
  "Synthesis_Trace": "DG-DG",
  "Synthesis_Status": "Continuable",
  "Math_Problem": "Let $A$ be the set of all integers $n$ such that $1 \\leq n \\leq 2021$ and $\\gcd(n, 2021) = 1$. For every nonnegative integer $j$, let\n\\[S(j) = \\sum_{n \\in A} n^j.\\]\nDetermine all values of $j$ such that $S(j)$ is a multiple of 2021. Instead of determining the nonnegative integers $j$ for which the power sum over the residues coprime to the modulus is divisible by the modulus, simply find $k = d - 1$, where $d$ is the greatest common divisor of the distinct prime factors of the modulus. Determine the maximum value of the sum\n\\[S = \\sum_{n=1}^\\infty \\frac{n}{2^n} (a_1 a_2 \\cdots a_n)^{1/n}\\]\nover all sequences $a_1, a_2, a_3, \\cdots$ of real numbers satisfying $a_k \\geq k$ for each $k$ and\n\\[\\sum_{k=1}^\\infty a_k = 1.\\]",
  "Connecting_Sentence": [
    {
      "A3223": "Instead of determining the nonnegative integers $j$ for which the power sum over the residues coprime to the modulus is divisible by the modulus, simply find $k = d - 1$, where $d$ is the greatest common divisor of the distinct prime factors of the modulus."
    },
    {
      "A3232": "None"
    }
  ],
  "Synthesised_By": [
    {
      "A3223": "Let $A$ be the set of all integers $n$ such that $1 \\leq n \\leq 2021$ and $\\gcd(n, 2021) = 1$. For every nonnegative integer $j$, let\n\\[S(j) = \\sum_{n \\in A} n^j.\\]\nDetermine all values of $j$ such that $S(j)$ is a multiple of 2021. Instead of determining the nonnegative integers $j$ for which the power sum over the residues coprime to the modulus is divisible by the modulus, simply find $k = d - 1$, where $d$ is the greatest common divisor of the distinct prime factors of the modulus."
    },
    {
      "A3232": "Determine the maximum value of the sum\n\\[S = \\sum_{n=1}^\\infty \\frac{n}{2^n} (a_1 a_2 \\cdots a_n)^{1/n}\\]\nover all sequences $a_1, a_2, a_3, \\cdots$ of nonnegative real numbers satisfying\n\\[\\sum_{k=1}^\\infty a_k = 1.\\]"
    }
  ],
  "Original_Problem": [
    {
      "A3223": "Let $A$ be the set of all integers $n$ such that $1 \\leq n \\leq 2021$ and $\\gcd(n, 2021) = 1$. For every nonnegative integer $j$, let\n\\[S(j) = \\sum_{n \\in A} n^j.\\]\nDetermine all values of $j$ such that $S(j)$ is a multiple of 2021."
    },
    {
      "A3232": "Determine the maximum value of the sum\n\\[S = \\sum_{n=1}^\\infty \\frac{n}{2^n} (a_1 a_2 \\cdots a_n)^{1/n}\\]\nover all sequences $a_1, a_2, a_3, \\cdots$ of nonnegative real numbers satisfying\n\\[\\sum_{k=1}^\\infty a_k = 1.\\]"
    }
  ],
  "Problem_Type": [
    {
      "A3223": [
        "Mathematics -> Number Theory -> Congruences",
        "Mathematics -> Number Theory -> Greatest Common Divisors (GCD)"
      ]
    },
    {
      "A3232": [
        "Mathematics -> Calculus -> Series and Sequences -> Other",
        "Mathematics -> Algebra -> Algebra -> Algebraic Expressions"
      ]
    }
  ],
  "Problem_Level": [
    {
      "A3223": "KbsdJames_Omni-MATH_8.0"
    },
    {
      "A3232": "KbsdJames_Omni-MATH_8.0"
    }
  ],
  "Problem_Source": [
    {
      "A3223": "putnam"
    },
    {
      "A3232": "putnam"
    }
  ],
  "Problem_Length": [
    {
      "A3223": 232
    },
    {
      "A3232": 218
    }
  ],
  "Synthesised_Problem_Length": 727,
  "Ground_Truth": [
    {
      "A3223": "j \\text{ not divisible by either } 42 \\text{ or } 46"
    },
    {
      "A3232": "2/3"
    }
  ],
  "Predicted_Answer": [
    {
      "A3223": "j not divisible by either 42 or 46"
    },
    {
      "A3232": "2/3"
    }
  ],
  "Connecting_Point": [
    {
      "B659": {
        "0": "(gcd(43,47) - 1)"
      }
    }
  ],
  "Delta_Factor": [
    {
      "A3223": 0.16
    },
    {
      "A3232": 0.92
    }
  ],
  "Delta_Value": [
    {
      "A3223": {
        "gcd(43,47)": "1"
      }
    },
    {
      "A3232": {
        "c": "3"
      }
    }
  ],
  "Delta_Depth": [
    {
      "A3223": {
        "gcd(43,47)": 6
      }
    },
    {
      "A3232": {
        "c": 23
      }
    }
  ],
  "Delta_Source": [
    {
      "A3223": "derived"
    },
    {
      "A3232": "derived"
    }
  ],
  "Delta_Value_Order": [
    {
      "A3223": 1
    },
    {
      "A3232": 1
    }
  ],
  "Delta_Variable_Names": [
    {
      "A3223": [
        "gcd"
      ]
    },
    {
      "A3232": [
        "c"
      ]
    }
  ],
  "Delta_Socket": [
    {
      "A3223": {
        "2021": 2021.0
      }
    },
    {
      "A3232": {
        "0": 0.0
      }
    }
  ],
  "Source_Delta_Socket": [
    {
      "A3223": "goal"
    },
    {
      "A3232": "goal"
    }
  ],
  "Delta_Socket_Order": [
    {
      "A3223": 1
    },
    {
      "A3232": 1
    }
  ],
  "Variable_Names": [
    {
      "A3223": [
        "A",
        "n",
        "j",
        "S"
      ]
    },
    {
      "A3232": [
        "a"
      ]
    }
  ],
  "Total_Claims": [
    {
      "A3223": 37
    },
    {
      "A3232": 25
    }
  ],
  "Total_Delta": [
    {
      "A3223": 1
    },
    {
      "A3232": 1
    }
  ],
  "Total_Delta_Socket": [
    {
      "A3223": 1
    },
    {
      "A3232": 1
    }
  ],
  "Max_Delta_Factor": [
    {
      "A3223": 0.16
    },
    {
      "A3232": 0.92
    }
  ],
  "Min_Delta_Factor": [
    {
      "A3223": 0.16
    },
    {
      "A3232": 0.92
    }
  ],
  "Max_Delta_Depth": [
    {
      "A3223": 6
    },
    {
      "A3232": 23
    }
  ],
  "Min_Delta_Depth": [
    {
      "A3223": 6
    },
    {
      "A3232": 23
    }
  ],
  "Claims": [
    {
      "id": "A3223_C1",
      "type": "goal",
      "expr": "all nonnegative integers j such that 2021 divides S(j)"
    },
    {
      "id": "A3223_C2",
      "type": "context",
      "expr": "A = {n ∈ ℤ | 1 ≤ n ≤ 2021 ∧ gcd(n,2021)=1}"
    },
    {
      "id": "A3223_C3",
      "type": "context",
      "expr": "S(j) = ∑_{n ∈ A} n^j"
    },
    {
      "id": "A3223_C4",
      "type": "context",
      "expr": "2021 = 43 × 47"
    },
    {
      "id": "A3223_C5",
      "type": "context",
      "expr": "43 and 47 are primes"
    },
    {
      "id": "A3223_C6",
      "type": "derived",
      "expr": "gcd(43,47)=1"
    },
    {
      "id": "A3223_C7",
      "type": "derived",
      "expr": "2021 | S(j) ⇔ 43 | S(j) ∧ 47 | S(j)"
    },
    {
      "id": "A3223_C8",
      "type": "derived",
      "expr": "∀ prime p, if (p-1) | j then ∑_{k=1}^{p-1} k^j ≡ -1 (mod p)"
    },
    {
      "id": "A3223_C9",
      "type": "derived",
      "expr": "∀ prime p, if (p-1) ∤ j then ∑_{k=1}^{p-1} k^j ≡ 0 (mod p)"
    },
    {
      "id": "A3223_C10",
      "type": "derived",
      "expr": "∀ prime p, ∑_{k=1}^{p-1} k^j ≡ 0 (mod p) ⇔ (p-1) ∤ j"
    },
    {
      "id": "A3223_C11",
      "type": "derived",
      "expr": "1 to 2021 contains 47 complete residue systems mod 43"
    },
    {
      "id": "A3223_C12",
      "type": "derived",
      "expr": "∀ r=0 to 42, exactly 47 n ∈ [1,2021] with n ≡ r (mod 43)"
    },
    {
      "id": "A3223_C13",
      "type": "derived",
      "expr": "for r=0, all such n have gcd(n,2021) > 1, so ∉ A"
    },
    {
      "id": "A3223_C14",
      "type": "derived",
      "expr": "for fixed r=1 to 42, the 47 n ≡ r (mod 43) form AP with difference 43"
    },
    {
      "id": "A3223_C15",
      "type": "derived",
      "expr": "gcd(43,47)=1 ⇒ residues mod 47 of these n are all distinct (complete system mod 47)"
    },
    {
      "id": "A3223_C16",
      "type": "derived",
      "expr": "exactly one such n ≡ 0 (mod 47), so gcd(n,2021) > 1, ∉ A"
    },
    {
      "id": "A3223_C17",
      "type": "derived",
      "expr": "for each r=1 to 42, exactly 46 n ∈ A with n ≡ r (mod 43)"
    },
    {
      "id": "A3223_C18",
      "type": "derived",
      "expr": "for such n ∈ A, n^j ≡ r^j (mod 43)"
    },
    {
      "id": "A3223_C19",
      "type": "derived",
      "expr": "S(j) ≡ 46 × ∑_{r=1}^{42} r^j (mod 43)"
    },
    {
      "id": "A3223_C20",
      "type": "derived",
      "expr": "gcd(46,43)=1 (46 invertible mod 43)"
    },
    {
      "id": "A3223_C21",
      "type": "derived",
      "expr": "S(j) ≡ 0 (mod 43) ⇔ ∑_{r=1}^{42} r^j ≡ 0 (mod 43)"
    },
    {
      "id": "A3223_C22",
      "type": "derived",
      "expr": "∑_{r=1}^{42} r^j ≡ 0 (mod 43) ⇔ 42 ∤ j"
    },
    {
      "id": "A3223_C23",
      "type": "derived",
      "expr": "S(j) ≡ 0 (mod 43) ⇔ 42 ∤ j"
    },
    {
      "id": "A3223_C24",
      "type": "derived",
      "expr": "1 to 2021 contains 43 complete residue systems mod 47"
    },
    {
      "id": "A3223_C25",
      "type": "derived",
      "expr": "∀ s=0 to 46, exactly 43 n ∈ [1,2021] with n ≡ s (mod 47)"
    },
    {
      "id": "A3223_C26",
      "type": "derived",
      "expr": "for s=0, all such n have gcd(n,2021) > 1, so ∉ A"
    },
    {
      "id": "A3223_C27",
      "type": "derived",
      "expr": "for fixed s=1 to 46, the 43 n ≡ s (mod 47) form AP with difference 47"
    },
    {
      "id": "A3223_C28",
      "type": "derived",
      "expr": "gcd(47,43)=1 ⇒ residues mod 43 of these n are all distinct (complete system mod 43)"
    },
    {
      "id": "A3223_C29",
      "type": "derived",
      "expr": "exactly one such n ≡ 0 (mod 43), so gcd(n,2021) > 1, ∉ A"
    },
    {
      "id": "A3223_C30",
      "type": "derived",
      "expr": "for each s=1 to 46, exactly 42 n ∈ A with n ≡ s (mod 47)"
    },
    {
      "id": "A3223_C31",
      "type": "derived",
      "expr": "for such n ∈ A, n^j ≡ s^j (mod 47)"
    },
    {
      "id": "A3223_C32",
      "type": "derived",
      "expr": "S(j) ≡ 42 × ∑_{s=1}^{46} s^j (mod 47)"
    },
    {
      "id": "A3223_C33",
      "type": "derived",
      "expr": "gcd(42,47)=1 (42 invertible mod 47)"
    },
    {
      "id": "A3223_C34",
      "type": "derived",
      "expr": "S(j) ≡ 0 (mod 47) ⇔ ∑_{s=1}^{46} s^j ≡ 0 (mod 47)"
    },
    {
      "id": "A3223_C35",
      "type": "derived",
      "expr": "∑_{s=1}^{46} s^j ≡ 0 (mod 47) ⇔ 46 ∤ j"
    },
    {
      "id": "A3223_C36",
      "type": "derived",
      "expr": "S(j) ≡ 0 (mod 47) ⇔ 46 ∤ j"
    },
    {
      "id": "A3223_C37",
      "type": "final",
      "expr": "2021 | S(j) ⇔ 42 ∤ j ∧ 46 ∤ j"
    },
    {
      "id": "A3232_C1",
      "type": "derived",
      "expr": "maximum value of S over a_k >= 0 with sum_{k=1}^∞ a_k = 1"
    },
    {
      "id": "A3232_C2",
      "type": "context",
      "expr": "S = sum_{n=1}^∞ (n / 2^n) (prod_{k=1}^n a_k)^{1/n}"
    },
    {
      "id": "A3232_C3",
      "type": "context",
      "expr": "sum_{k=1}^∞ a_k = 1"
    },
    {
      "id": "A3232_C4",
      "type": "context",
      "expr": "a_k >= 0 for all k"
    },
    {
      "id": "A3232_C5",
      "type": "derived",
      "expr": "for all n >= 1, 2^{n+1} (prod_{k=1}^n a_k)^{1/n} <= (1/n) sum_{k=1}^n 4^k a_k"
    },
    {
      "id": "A3232_C6",
      "type": "derived",
      "expr": "for all n >= 1, (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / (n * 2^{n+1})"
    },
    {
      "id": "A3232_C7",
      "type": "derived",
      "expr": "for all n >= 1, (n / 2^n) (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / 2^{2n+1}"
    },
    {
      "id": "A3232_C8",
      "type": "derived",
      "expr": "2^{2n+1} = 2 * 4^n"
    },
    {
      "id": "A3232_C9",
      "type": "derived",
      "expr": "for all n >= 1, (n / 2^n) (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / (2 * 4^n)"
    },
    {
      "id": "A3232_C10",
      "type": "derived",
      "expr": "S <= (1/2) sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n"
    },
    {
      "id": "A3232_C11",
      "type": "derived",
      "expr": "2S <= sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n"
    },
    {
      "id": "A3232_C12",
      "type": "derived",
      "expr": "sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n = sum_{n=1}^∞ sum_{k=1}^n 4^{k-n} a_k"
    },
    {
      "id": "A3232_C13",
      "type": "derived",
      "expr": "sum_{n=1}^∞ sum_{k=1}^n 4^{k-n} a_k = sum_{k=1}^∞ sum_{n=k}^∞ 4^{k-n} a_k"
    },
    {
      "id": "A3232_C14",
      "type": "derived",
      "expr": "for all k >= 1, sum_{n=k}^∞ 4^{k-n} = 4/3"
    },
    {
      "id": "A3232_C15",
      "type": "derived",
      "expr": "sum_{k=1}^∞ sum_{n=k}^∞ 4^{k-n} a_k = sum_{k=1}^∞ (4/3) a_k"
    },
    {
      "id": "A3232_C16",
      "type": "derived",
      "expr": "sum_{k=1}^∞ (4/3) a_k = 4/3"
    },
    {
      "id": "A3232_C17",
      "type": "derived",
      "expr": "2S <= 4/3"
    },
    {
      "id": "A3232_C18",
      "type": "derived",
      "expr": "S <= 2/3"
    },
    {
      "id": "A3232_C19",
      "type": "derived",
      "expr": "equality in AM-GM holds iff 4^k a_k are equal for k=1 to n, for each n"
    },
    {
      "id": "A3232_C20",
      "type": "derived",
      "expr": "4^k a_k = c for all k, some constant c > 0"
    },
    {
      "id": "A3232_C21",
      "type": "derived",
      "expr": "a_k = c / 4^k for all k >= 1"
    },
    {
      "id": "A3232_C22",
      "type": "derived",
      "expr": "sum_{k=1}^∞ a_k = c * (1/4) / (1 - 1/4) = c / 3 = 1"
    },
    {
      "id": "A3232_C23",
      "type": "derived",
      "expr": "c = 3"
    },
    {
      "id": "A3232_C24",
      "type": "derived",
      "expr": "a_k = 3 / 4^k for all k >= 1"
    },
    {
      "id": "A3232_C25",
      "type": "final",
      "expr": "maximum value of S is 2/3"
    },
    {
      "id": "B659_C1",
      "type": "goal",
      "expr": "maximum value of S over a_k >= (gcd(43,47) - 1) with sum_{k=1}^∞ a_k = 1"
    }
  ],
  "Steps": [
    {
      "id": "A3223_S1",
      "rule": "problem setup",
      "premises": [
        "A3223_C1: all nonnegative integers j such that 2021 divides S(j)"
      ],
      "conclusions": [
        "A3223_C2: A = {n ∈ ℤ | 1 ≤ n ≤ 2021 ∧ gcd(n,2021)=1}",
        "A3223_C3: S(j) = ∑_{n ∈ A} n^j",
        "A3223_C4: 2021 = 43 × 47",
        "A3223_C5: 43 and 47 are primes"
      ]
    },
    {
      "id": "A3223_S2",
      "rule": "coprime factorization",
      "premises": [
        "A3223_C4: 2021 = 43 × 47",
        "A3223_C5: 43 and 47 are primes"
      ],
      "conclusions": [
        "A3223_C6: gcd(43,47)=1",
        "A3223_C7: 2021 | S(j) ⇔ 43 | S(j) ∧ 47 | S(j)"
      ]
    },
    {
      "id": "A3223_S3",
      "rule": "Fermat's Little Theorem application",
      "premises": [
        "A3223_C5: 43 and 47 are primes"
      ],
      "conclusions": [
        "A3223_C8: ∀ prime p, if (p-1) | j then ∑_{k=1}^{p-1} k^j ≡ -1 (mod p)"
      ]
    },
    {
      "id": "A3223_S4",
      "rule": "primitive root permutation",
      "premises": [
        "A3223_C5: 43 and 47 are primes"
      ],
      "conclusions": [
        "A3223_C9: ∀ prime p, if (p-1) ∤ j then ∑_{k=1}^{p-1} k^j ≡ 0 (mod p)"
      ]
    },
    {
      "id": "A3223_S5",
      "rule": "case combination",
      "premises": [
        "A3223_C8: ∀ prime p, if (p-1) | j then ∑_{k=1}^{p-1} k^j ≡ -1 (mod p)",
        "A3223_C9: ∀ prime p, if (p-1) ∤ j then ∑_{k=1}^{p-1} k^j ≡ 0 (mod p)"
      ],
      "conclusions": [
        "A3223_C10: ∀ prime p, ∑_{k=1}^{p-1} k^j ≡ 0 (mod p) ⇔ (p-1) ∤ j"
      ]
    },
    {
      "id": "A3223_S6",
      "rule": "division into residue classes",
      "premises": [
        "A3223_C4: 2021 = 43 × 47"
      ],
      "conclusions": [
        "A3223_C11: 1 to 2021 contains 47 complete residue systems mod 43",
        "A3223_C12: ∀ r=0 to 42, exactly 47 n ∈ [1,2021] with n ≡ r (mod 43)"
      ]
    },
    {
      "id": "A3223_S7",
      "rule": "exclusion of multiples",
      "premises": [
        "A3223_C12: ∀ r=0 to 42, exactly 47 n ∈ [1,2021] with n ≡ r (mod 43)",
        "A3223_C2: A = {n ∈ ℤ | 1 ≤ n ≤ 2021 ∧ gcd(n,2021)=1}"
      ],
      "conclusions": [
        "A3223_C13: for r=0, all such n have gcd(n,2021) > 1, so ∉ A"
      ]
    },
    {
      "id": "A3223_S8",
      "rule": "arithmetic progression description",
      "premises": [
        "A3223_C12: ∀ r=0 to 42, exactly 47 n ∈ [1,2021] with n ≡ r (mod 43)"
      ],
      "conclusions": [
        "A3223_C14: for fixed r=1 to 42, the 47 n ≡ r (mod 43) form AP with difference 43"
      ]
    },
    {
      "id": "A3223_S9",
      "rule": "coprime difference implies full residues",
      "premises": [
        "A3223_C14: for fixed r=1 to 42, the 47 n ≡ r (mod 43) form AP with difference 43",
        "A3223_C6: gcd(43,47)=1"
      ],
      "conclusions": [
        "A3223_C15: gcd(43,47)=1 ⇒ residues mod 47 of these n are all distinct (complete system mod 47)"
      ]
    },
    {
      "id": "A3223_S10",
      "rule": "identification of excluded",
      "premises": [
        "A3223_C15: gcd(43,47)=1 ⇒ residues mod 47 of these n are all distinct (complete system mod 47)",
        "A3223_C2: A = {n ∈ ℤ | 1 ≤ n ≤ 2021 ∧ gcd(n,2021)=1}"
      ],
      "conclusions": [
        "A3223_C16: exactly one such n ≡ 0 (mod 47), so gcd(n,2021) > 1, ∉ A"
      ]
    },
    {
      "id": "A3223_S11",
      "rule": "counting in A",
      "premises": [
        "A3223_C12: ∀ r=0 to 42, exactly 47 n ∈ [1,2021] with n ≡ r (mod 43)",
        "A3223_C16: exactly one such n ≡ 0 (mod 47), so gcd(n,2021) > 1, ∉ A"
      ],
      "conclusions": [
        "A3223_C17: for each r=1 to 42, exactly 46 n ∈ A with n ≡ r (mod 43)"
      ]
    },
    {
      "id": "A3223_S12",
      "rule": "power congruence",
      "premises": [
        "A3223_C17: for each r=1 to 42, exactly 46 n ∈ A with n ≡ r (mod 43)"
      ],
      "conclusions": [
        "A3223_C18: for such n ∈ A, n^j ≡ r^j (mod 43)"
      ]
    },
    {
      "id": "A3223_S13",
      "rule": "sum over classes",
      "premises": [
        "A3223_C3: S(j) = ∑_{n ∈ A} n^j",
        "A3223_C17: for each r=1 to 42, exactly 46 n ∈ A with n ≡ r (mod 43)",
        "A3223_C18: for such n ∈ A, n^j ≡ r^j (mod 43)"
      ],
      "conclusions": [
        "A3223_C19: S(j) ≡ 46 × ∑_{r=1}^{42} r^j (mod 43)"
      ]
    },
    {
      "id": "A3223_S14",
      "rule": "invertibility check",
      "premises": [
        "A3223_C4: 2021 = 43 × 47"
      ],
      "conclusions": [
        "A3223_C20: gcd(46,43)=1 (46 invertible mod 43)"
      ]
    },
    {
      "id": "A3223_S15",
      "rule": "multiplication by unit",
      "premises": [
        "A3223_C19: S(j) ≡ 46 × ∑_{r=1}^{42} r^j (mod 43)",
        "A3223_C20: gcd(46,43)=1 (46 invertible mod 43)"
      ],
      "conclusions": [
        "A3223_C21: S(j) ≡ 0 (mod 43) ⇔ ∑_{r=1}^{42} r^j ≡ 0 (mod 43)"
      ]
    },
    {
      "id": "A3223_S16",
      "rule": "apply power sum lemma",
      "premises": [
        "A3223_C10: ∀ prime p, ∑_{k=1}^{p-1} k^j ≡ 0 (mod p) ⇔ (p-1) ∤ j",
        "A3223_C5: 43 and 47 are primes"
      ],
      "conclusions": [
        "A3223_C22: ∑_{r=1}^{42} r^j ≡ 0 (mod 43) ⇔ 42 ∤ j"
      ]
    },
    {
      "id": "A3223_S17",
      "rule": "transitivity",
      "premises": [
        "A3223_C21: S(j) ≡ 0 (mod 43) ⇔ ∑_{r=1}^{42} r^j ≡ 0 (mod 43)",
        "A3223_C22: ∑_{r=1}^{42} r^j ≡ 0 (mod 43) ⇔ 42 ∤ j"
      ],
      "conclusions": [
        "A3223_C23: S(j) ≡ 0 (mod 43) ⇔ 42 ∤ j"
      ]
    },
    {
      "id": "A3223_S18",
      "rule": "division into residue classes",
      "premises": [
        "A3223_C4: 2021 = 43 × 47"
      ],
      "conclusions": [
        "A3223_C24: 1 to 2021 contains 43 complete residue systems mod 47",
        "A3223_C25: ∀ s=0 to 46, exactly 43 n ∈ [1,2021] with n ≡ s (mod 47)"
      ]
    },
    {
      "id": "A3223_S19",
      "rule": "exclusion of multiples",
      "premises": [
        "A3223_C25: ∀ s=0 to 46, exactly 43 n ∈ [1,2021] with n ≡ s (mod 47)",
        "A3223_C2: A = {n ∈ ℤ | 1 ≤ n ≤ 2021 ∧ gcd(n,2021)=1}"
      ],
      "conclusions": [
        "A3223_C26: for s=0, all such n have gcd(n,2021) > 1, so ∉ A"
      ]
    },
    {
      "id": "A3223_S20",
      "rule": "arithmetic progression description",
      "premises": [
        "A3223_C25: ∀ s=0 to 46, exactly 43 n ∈ [1,2021] with n ≡ s (mod 47)"
      ],
      "conclusions": [
        "A3223_C27: for fixed s=1 to 46, the 43 n ≡ s (mod 47) form AP with difference 47"
      ]
    },
    {
      "id": "A3223_S21",
      "rule": "coprime difference implies full residues",
      "premises": [
        "A3223_C27: for fixed s=1 to 46, the 43 n ≡ s (mod 47) form AP with difference 47",
        "A3223_C6: gcd(43,47)=1"
      ],
      "conclusions": [
        "A3223_C28: gcd(47,43)=1 ⇒ residues mod 43 of these n are all distinct (complete system mod 43)"
      ]
    },
    {
      "id": "A3223_S22",
      "rule": "identification of excluded",
      "premises": [
        "A3223_C28: gcd(47,43)=1 ⇒ residues mod 43 of these n are all distinct (complete system mod 43)",
        "A3223_C2: A = {n ∈ ℤ | 1 ≤ n ≤ 2021 ∧ gcd(n,2021)=1}"
      ],
      "conclusions": [
        "A3223_C29: exactly one such n ≡ 0 (mod 43), so gcd(n,2021) > 1, ∉ A"
      ]
    },
    {
      "id": "A3223_S23",
      "rule": "counting in A",
      "premises": [
        "A3223_C25: ∀ s=0 to 46, exactly 43 n ∈ [1,2021] with n ≡ s (mod 47)",
        "A3223_C29: exactly one such n ≡ 0 (mod 43), so gcd(n,2021) > 1, ∉ A"
      ],
      "conclusions": [
        "A3223_C30: for each s=1 to 46, exactly 42 n ∈ A with n ≡ s (mod 47)"
      ]
    },
    {
      "id": "A3223_S24",
      "rule": "power congruence",
      "premises": [
        "A3223_C30: for each s=1 to 46, exactly 42 n ∈ A with n ≡ s (mod 47)"
      ],
      "conclusions": [
        "A3223_C31: for such n ∈ A, n^j ≡ s^j (mod 47)"
      ]
    },
    {
      "id": "A3223_S25",
      "rule": "sum over classes",
      "premises": [
        "A3223_C3: S(j) = ∑_{n ∈ A} n^j",
        "A3223_C30: for each s=1 to 46, exactly 42 n ∈ A with n ≡ s (mod 47)",
        "A3223_C31: for such n ∈ A, n^j ≡ s^j (mod 47)"
      ],
      "conclusions": [
        "A3223_C32: S(j) ≡ 42 × ∑_{s=1}^{46} s^j (mod 47)"
      ]
    },
    {
      "id": "A3223_S26",
      "rule": "invertibility check",
      "premises": [
        "A3223_C4: 2021 = 43 × 47"
      ],
      "conclusions": [
        "A3223_C33: gcd(42,47)=1 (42 invertible mod 47)"
      ]
    },
    {
      "id": "A3223_S27",
      "rule": "multiplication by unit",
      "premises": [
        "A3223_C32: S(j) ≡ 42 × ∑_{s=1}^{46} s^j (mod 47)",
        "A3223_C33: gcd(42,47)=1 (42 invertible mod 47)"
      ],
      "conclusions": [
        "A3223_C34: S(j) ≡ 0 (mod 47) ⇔ ∑_{s=1}^{46} s^j ≡ 0 (mod 47)"
      ]
    },
    {
      "id": "A3223_S28",
      "rule": "apply power sum lemma",
      "premises": [
        "A3223_C10: ∀ prime p, ∑_{k=1}^{p-1} k^j ≡ 0 (mod p) ⇔ (p-1) ∤ j",
        "A3223_C5: 43 and 47 are primes"
      ],
      "conclusions": [
        "A3223_C35: ∑_{s=1}^{46} s^j ≡ 0 (mod 47) ⇔ 46 ∤ j"
      ]
    },
    {
      "id": "A3223_S29",
      "rule": "transitivity",
      "premises": [
        "A3223_C34: S(j) ≡ 0 (mod 47) ⇔ ∑_{s=1}^{46} s^j ≡ 0 (mod 47)",
        "A3223_C35: ∑_{s=1}^{46} s^j ≡ 0 (mod 47) ⇔ 46 ∤ j"
      ],
      "conclusions": [
        "A3223_C36: S(j) ≡ 0 (mod 47) ⇔ 46 ∤ j"
      ]
    },
    {
      "id": "A3223_S30",
      "rule": "combine divisibility conditions",
      "premises": [
        "A3223_C7: 2021 | S(j) ⇔ 43 | S(j) ∧ 47 | S(j)",
        "A3223_C23: S(j) ≡ 0 (mod 43) ⇔ 42 ∤ j",
        "A3223_C36: S(j) ≡ 0 (mod 47) ⇔ 46 ∤ j"
      ],
      "conclusions": [
        "A3223_C37: 2021 | S(j) ⇔ 42 ∤ j ∧ 46 ∤ j"
      ]
    },
    {
      "id": "A3232_S1",
      "rule": "problem setup",
      "premises": [
        "A3232_C1: maximum value of S over a_k >= 0 with sum_{k=1}^∞ a_k = 1"
      ],
      "conclusions": [
        "A3232_C2: S = sum_{n=1}^∞ (n / 2^n) (prod_{k=1}^n a_k)^{1/n}",
        "A3232_C3: sum_{k=1}^∞ a_k = 1",
        "A3232_C4: a_k >= 0 for all k"
      ]
    },
    {
      "id": "A3232_S2",
      "rule": "AM-GM inequality on {4^k a_k}_{k=1}^n",
      "premises": [
        "A3232_C2: S = sum_{n=1}^∞ (n / 2^n) (prod_{k=1}^n a_k)^{1/n}",
        "A3232_C4: a_k >= 0 for all k"
      ],
      "conclusions": [
        "A3232_C5: for all n >= 1, 2^{n+1} (prod_{k=1}^n a_k)^{1/n} <= (1/n) sum_{k=1}^n 4^k a_k"
      ]
    },
    {
      "id": "A3232_S3",
      "rule": "divide both sides by 2^{n+1}",
      "premises": [
        "A3232_C5: for all n >= 1, 2^{n+1} (prod_{k=1}^n a_k)^{1/n} <= (1/n) sum_{k=1}^n 4^k a_k"
      ],
      "conclusions": [
        "A3232_C6: for all n >= 1, (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / (n * 2^{n+1})"
      ]
    },
    {
      "id": "A3232_S4",
      "rule": "multiply both sides by n / 2^n",
      "premises": [
        "A3232_C6: for all n >= 1, (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / (n * 2^{n+1})"
      ],
      "conclusions": [
        "A3232_C7: for all n >= 1, (n / 2^n) (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / 2^{2n+1}"
      ]
    },
    {
      "id": "A3232_S5",
      "rule": "exponent identity",
      "premises": [
        "A3232_C7: for all n >= 1, (n / 2^n) (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / 2^{2n+1}"
      ],
      "conclusions": [
        "A3232_C8: 2^{2n+1} = 2 * 4^n"
      ]
    },
    {
      "id": "A3232_S6",
      "rule": "rewrite denominator using C8",
      "premises": [
        "A3232_C7: for all n >= 1, (n / 2^n) (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / 2^{2n+1}",
        "A3232_C8: 2^{2n+1} = 2 * 4^n"
      ],
      "conclusions": [
        "A3232_C9: for all n >= 1, (n / 2^n) (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / (2 * 4^n)"
      ]
    },
    {
      "id": "A3232_S7",
      "rule": "sum inequalities over n",
      "premises": [
        "A3232_C2: S = sum_{n=1}^∞ (n / 2^n) (prod_{k=1}^n a_k)^{1/n}",
        "A3232_C9: for all n >= 1, (n / 2^n) (prod_{k=1}^n a_k)^{1/n} <= [sum_{k=1}^n 4^k a_k] / (2 * 4^n)"
      ],
      "conclusions": [
        "A3232_C10: S <= (1/2) sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n"
      ]
    },
    {
      "id": "A3232_S8",
      "rule": "multiply both sides by 2",
      "premises": [
        "A3232_C10: S <= (1/2) sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n"
      ],
      "conclusions": [
        "A3232_C11: 2S <= sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n"
      ]
    },
    {
      "id": "A3232_S9",
      "rule": "rewrite sum_{k=1}^n 4^k a_k / 4^n = sum_{k=1}^n 4^{k-n} a_k",
      "premises": [
        "A3232_C11: 2S <= sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n"
      ],
      "conclusions": [
        "A3232_C12: sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n = sum_{n=1}^∞ sum_{k=1}^n 4^{k-n} a_k"
      ]
    },
    {
      "id": "A3232_S10",
      "rule": "interchange order of double sum",
      "premises": [
        "A3232_C12: sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n = sum_{n=1}^∞ sum_{k=1}^n 4^{k-n} a_k"
      ],
      "conclusions": [
        "A3232_C13: sum_{n=1}^∞ sum_{k=1}^n 4^{k-n} a_k = sum_{k=1}^∞ sum_{n=k}^∞ 4^{k-n} a_k"
      ]
    },
    {
      "id": "A3232_S11",
      "rule": "sum inner geometric series",
      "premises": [
        "A3232_C13: sum_{n=1}^∞ sum_{k=1}^n 4^{k-n} a_k = sum_{k=1}^∞ sum_{n=k}^∞ 4^{k-n} a_k"
      ],
      "conclusions": [
        "A3232_C14: for all k >= 1, sum_{n=k}^∞ 4^{k-n} = 4/3"
      ]
    },
    {
      "id": "A3232_S12",
      "rule": "substitute inner sum",
      "premises": [
        "A3232_C13: sum_{n=1}^∞ sum_{k=1}^n 4^{k-n} a_k = sum_{k=1}^∞ sum_{n=k}^∞ 4^{k-n} a_k",
        "A3232_C14: for all k >= 1, sum_{n=k}^∞ 4^{k-n} = 4/3"
      ],
      "conclusions": [
        "A3232_C15: sum_{k=1}^∞ sum_{n=k}^∞ 4^{k-n} a_k = sum_{k=1}^∞ (4/3) a_k"
      ]
    },
    {
      "id": "A3232_S13",
      "rule": "factor out 4/3 and apply constraint",
      "premises": [
        "A3232_C15: sum_{k=1}^∞ sum_{n=k}^∞ 4^{k-n} a_k = sum_{k=1}^∞ (4/3) a_k",
        "A3232_C3: sum_{k=1}^∞ a_k = 1"
      ],
      "conclusions": [
        "A3232_C16: sum_{k=1}^∞ (4/3) a_k = 4/3"
      ]
    },
    {
      "id": "A3232_S14",
      "rule": "combine with bound",
      "premises": [
        "A3232_C11: 2S <= sum_{n=1}^∞ [sum_{k=1}^n 4^k a_k] / 4^n",
        "A3232_C16: sum_{k=1}^∞ (4/3) a_k = 4/3"
      ],
      "conclusions": [
        "A3232_C17: 2S <= 4/3"
      ]
    },
    {
      "id": "A3232_S15",
      "rule": "divide by 2",
      "premises": [
        "A3232_C17: 2S <= 4/3"
      ],
      "conclusions": [
        "A3232_C18: S <= 2/3"
      ]
    },
    {
      "id": "A3232_S16",
      "rule": "equality condition of AM-GM",
      "premises": [
        "A3232_C5: for all n >= 1, 2^{n+1} (prod_{k=1}^n a_k)^{1/n} <= (1/n) sum_{k=1}^n 4^k a_k"
      ],
      "conclusions": [
        "A3232_C19: equality in AM-GM holds iff 4^k a_k are equal for k=1 to n, for each n"
      ]
    },
    {
      "id": "A3232_S17",
      "rule": "consistency across n implies constant",
      "premises": [
        "A3232_C19: equality in AM-GM holds iff 4^k a_k are equal for k=1 to n, for each n"
      ],
      "conclusions": [
        "A3232_C20: 4^k a_k = c for all k, some constant c > 0"
      ]
    },
    {
      "id": "A3232_S18",
      "rule": "solve for a_k",
      "premises": [
        "A3232_C20: 4^k a_k = c for all k, some constant c > 0"
      ],
      "conclusions": [
        "A3232_C21: a_k = c / 4^k for all k >= 1"
      ]
    },
    {
      "id": "A3232_S19",
      "rule": "compute infinite sum as geometric series",
      "premises": [
        "A3232_C21: a_k = c / 4^k for all k >= 1"
      ],
      "conclusions": [
        "A3232_C22: sum_{k=1}^∞ a_k = c * (1/4) / (1 - 1/4) = c / 3 = 1"
      ]
    },
    {
      "id": "A3232_S20",
      "rule": "apply constraint to solve for c",
      "premises": [
        "A3232_C22: sum_{k=1}^∞ a_k = c * (1/4) / (1 - 1/4) = c / 3 = 1",
        "A3232_C3: sum_{k=1}^∞ a_k = 1"
      ],
      "conclusions": [
        "A3232_C23: c = 3"
      ]
    },
    {
      "id": "A3232_S21",
      "rule": "substitute c",
      "premises": [
        "A3232_C21: a_k = c / 4^k for all k >= 1",
        "A3232_C23: c = 3"
      ],
      "conclusions": [
        "A3232_C24: a_k = 3 / 4^k for all k >= 1"
      ]
    },
    {
      "id": "A3232_S22",
      "rule": "equality case achieves bound",
      "premises": [
        "A3232_C18: S <= 2/3",
        "A3232_C24: a_k = 3 / 4^k for all k >= 1"
      ],
      "conclusions": [
        "A3232_C25: maximum value of S is 2/3"
      ]
    },
    {
      "id": "B659_S1",
      "rule": "problem connection",
      "premises": [
        "B659_C1: maximum value of S over a_k >= (gcd(43,47) - 1) with sum_{k=1}^∞ a_k = 1",
        "A3223_C6: gcd(43,47)=1"
      ],
      "conclusions": [
        "A3232_C1: maximum value of S over a_k >= 0 with sum_{k=1}^∞ a_k = 1"
      ]
    }
  ]
}
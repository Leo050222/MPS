{
  "Problem_ID": 46,
  "Chunk_Type": "T3",
  "Class_ID": "D2512",
  "Multiple_Synthesis_Class": "MP2",
  "Sub_Class_ID": [
    {
      "A1029": "A1029_DG_3"
    },
    {
      "A1687": "A1687_DG_1"
    }
  ],
  "Synthesis_Trace": "DG-DG",
  "Synthesis_Status": "Continuable",
  "Math_Problem": "Determine the number of integers $2 \\leq n \\leq 2016$ such that $n^{n}-1$ is divisible by $2,3,5,7$. Instead of determining the number of integers in the given range satisfying the specified modular congruence conditions, simply find $m = \\gcd(n,6) - 1$, where $\\gcd(n,6)$ is the greatest common divisor between such an integer $n$ and $6$, derived from the analysis that such $n$ must be coprime to the primes $2$ and $3$. Assume the quartic $x^{4}-a x^{3}+b x^{2}-a x+d=m$ has four real roots $m + \\frac{1}{2} \\leq x_{1}, x_{2}, x_{3}, x_{4} \\leq m + 2$. Find the maximum possible value of $\\frac{\\left(x_{1}+x_{2}\\right)\\left(x_{1}+x_{3}\\right) x_{4}}{\\left(x_{4}+x_{2}\\right)\\left(x_{4}+x_{3}\\right) x_{1}}$ (over all valid choices of $\\left.a, b, d\\right)$.",
  "Connecting_Sentence": [
    {
      "A1029": "Instead of determining the number of integers in the given range satisfying the specified modular congruence conditions, simply find $m = \\gcd(n,6) - 1$, where $\\gcd(n,6)$ is the greatest common divisor between such an integer $n$ and $6$, derived from the analysis that such $n$ must be coprime to the primes $2$ and $3$."
    },
    {
      "A1687": "None"
    }
  ],
  "Synthesised_By": [
    {
      "A1029": "Determine the number of integers $2 \\leq n \\leq 2016$ such that $n^{n}-1$ is divisible by $2,3,5,7$. Instead of determining the number of integers in the given range satisfying the specified modular congruence conditions, simply find $m = \\gcd(n,6) - 1$, where $\\gcd(n,6)$ is the greatest common divisor between such an integer $n$ and $6$, derived from the analysis that such $n$ must be coprime to the primes $2$ and $3$."
    },
    {
      "A1687": "Assume the quartic $x^{4}-a x^{3}+b x^{2}-a x+d=0$ has four real roots $\\frac{1}{2} \\leq x_{1}, x_{2}, x_{3}, x_{4} \\leq 2$. Find the maximum possible value of $\\frac{\\left(x_{1}+x_{2}\\right)\\left(x_{1}+x_{3}\\right) x_{4}}{\\left(x_{4}+x_{2}\\right)\\left(x_{4}+x_{3}\\right) x_{1}}$ (over all valid choices of $\\left.a, b, d\\right)$."
    }
  ],
  "Original_Problem": [
    {
      "A1029": "Determine the number of integers $2 \\leq n \\leq 2016$ such that $n^{n}-1$ is divisible by $2,3,5,7$."
    },
    {
      "A1687": "Assume the quartic $x^{4}-a x^{3}+b x^{2}-a x+d=0$ has four real roots $\\frac{1}{2} \\leq x_{1}, x_{2}, x_{3}, x_{4} \\leq 2$. Find the maximum possible value of $\\frac{\\left(x_{1}+x_{2}\\right)\\left(x_{1}+x_{3}\\right) x_{4}}{\\left(x_{4}+x_{2}\\right)\\left(x_{4}+x_{3}\\right) x_{1}}$ (over all valid choices of $\\left.a, b, d\\right)$."
    }
  ],
  "Problem_Type": [
    {
      "A1029": [
        "Mathematics -> Number Theory -> Congruences"
      ]
    },
    {
      "A1687": [
        "Mathematics -> Algebra -> Algebra -> Polynomial Operations",
        "Mathematics -> Algebra -> Algebra -> Algebraic Expressions"
      ]
    }
  ],
  "Problem_Level": [
    {
      "A1029": "KbsdJames_Omni-MATH_5.0"
    },
    {
      "A1687": "KbsdJames_Omni-MATH_5.0"
    }
  ],
  "Problem_Source": [
    {
      "A1029": "HMMT_2"
    },
    {
      "A1687": "HMMT_2"
    }
  ],
  "Problem_Length": [
    {
      "A1029": 100
    },
    {
      "A1687": 330
    }
  ],
  "Synthesised_Problem_Length": 758,
  "Ground_Truth": [
    {
      "A1029": "9"
    },
    {
      "A1687": "\\frac{5}{4}"
    }
  ],
  "Predicted_Answer": [
    {
      "A1029": "9"
    },
    {
      "A1687": "\frac{5}{4}"
    }
  ],
  "Connecting_Point": [
    {
      "B2512": {
        "0": "(gcd(n,6) - 1)"
      }
    }
  ],
  "Delta_Factor": [
    {
      "A1029": 0.45
    },
    {
      "A1687": 0.77
    }
  ],
  "Delta_Value": [
    {
      "A1029": {
        "gcd(n,6)": "1"
      }
    },
    {
      "A1687": {
        "h(1/2)": "5/2"
      }
    }
  ],
  "Delta_Depth": [
    {
      "A1029": {
        "gcd(n,6)": 15
      }
    },
    {
      "A1687": {
        "h(1/2)": 20
      }
    }
  ],
  "Delta_Source": [
    {
      "A1029": "derived"
    },
    {
      "A1687": "derived"
    }
  ],
  "Delta_Value_Order": [
    {
      "A1029": 3
    },
    {
      "A1687": 1
    }
  ],
  "Delta_Variable_Names": [
    {
      "A1029": [
        "gcd"
      ]
    },
    {
      "A1687": [
        "h"
      ]
    }
  ],
  "Delta_Socket": [
    {
      "A1029": {
        "1": 1.0
      }
    },
    {
      "A1687": {
        "0": 0.0
      }
    }
  ],
  "Source_Delta_Socket": [
    {
      "A1029": "goal"
    },
    {
      "A1687": "goal"
    }
  ],
  "Delta_Socket_Order": [
    {
      "A1029": 1
    },
    {
      "A1687": 1
    }
  ],
  "Variable_Names": [
    {
      "A1029": [
        "n"
      ]
    },
    {
      "A1687": [
        "b",
        "a",
        "d",
        "x"
      ]
    }
  ],
  "Total_Claims": [
    {
      "A1029": 33
    },
    {
      "A1687": 26
    }
  ],
  "Total_Delta": [
    {
      "A1029": 3
    },
    {
      "A1687": 1
    }
  ],
  "Total_Delta_Socket": [
    {
      "A1029": 1
    },
    {
      "A1687": 1
    }
  ],
  "Max_Delta_Factor": [
    {
      "A1029": 0.45
    },
    {
      "A1687": 0.77
    }
  ],
  "Min_Delta_Factor": [
    {
      "A1029": 0.24
    },
    {
      "A1687": 0.77
    }
  ],
  "Max_Delta_Depth": [
    {
      "A1029": 15
    },
    {
      "A1687": 20
    }
  ],
  "Min_Delta_Depth": [
    {
      "A1029": 8
    },
    {
      "A1687": 20
    }
  ],
  "Claims": [
    {
      "id": "A1029_C1",
      "type": "goal",
      "expr": "# { n ∈ ℤ | 2 ≤ n ≤ 2016, ∀ p ∈ {2,3,5,7}, n^n ≡ 1 mod p }"
    },
    {
      "id": "A1029_C2",
      "type": "context",
      "expr": "P = {2,3,5,7}"
    },
    {
      "id": "A1029_C3",
      "type": "context",
      "expr": "∀ p ∈ P, p prime"
    },
    {
      "id": "A1029_C4",
      "type": "context",
      "expr": "210 = 2 × 3 × 5 × 7"
    },
    {
      "id": "A1029_C5",
      "type": "derived",
      "expr": "∀ p ∈ P, p | n ⇒ n^n ≡ 0 mod p ∧ 0 ≢ 1 mod p"
    },
    {
      "id": "A1029_C6",
      "type": "derived",
      "expr": "∀ p ∈ P, n^n ≡ 1 mod p ⇒ p ∤ n"
    },
    {
      "id": "A1029_C7",
      "type": "derived",
      "expr": "∀ p ∈ P, p ∤ n ⇔ gcd(n,p) = 1"
    },
    {
      "id": "A1029_C8",
      "type": "derived",
      "expr": "gcd(n,210) = 1"
    },
    {
      "id": "A1029_C9",
      "type": "derived",
      "expr": "∀ p ∈ P, gcd(n,p)=1 ⇒ ∃ d_p : order of n mod p, d_p | (p-1)"
    },
    {
      "id": "A1029_C10",
      "type": "derived",
      "expr": "∀ p ∈ P, gcd(p-1, p) = 1"
    },
    {
      "id": "A1029_C11",
      "type": "derived",
      "expr": "∀ p ∈ P, d_p | (p-1) ⇒ gcd(d_p, p) = 1"
    },
    {
      "id": "A1029_C12",
      "type": "derived",
      "expr": "∀ p ∈ P, p-1 ∈ {1,2,4,6}"
    },
    {
      "id": "A1029_C13",
      "type": "derived",
      "expr": "∀ p ∈ P, ∀ d | (p-1) with d > 1, 2 | d ∨ 3 | d"
    },
    {
      "id": "A1029_C14",
      "type": "derived",
      "expr": "gcd(n,210)=1 ⇒ gcd(n,2)=1 ∧ gcd(n,3)=1"
    },
    {
      "id": "A1029_C15",
      "type": "derived",
      "expr": "gcd(n,6)=1"
    },
    {
      "id": "A1029_C16",
      "type": "derived",
      "expr": "∀ p ∈ P, d_p > 1 ⇒ gcd(d_p, 6) > 1"
    },
    {
      "id": "A1029_C17",
      "type": "derived",
      "expr": "∀ p ∈ P, d_p > 1 ⇒ gcd(d_p, n) = 1"
    },
    {
      "id": "A1029_C18",
      "type": "derived",
      "expr": "∀ p ∈ P, gcd(n,p)=1 ⇒ (n^n ≡ 1 mod p ⇔ d_p | n)"
    },
    {
      "id": "A1029_C19",
      "type": "derived",
      "expr": "∀ p ∈ P, gcd(n,p)=1 ∧ n^n ≡ 1 mod p ⇒ d_p | n"
    },
    {
      "id": "A1029_C20",
      "type": "derived",
      "expr": "∀ p ∈ P, gcd(n,p)=1 ∧ d_p > 1 ⇒ d_p ∤ n"
    },
    {
      "id": "A1029_C21",
      "type": "derived",
      "expr": "∀ p ∈ P, gcd(n,p)=1 ∧ n^n ≡ 1 mod p ⇒ d_p = 1"
    },
    {
      "id": "A1029_C22",
      "type": "derived",
      "expr": "∀ p ∈ P, d_p = 1 ⇔ n ≡ 1 mod p"
    },
    {
      "id": "A1029_C23",
      "type": "derived",
      "expr": "∀ p ∈ P, n^n ≡ 1 mod p ⇒ n ≡ 1 mod p"
    },
    {
      "id": "A1029_C24",
      "type": "derived",
      "expr": "∀ p ∈ P, n ≡ 1 mod p"
    },
    {
      "id": "A1029_C25",
      "type": "derived",
      "expr": "n ≡ 1 mod 210"
    },
    {
      "id": "A1029_C26",
      "type": "derived",
      "expr": "n ≡ 1 mod 210 ⇒ ∀ p ∈ P, n^n ≡ 1 mod p"
    },
    {
      "id": "A1029_C27",
      "type": "derived",
      "expr": "∀ p ∈ P, n^n ≡ 1 mod p ⇔ n ≡ 1 mod 210"
    },
    {
      "id": "A1029_C28",
      "type": "derived",
      "expr": "The n are 1 + k × 210 for integer k ≥ 0"
    },
    {
      "id": "A1029_C29",
      "type": "derived",
      "expr": "1 + 0 × 210 = 1 < 2, so k ≥ 1"
    },
    {
      "id": "A1029_C30",
      "type": "derived",
      "expr": "1 + k × 210 ≤ 2016 ⇔ k ≤ 2015 / 210 ≈ 9.595"
    },
    {
      "id": "A1029_C31",
      "type": "derived",
      "expr": "max k = 9"
    },
    {
      "id": "A1029_C32",
      "type": "derived",
      "expr": "k = 1,2,...,9"
    },
    {
      "id": "A1029_C33",
      "type": "final",
      "expr": "There are 9 such n"
    },
    {
      "id": "A1687_C1",
      "type": "derived",
      "expr": "maximize E = \frac{(x_1 + x_2)(x_1 + x_3) x_4}{(x_4 + x_2)(x_4 + x_3) x_1} over roots of f(x)=0 in [1/2, 2]"
    },
    {
      "id": "A1687_C2",
      "type": "context",
      "expr": "f(x) = x^4 - a x^3 + b x^2 - a x + d"
    },
    {
      "id": "A1687_C3",
      "type": "context",
      "expr": "1/2 ≤ x_i ≤ 2 for i=1,2,3,4"
    },
    {
      "id": "A1687_C4",
      "type": "context",
      "expr": "f(x_i) = 0 for i=1,2,3,4"
    },
    {
      "id": "A1687_C5",
      "type": "derived",
      "expr": "f(-x) = x^4 + a x^3 + b x^2 + a x + d"
    },
    {
      "id": "A1687_C6",
      "type": "derived",
      "expr": "f(-x_1) - f(x_1) = 2 a x_1^3 + 2 a x_1"
    },
    {
      "id": "A1687_C7",
      "type": "derived",
      "expr": "f(-x_1) = 2 a x_1 (x_1^2 + 1)"
    },
    {
      "id": "A1687_C8",
      "type": "derived",
      "expr": "f(-x_4) = 2 a x_4 (x_4^2 + 1)"
    },
    {
      "id": "A1687_C9",
      "type": "derived",
      "expr": "\frac{f(-x_1)}{f(-x_4)} = \frac{x_1 (x_1^2 + 1)}{x_4 (x_4^2 + 1)}"
    },
    {
      "id": "A1687_C10",
      "type": "derived",
      "expr": "f(-x_1) = 2 x_1 (x_1 + x_2)(x_1 + x_3)(x_1 + x_4)"
    },
    {
      "id": "A1687_C11",
      "type": "derived",
      "expr": "f(-x_4) = 2 x_4 (x_4 + x_1)(x_4 + x_2)(x_4 + x_3)"
    },
    {
      "id": "A1687_C12",
      "type": "derived",
      "expr": "\frac{f(-x_1)}{f(-x_4)} = \frac{x_1}{x_4} \\cdot \frac{(x_1 + x_2)(x_1 + x_3)}{(x_4 + x_2)(x_4 + x_3)}"
    },
    {
      "id": "A1687_C13",
      "type": "derived",
      "expr": "E = \frac{x_4}{x_1} \\cdot \frac{(x_1 + x_2)(x_1 + x_3)}{(x_4 + x_2)(x_4 + x_3)}"
    },
    {
      "id": "A1687_C14",
      "type": "derived",
      "expr": "E = \\left( \frac{x_4}{x_1} \right)^2 \frac{f(-x_1)}{f(-x_4)}"
    },
    {
      "id": "A1687_C15",
      "type": "derived",
      "expr": "E = \frac{x_4 (x_1^2 + 1)}{x_1 (x_4^2 + 1)}"
    },
    {
      "id": "A1687_C16",
      "type": "derived",
      "expr": "E = \frac{x_1 + 1/x_1}{x_4 + 1/x_4}"
    },
    {
      "id": "A1687_C17",
      "type": "derived",
      "expr": "h(x) = x + 1/x for x ∈ [1/2, 2]"
    },
    {
      "id": "A1687_C18",
      "type": "derived",
      "expr": "h'(x) = 1 - 1/x^2 = 0 ⇒ x = 1"
    },
    {
      "id": "A1687_C19",
      "type": "derived",
      "expr": "h(1) = 2 (minimum)"
    },
    {
      "id": "A1687_C20",
      "type": "derived",
      "expr": "h(1/2) = 5/2, h(2) = 5/2 (maximum), h(1/2) = 5/2"
    },
    {
      "id": "A1687_C21",
      "type": "derived",
      "expr": "max h(x) = 5/2, min h(x) = 2"
    },
    {
      "id": "A1687_C22",
      "type": "derived",
      "expr": "max E = (5/2)/2 = 5/4"
    },
    {
      "id": "A1687_C23",
      "type": "derived",
      "expr": "For x_1=2, x_4=1, solve 3y^2 + 2y - 3 = 0 for x_2 = x_3 = y"
    },
    {
      "id": "A1687_C24",
      "type": "derived",
      "expr": "y = (-1 + √10)/3 ≈ 0.7207 ∈ [1/2, 2]"
    },
    {
      "id": "A1687_C25",
      "type": "derived",
      "expr": "Roots 2, 1, y, y satisfy sum triples = sum roots"
    },
    {
      "id": "A1687_C26",
      "type": "final",
      "expr": "maximum of E is 5/4"
    },
    {
      "id": "B2512_C1",
      "type": "goal",
      "expr": "maximize E = \frac{(x_1 + x_2)(x_1 + x_3) x_4}{(x_4 + x_2)(x_4 + x_3) x_1} over roots of f(x)=(gcd(n,6) - 1) in [1/2, 2]"
    }
  ],
  "Steps": [
    {
      "id": "A1029_S1",
      "rule": "problem setup",
      "premises": [
        "A1029_C1: # { n ∈ ℤ | 2 ≤ n ≤ 2016, ∀ p ∈ {2,3,5,7}, n^n ≡ 1 mod p }"
      ],
      "conclusions": [
        "A1029_C2: P = {2,3,5,7}",
        "A1029_C3: ∀ p ∈ P, p prime",
        "A1029_C4: 210 = 2 × 3 × 5 × 7"
      ]
    },
    {
      "id": "A1029_S2",
      "rule": "direct computation",
      "premises": [
        "A1029_C3: ∀ p ∈ P, p prime"
      ],
      "conclusions": [
        "A1029_C5: ∀ p ∈ P, p | n ⇒ n^n ≡ 0 mod p ∧ 0 ≢ 1 mod p"
      ]
    },
    {
      "id": "A1029_S3",
      "rule": "contrapositive",
      "premises": [
        "A1029_C5: ∀ p ∈ P, p | n ⇒ n^n ≡ 0 mod p ∧ 0 ≢ 1 mod p"
      ],
      "conclusions": [
        "A1029_C6: ∀ p ∈ P, n^n ≡ 1 mod p ⇒ p ∤ n"
      ]
    },
    {
      "id": "A1029_S4",
      "rule": "gcd definition for primes",
      "premises": [
        "A1029_C3: ∀ p ∈ P, p prime"
      ],
      "conclusions": [
        "A1029_C7: ∀ p ∈ P, p ∤ n ⇔ gcd(n,p) = 1"
      ]
    },
    {
      "id": "A1029_S5",
      "rule": "coprimality to product",
      "premises": [
        "A1029_C6: ∀ p ∈ P, n^n ≡ 1 mod p ⇒ p ∤ n",
        "A1029_C7: ∀ p ∈ P, p ∤ n ⇔ gcd(n,p) = 1",
        "A1029_C4: 210 = 2 × 3 × 5 × 7"
      ],
      "conclusions": [
        "A1029_C8: gcd(n,210) = 1"
      ]
    },
    {
      "id": "A1029_S6",
      "rule": "Fermat's Little Theorem",
      "premises": [
        "A1029_C3: ∀ p ∈ P, p prime"
      ],
      "conclusions": [
        "A1029_C9: ∀ p ∈ P, gcd(n,p)=1 ⇒ ∃ d_p : order of n mod p, d_p | (p-1)"
      ]
    },
    {
      "id": "A1029_S7",
      "rule": "prime property",
      "premises": [
        "A1029_C3: ∀ p ∈ P, p prime"
      ],
      "conclusions": [
        "A1029_C10: ∀ p ∈ P, gcd(p-1, p) = 1"
      ]
    },
    {
      "id": "A1029_S8",
      "rule": "gcd divisor property",
      "premises": [
        "A1029_C10: ∀ p ∈ P, gcd(p-1, p) = 1"
      ],
      "conclusions": [
        "A1029_C11: ∀ p ∈ P, d_p | (p-1) ⇒ gcd(d_p, p) = 1"
      ]
    },
    {
      "id": "A1029_S9",
      "rule": "direct computation",
      "premises": [
        "A1029_C2: P = {2,3,5,7}"
      ],
      "conclusions": [
        "A1029_C12: ∀ p ∈ P, p-1 ∈ {1,2,4,6}"
      ]
    },
    {
      "id": "A1029_S10",
      "rule": "factorization",
      "premises": [
        "A1029_C12: ∀ p ∈ P, p-1 ∈ {1,2,4,6}"
      ],
      "conclusions": [
        "A1029_C13: ∀ p ∈ P, ∀ d | (p-1) with d > 1, 2 | d ∨ 3 | d"
      ]
    },
    {
      "id": "A1029_S11",
      "rule": "implication from gcd=1",
      "premises": [
        "A1029_C8: gcd(n,210) = 1"
      ],
      "conclusions": [
        "A1029_C14: gcd(n,210)=1 ⇒ gcd(n,2)=1 ∧ gcd(n,3)=1"
      ]
    },
    {
      "id": "A1029_S12",
      "rule": "gcd with lcm(2,3)=6",
      "premises": [
        "A1029_C14: gcd(n,210)=1 ⇒ gcd(n,2)=1 ∧ gcd(n,3)=1"
      ],
      "conclusions": [
        "A1029_C15: gcd(n,6)=1"
      ]
    },
    {
      "id": "A1029_S13",
      "rule": "prime factors of d>1",
      "premises": [
        "A1029_C13: ∀ p ∈ P, ∀ d | (p-1) with d > 1, 2 | d ∨ 3 | d"
      ],
      "conclusions": [
        "A1029_C16: ∀ p ∈ P, d_p > 1 ⇒ gcd(d_p, 6) > 1"
      ]
    },
    {
      "id": "A1029_S14",
      "rule": "coprime factors argument",
      "premises": [
        "A1029_C16: ∀ p ∈ P, d_p > 1 ⇒ gcd(d_p, 6) > 1",
        "A1029_C15: gcd(n,6)=1"
      ],
      "conclusions": [
        "A1029_C17: ∀ p ∈ P, d_p > 1 ⇒ gcd(d_p, n) = 1"
      ]
    },
    {
      "id": "A1029_S15",
      "rule": "order definition",
      "premises": [
        "A1029_C9: ∀ p ∈ P, gcd(n,p)=1 ⇒ ∃ d_p : order of n mod p, d_p | (p-1)"
      ],
      "conclusions": [
        "A1029_C18: ∀ p ∈ P, gcd(n,p)=1 ⇒ (n^n ≡ 1 mod p ⇔ d_p | n)"
      ]
    },
    {
      "id": "A1029_S16",
      "rule": "one direction of iff",
      "premises": [
        "A1029_C18: ∀ p ∈ P, gcd(n,p)=1 ⇒ (n^n ≡ 1 mod p ⇔ d_p | n)"
      ],
      "conclusions": [
        "A1029_C19: ∀ p ∈ P, gcd(n,p)=1 ∧ n^n ≡ 1 mod p ⇒ d_p | n"
      ]
    },
    {
      "id": "A1029_S17",
      "rule": "contradiction if d|n and gcd(d,n)=1",
      "premises": [
        "A1029_C17: ∀ p ∈ P, d_p > 1 ⇒ gcd(d_p, n) = 1"
      ],
      "conclusions": [
        "A1029_C20: ∀ p ∈ P, gcd(n,p)=1 ∧ d_p > 1 ⇒ d_p ∤ n"
      ]
    },
    {
      "id": "A1029_S18",
      "rule": "proof by contradiction",
      "premises": [
        "A1029_C19: ∀ p ∈ P, gcd(n,p)=1 ∧ n^n ≡ 1 mod p ⇒ d_p | n",
        "A1029_C20: ∀ p ∈ P, gcd(n,p)=1 ∧ d_p > 1 ⇒ d_p ∤ n"
      ],
      "conclusions": [
        "A1029_C21: ∀ p ∈ P, gcd(n,p)=1 ∧ n^n ≡ 1 mod p ⇒ d_p = 1"
      ]
    },
    {
      "id": "A1029_S19",
      "rule": "order 1 definition",
      "premises": [
        "A1029_C3: ∀ p ∈ P, p prime"
      ],
      "conclusions": [
        "A1029_C22: ∀ p ∈ P, d_p = 1 ⇔ n ≡ 1 mod p"
      ]
    },
    {
      "id": "A1029_S20",
      "rule": "transitivity",
      "premises": [
        "A1029_C6: ∀ p ∈ P, n^n ≡ 1 mod p ⇒ p ∤ n",
        "A1029_C21: ∀ p ∈ P, gcd(n,p)=1 ∧ n^n ≡ 1 mod p ⇒ d_p = 1",
        "A1029_C22: ∀ p ∈ P, d_p = 1 ⇔ n ≡ 1 mod p"
      ],
      "conclusions": [
        "A1029_C23: ∀ p ∈ P, n^n ≡ 1 mod p ⇒ n ≡ 1 mod p"
      ]
    },
    {
      "id": "A1029_S21",
      "rule": "universal instantiation from goal",
      "premises": [
        "A1029_C1: # { n ∈ ℤ | 2 ≤ n ≤ 2016, ∀ p ∈ {2,3,5,7}, n^n ≡ 1 mod p }",
        "A1029_C23: ∀ p ∈ P, n^n ≡ 1 mod p ⇒ n ≡ 1 mod p"
      ],
      "conclusions": [
        "A1029_C24: ∀ p ∈ P, n ≡ 1 mod p"
      ]
    },
    {
      "id": "A1029_S22",
      "rule": "Chinese Remainder Theorem",
      "premises": [
        "A1029_C24: ∀ p ∈ P, n ≡ 1 mod p",
        "A1029_C2: P = {2,3,5,7}",
        "A1029_C3: ∀ p ∈ P, p prime",
        "A1029_C4: 210 = 2 × 3 × 5 × 7"
      ],
      "conclusions": [
        "A1029_C25: n ≡ 1 mod 210"
      ]
    },
    {
      "id": "A1029_S23",
      "rule": "substitution n≡1",
      "premises": [
        "A1029_C25: n ≡ 1 mod 210"
      ],
      "conclusions": [
        "A1029_C26: n ≡ 1 mod 210 ⇒ ∀ p ∈ P, n^n ≡ 1 mod p"
      ]
    },
    {
      "id": "A1029_S24",
      "rule": "iff combination",
      "premises": [
        "A1029_C23: ∀ p ∈ P, n^n ≡ 1 mod p ⇒ n ≡ 1 mod p",
        "A1029_C26: n ≡ 1 mod 210 ⇒ ∀ p ∈ P, n^n ≡ 1 mod p"
      ],
      "conclusions": [
        "A1029_C27: ∀ p ∈ P, n^n ≡ 1 mod p ⇔ n ≡ 1 mod 210"
      ]
    },
    {
      "id": "A1029_S25",
      "rule": "arithmetic progression",
      "premises": [
        "A1029_C27: ∀ p ∈ P, n^n ≡ 1 mod p ⇔ n ≡ 1 mod 210"
      ],
      "conclusions": [
        "A1029_C28: The n are 1 + k × 210 for integer k ≥ 0"
      ]
    },
    {
      "id": "A1029_S26",
      "rule": "range check",
      "premises": [
        "A1029_C28: The n are 1 + k × 210 for integer k ≥ 0",
        "A1029_C1: # { n ∈ ℤ | 2 ≤ n ≤ 2016, ∀ p ∈ {2,3,5,7}, n^n ≡ 1 mod p }"
      ],
      "conclusions": [
        "A1029_C29: 1 + 0 × 210 = 1 < 2, so k ≥ 1"
      ]
    },
    {
      "id": "A1029_S27",
      "rule": "inequality solving",
      "premises": [
        "A1029_C28: The n are 1 + k × 210 for integer k ≥ 0",
        "A1029_C1: # { n ∈ ℤ | 2 ≤ n ≤ 2016, ∀ p ∈ {2,3,5,7}, n^n ≡ 1 mod p }"
      ],
      "conclusions": [
        "A1029_C30: 1 + k × 210 ≤ 2016 ⇔ k ≤ 2015 / 210 ≈ 9.595"
      ]
    },
    {
      "id": "A1029_S28",
      "rule": "floor",
      "premises": [
        "A1029_C30: 1 + k × 210 ≤ 2016 ⇔ k ≤ 2015 / 210 ≈ 9.595"
      ],
      "conclusions": [
        "A1029_C31: max k = 9"
      ]
    },
    {
      "id": "A1029_S29",
      "rule": "integer bounds",
      "premises": [
        "A1029_C29: 1 + 0 × 210 = 1 < 2, so k ≥ 1",
        "A1029_C31: max k = 9"
      ],
      "conclusions": [
        "A1029_C32: k = 1,2,...,9"
      ]
    },
    {
      "id": "A1029_S30",
      "rule": "counting",
      "premises": [
        "A1029_C32: k = 1,2,...,9"
      ],
      "conclusions": [
        "A1029_C33: There are 9 such n"
      ]
    },
    {
      "id": "A1029_S31",
      "rule": "final count",
      "premises": [
        "A1029_C33: There are 9 such n",
        "A1029_C27: ∀ p ∈ P, n^n ≡ 1 mod p ⇔ n ≡ 1 mod 210",
        "A1029_C1: # { n ∈ ℤ | 2 ≤ n ≤ 2016, ∀ p ∈ {2,3,5,7}, n^n ≡ 1 mod p }"
      ],
      "conclusions": [
        "A1029_C33: There are 9 such n"
      ]
    },
    {
      "id": "A1687_S1",
      "rule": "problem setup",
      "premises": [
        "A1687_C1: maximize E = \frac{(x_1 + x_2)(x_1 + x_3) x_4}{(x_4 + x_2)(x_4 + x_3) x_1} over roots of f(x)=0 in [1/2, 2]"
      ],
      "conclusions": [
        "A1687_C2: f(x) = x^4 - a x^3 + b x^2 - a x + d",
        "A1687_C3: 1/2 ≤ x_i ≤ 2 for i=1,2,3,4",
        "A1687_C4: f(x_i) = 0 for i=1,2,3,4"
      ]
    },
    {
      "id": "A1687_S2",
      "rule": "polynomial substitution",
      "premises": [
        "A1687_C2: f(x) = x^4 - a x^3 + b x^2 - a x + d"
      ],
      "conclusions": [
        "A1687_C5: f(-x) = x^4 + a x^3 + b x^2 + a x + d"
      ]
    },
    {
      "id": "A1687_S3",
      "rule": "coefficient comparison",
      "premises": [
        "A1687_C5: f(-x) = x^4 + a x^3 + b x^2 + a x + d",
        "A1687_C2: f(x) = x^4 - a x^3 + b x^2 - a x + d"
      ],
      "conclusions": [
        "A1687_C6: f(-x_1) - f(x_1) = 2 a x_1^3 + 2 a x_1"
      ]
    },
    {
      "id": "A1687_S4",
      "rule": "use f(x_1)=0",
      "premises": [
        "A1687_C4: f(x_i) = 0 for i=1,2,3,4",
        "A1687_C6: f(-x_1) - f(x_1) = 2 a x_1^3 + 2 a x_1"
      ],
      "conclusions": [
        "A1687_C7: f(-x_1) = 2 a x_1 (x_1^2 + 1)"
      ]
    },
    {
      "id": "A1687_S5",
      "rule": "analogous for x_4",
      "premises": [
        "A1687_C4: f(x_i) = 0 for i=1,2,3,4",
        "A1687_C5: f(-x) = x^4 + a x^3 + b x^2 + a x + d",
        "A1687_C2: f(x) = x^4 - a x^3 + b x^2 - a x + d"
      ],
      "conclusions": [
        "A1687_C8: f(-x_4) = 2 a x_4 (x_4^2 + 1)"
      ]
    },
    {
      "id": "A1687_S6",
      "rule": "ratio simplification",
      "premises": [
        "A1687_C7: f(-x_1) = 2 a x_1 (x_1^2 + 1)",
        "A1687_C8: f(-x_4) = 2 a x_4 (x_4^2 + 1)"
      ],
      "conclusions": [
        "A1687_C9: \frac{f(-x_1)}{f(-x_4)} = \frac{x_1 (x_1^2 + 1)}{x_4 (x_4^2 + 1)}"
      ]
    },
    {
      "id": "A1687_S7",
      "rule": "root product expansion",
      "premises": [
        "A1687_C2: f(x) = x^4 - a x^3 + b x^2 - a x + d",
        "A1687_C4: f(x_i) = 0 for i=1,2,3,4"
      ],
      "conclusions": [
        "A1687_C10: f(-x_1) = 2 x_1 (x_1 + x_2)(x_1 + x_3)(x_1 + x_4)"
      ]
    },
    {
      "id": "A1687_S8",
      "rule": "analogous expansion",
      "premises": [
        "A1687_C2: f(x) = x^4 - a x^3 + b x^2 - a x + d",
        "A1687_C4: f(x_i) = 0 for i=1,2,3,4"
      ],
      "conclusions": [
        "A1687_C11: f(-x_4) = 2 x_4 (x_4 + x_1)(x_4 + x_2)(x_4 + x_3)"
      ]
    },
    {
      "id": "A1687_S9",
      "rule": "ratio of expansions",
      "premises": [
        "A1687_C10: f(-x_1) = 2 x_1 (x_1 + x_2)(x_1 + x_3)(x_1 + x_4)",
        "A1687_C11: f(-x_4) = 2 x_4 (x_4 + x_1)(x_4 + x_2)(x_4 + x_3)"
      ],
      "conclusions": [
        "A1687_C12: \frac{f(-x_1)}{f(-x_4)} = \frac{x_1}{x_4} \\cdot \frac{(x_1 + x_2)(x_1 + x_3)}{(x_4 + x_2)(x_4 + x_3)}"
      ]
    },
    {
      "id": "A1687_S10",
      "rule": "definition of E",
      "premises": [
        "A1687_C1: maximize E = \frac{(x_1 + x_2)(x_1 + x_3) x_4}{(x_4 + x_2)(x_4 + x_3) x_1} over roots of f(x)=0 in [1/2, 2]"
      ],
      "conclusions": [
        "A1687_C13: E = \frac{x_4}{x_1} \\cdot \frac{(x_1 + x_2)(x_1 + x_3)}{(x_4 + x_2)(x_4 + x_3)}"
      ]
    },
    {
      "id": "A1687_S11",
      "rule": "algebraic manipulation",
      "premises": [
        "A1687_C12: \frac{f(-x_1)}{f(-x_4)} = \frac{x_1}{x_4} \\cdot \frac{(x_1 + x_2)(x_1 + x_3)}{(x_4 + x_2)(x_4 + x_3)}",
        "A1687_C13: E = \frac{x_4}{x_1} \\cdot \frac{(x_1 + x_2)(x_1 + x_3)}{(x_4 + x_2)(x_4 + x_3)}"
      ],
      "conclusions": [
        "A1687_C14: E = \\left( \frac{x_4}{x_1} \right)^2 \frac{f(-x_1)}{f(-x_4)}"
      ]
    },
    {
      "id": "A1687_S12",
      "rule": "substitute ratio",
      "premises": [
        "A1687_C14: E = \\left( \frac{x_4}{x_1} \right)^2 \frac{f(-x_1)}{f(-x_4)}",
        "A1687_C9: \frac{f(-x_1)}{f(-x_4)} = \frac{x_1 (x_1^2 + 1)}{x_4 (x_4^2 + 1)}"
      ],
      "conclusions": [
        "A1687_C15: E = \frac{x_4 (x_1^2 + 1)}{x_1 (x_4^2 + 1)}"
      ]
    },
    {
      "id": "A1687_S13",
      "rule": "rewrite fractions",
      "premises": [
        "A1687_C15: E = \frac{x_4 (x_1^2 + 1)}{x_1 (x_4^2 + 1)}"
      ],
      "conclusions": [
        "A1687_C16: E = \frac{x_1 + 1/x_1}{x_4 + 1/x_4}"
      ]
    },
    {
      "id": "A1687_S14",
      "rule": "define h(x)",
      "premises": [
        "A1687_C16: E = \frac{x_1 + 1/x_1}{x_4 + 1/x_4}"
      ],
      "conclusions": [
        "A1687_C17: h(x) = x + 1/x for x ∈ [1/2, 2]"
      ]
    },
    {
      "id": "A1687_S15",
      "rule": "derivative computation",
      "premises": [
        "A1687_C17: h(x) = x + 1/x for x ∈ [1/2, 2]"
      ],
      "conclusions": [
        "A1687_C18: h'(x) = 1 - 1/x^2 = 0 ⇒ x = 1"
      ]
    },
    {
      "id": "A1687_S16",
      "rule": "critical point evaluation",
      "premises": [
        "A1687_C18: h'(x) = 1 - 1/x^2 = 0 ⇒ x = 1",
        "A1687_C17: h(x) = x + 1/x for x ∈ [1/2, 2]"
      ],
      "conclusions": [
        "A1687_C19: h(1) = 2 (minimum)"
      ]
    },
    {
      "id": "A1687_S17",
      "rule": "boundary evaluation",
      "premises": [
        "A1687_C17: h(x) = x + 1/x for x ∈ [1/2, 2]",
        "A1687_C3: 1/2 ≤ x_i ≤ 2 for i=1,2,3,4"
      ],
      "conclusions": [
        "A1687_C20: h(1/2) = 5/2, h(2) = 5/2 (maximum), h(1/2) = 5/2"
      ]
    },
    {
      "id": "A1687_S18",
      "rule": "extrema analysis",
      "premises": [
        "A1687_C19: h(1) = 2 (minimum)",
        "A1687_C20: h(1/2) = 5/2, h(2) = 5/2 (maximum), h(1/2) = 5/2"
      ],
      "conclusions": [
        "A1687_C21: max h(x) = 5/2, min h(x) = 2"
      ]
    },
    {
      "id": "A1687_S19",
      "rule": "maximization",
      "premises": [
        "A1687_C16: E = \frac{x_1 + 1/x_1}{x_4 + 1/x_4}",
        "A1687_C21: max h(x) = 5/2, min h(x) = 2"
      ],
      "conclusions": [
        "A1687_C22: max E = (5/2)/2 = 5/4"
      ]
    },
    {
      "id": "A1687_S20",
      "rule": "Vieta condition for triples",
      "premises": [
        "A1687_C2: f(x) = x^4 - a x^3 + b x^2 - a x + d"
      ],
      "conclusions": [
        "A1687_C23: For x_1=2, x_4=1, solve 3y^2 + 2y - 3 = 0 for x_2 = x_3 = y"
      ]
    },
    {
      "id": "A1687_S21",
      "rule": "quadratic solution",
      "premises": [
        "A1687_C23: For x_1=2, x_4=1, solve 3y^2 + 2y - 3 = 0 for x_2 = x_3 = y"
      ],
      "conclusions": [
        "A1687_C24: y = (-1 + √10)/3 ≈ 0.7207 ∈ [1/2, 2]"
      ]
    },
    {
      "id": "A1687_S22",
      "rule": "verification",
      "premises": [
        "A1687_C24: y = (-1 + √10)/3 ≈ 0.7207 ∈ [1/2, 2]",
        "A1687_C3: 1/2 ≤ x_i ≤ 2 for i=1,2,3,4"
      ],
      "conclusions": [
        "A1687_C25: Roots 2, 1, y, y satisfy sum triples = sum roots"
      ]
    },
    {
      "id": "A1687_S23",
      "rule": "final conclusion",
      "premises": [
        "A1687_C22: max E = (5/2)/2 = 5/4",
        "A1687_C25: Roots 2, 1, y, y satisfy sum triples = sum roots"
      ],
      "conclusions": [
        "A1687_C26: maximum of E is 5/4"
      ]
    },
    {
      "id": "B2512_S1",
      "rule": "problem connection",
      "premises": [
        "B2512_C1: maximize E = \frac{(x_1 + x_2)(x_1 + x_3) x_4}{(x_4 + x_2)(x_4 + x_3) x_1} over roots of f(x)=(gcd(n,6) - 1) in [1/2, 2]",
        "A1029_C15: gcd(n,6)=1"
      ],
      "conclusions": [
        "A1687_C1: maximize E = \frac{(x_1 + x_2)(x_1 + x_3) x_4}{(x_4 + x_2)(x_4 + x_3) x_1} over roots of f(x)=0 in [1/2, 2]"
      ]
    }
  ]
}
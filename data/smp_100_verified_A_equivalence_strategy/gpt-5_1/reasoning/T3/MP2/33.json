{
  "Problem_ID": 33,
  "Chunk_Type": "T3",
  "Class_ID": "E1429",
  "Multiple_Synthesis_Class": "MP2",
  "Sub_Class_ID": [
    {
      "A2514": "A2514_DG_3"
    },
    {
      "A647": "A647_DG_1"
    }
  ],
  "Synthesis_Trace": "DG-DG",
  "Synthesis_Status": "Continuable",
  "Math_Problem": "There are $N$ lockers, labeled from 1 to $N$, placed in clockwise order around a circular hallway. Initially, all lockers are open. Ansoon starts at the first locker and always moves clockwise. When she is at locker $n$ and there are more than $n$ open lockers, she keeps locker $n$ open and closes the next $n$ open lockers, then repeats the process with the next open locker. If she is at locker $n$ and there are at most $n$ lockers still open, she keeps locker $n$ open and closes all other lockers. She continues this process until only one locker is left open. What is the smallest integer $N>2021$ such that the last open locker is locker 1? Instead of determining the smallest integer greater than a fixed threshold such that the locker elimination process results in the starting locker being the last open, simply find $l = $ last $+ 0$, where last is the label of the last open locker derived from the analysis of the process in that scenario. For an even integer positive integer $n$ Kevin has a tape of length $4 n$ with marks at $-2 n,-2 n+1, \\ldots, 2 n-1,2 n$. He then randomly picks $n$ points in the set $-n,-n+1,-n+2, \\ldots, n-1, n$, and places a stone on each of these points. We call a stone 'stuck' if it is on $2 n$ or $-2 n$, or either all the points to the right, or all the points to the left, all contain stones. Then, every minute, Kevin shifts the unstuck stones in the following manner: He picks an unstuck stone uniformly at random and then flips a fair coin. If the coin came up heads, he then moves that stone and every stone in the largest contiguous set containing that stone one point to the left. If the coin came up tails, he moves every stone in that set one point right instead. He repeats until all the stones are stuck. Let $p_{k}$ be the probability that at the end of the process there are exactly $k$ stones in the right half. Evaluate $$\\frac{\\sum_{k=l}^{n-1} (-1)^{n-1-k} p_k}{\\sum_{k=l}^{n-1} p_k}$$ in terms of $n$.",
  "Synthesised_By": [
    {
      "A2514": "There are $N$ lockers, labeled from 1 to $N$, placed in clockwise order around a circular hallway. Initially, all lockers are open. Ansoon starts at the first locker and always moves clockwise. When she is at locker $n$ and there are more than $n$ open lockers, she keeps locker $n$ open and closes the next $n$ open lockers, then repeats the process with the next open locker. If she is at locker $n$ and there are at most $n$ lockers still open, she keeps locker $n$ open and closes all other lockers. She continues this process until only one locker is left open. What is the smallest integer $N>2021$ such that the last open locker is locker 1? Instead of determining the smallest integer greater than a fixed threshold such that the locker elimination process results in the starting locker being the last open, simply find $l = $ last $+ 0$, where last is the label of the last open locker derived from the analysis of the process in that scenario."
    },
    {
      "A647": "For an even integer positive integer $n$ Kevin has a tape of length $4 n$ with marks at $-2 n,-2 n+1, \\ldots, 2 n-1,2 n$. He then randomly picks $n$ points in the set $-n,-n+1,-n+2, \\ldots, n-1, n$, and places a stone on each of these points. We call a stone 'stuck' if it is on $2 n$ or $-2 n$, or either all the points to the right, or all the points to the left, all contain stones. Then, every minute, Kevin shifts the unstuck stones in the following manner: He picks an unstuck stone uniformly at random and then flips a fair coin. If the coin came up heads, he then moves that stone and every stone in the largest contiguous set containing that stone one point to the left. If the coin came up tails, he moves every stone in that set one point right instead. He repeats until all the stones are stuck. Let $p_{k}$ be the probability that at the end of the process there are exactly $k$ stones in the right half. Evaluate $$\\frac{p_{n-1}-p_{n-2}+p_{n-3}-\\ldots+p_{3}-p_{2}+p_{1}}{p_{n-1}+p_{n-2}+p_{n-3}+\\ldots+p_{3}+p_{2}+p_{1}}$$ in terms of $n$."
    }
  ],
  "Problem_Type": [
    {
      "A2514": [
        "Mathematics -> Discrete Mathematics -> Algorithms"
      ]
    },
    {
      "A647": [
        "Mathematics -> Applied Mathematics -> Statistics -> Probability -> Other"
      ]
    }
  ],
  "Problem_Level": [
    {
      "A2514": "KbsdJames_Omni-MATH_5.0"
    },
    {
      "A647": "KbsdJames_Omni-MATH_5.0"
    }
  ],
  "Problem_Source": [
    {
      "A2514": "HMMT_11"
    },
    {
      "A647": "HMMT_2"
    }
  ],
  "Problem_Length": [
    {
      "A2514": 648
    },
    {
      "A647": 1053
    }
  ],
  "Synthesised_Problem_Length": 1965,
  "Ground_Truth": [
    {
      "A2514": "2046"
    },
    {
      "A647": "\\frac{1}{n-1}"
    }
  ],
  "Predicted_Answer": [
    {
      "A2514": "2046"
    },
    {
      "A647": "1/(n-1)"
    }
  ],
  "Connecting_Point": [
    {
      "E1429": {
        "1": "(last + 0)"
      }
    }
  ],
  "Delta_Factor": [
    {
      "A2514": 0.88
    },
    {
      "A647": 0.85
    }
  ],
  "Delta_Value": [
    {
      "A2514": {
        "last": "1"
      }
    },
    {
      "A647": {
        "sum": "1"
      }
    }
  ],
  "Delta_Depth": [
    {
      "A2514": {
        "last": 23
      }
    },
    {
      "A647": {
        "sum": 17
      }
    }
  ],
  "Delta_Source": [
    {
      "A2514": "derived"
    },
    {
      "A647": "derived"
    }
  ],
  "Delta_Value_Order": [
    {
      "A2514": 3
    },
    {
      "A647": 1
    }
  ],
  "Delta_Variable_Names": [
    {
      "A2514": [
        "last"
      ]
    },
    {
      "A647": [
        "sum"
      ]
    }
  ],
  "Delta_Socket": [
    {
      "A2514": {
        "2021": 2021.0
      }
    },
    {
      "A647": {
        "1": 1.0
      }
    }
  ],
  "Source_Delta_Socket": [
    {
      "A2514": "goal"
    },
    {
      "A647": "goal"
    }
  ],
  "Delta_Socket_Order": [
    {
      "A2514": 1
    },
    {
      "A647": 1
    }
  ],
  "Variable_Names": [
    {
      "A2514": [
        "N",
        "n"
      ]
    },
    {
      "A647": [
        "n",
        "p",
        "k",
        "i",
        "t",
        "r",
        "s",
        "e",
        "o",
        "m",
        "f"
      ]
    }
  ],
  "Total_Claims": [
    {
      "A2514": 26
    },
    {
      "A647": 20
    }
  ],
  "Total_Delta": [
    {
      "A2514": 3
    },
    {
      "A647": 1
    }
  ],
  "Total_Delta_Socket": [
    {
      "A2514": 1
    },
    {
      "A647": 1
    }
  ],
  "Max_Delta_Factor": [
    {
      "A2514": 0.88
    },
    {
      "A647": 0.85
    }
  ],
  "Min_Delta_Factor": [
    {
      "A2514": 0.12
    },
    {
      "A647": 0.85
    }
  ],
  "Max_Delta_Depth": [
    {
      "A2514": 23
    },
    {
      "A647": 17
    }
  ],
  "Min_Delta_Depth": [
    {
      "A2514": 3
    },
    {
      "A647": 17
    }
  ],
  "Claims": [
    {
      "id": "A2514_C1",
      "type": "goal",
      "expr": "\\min\\{N \\in \\mathbb{N} \\mid N > 2021 \\land \text{last open locker = 1}\\}"
    },
    {
      "id": "A2514_C2",
      "type": "context",
      "expr": "M_k = 2^k - 1 \\quad \forall k \\in \\mathbb{N}"
    },
    {
      "id": "A2514_C3",
      "type": "derived",
      "expr": "M_{10} = 1023"
    },
    {
      "id": "A2514_C4",
      "type": "derived",
      "expr": "\\sum_{k=1}^9 M_k = 2^{10} - 2 - 9 = 1013"
    },
    {
      "id": "A2514_C5",
      "type": "derived",
      "expr": "\\# \text{open at } M_{10} = N - 1013"
    },
    {
      "id": "A2514_C6",
      "type": "derived",
      "expr": "1013 + 1023 = 2036"
    },
    {
      "id": "A2514_C7",
      "type": "derived",
      "expr": "if N \\leq 2036 then last open = 1023"
    },
    {
      "id": "A2514_C8",
      "type": "derived",
      "expr": "2036 > 2021"
    },
    {
      "id": "A2514_C9",
      "type": "derived",
      "expr": "\forall 2022 \\leq N \\leq 2036, \text{last open } \neq 1"
    },
    {
      "id": "A2514_C10",
      "type": "derived",
      "expr": "if N > 2036 then close next 1023 open after M_{10}"
    },
    {
      "id": "A2514_C11",
      "type": "derived",
      "expr": "\\# \text{tail open after 1023} = N - 1023"
    },
    {
      "id": "A2514_C12",
      "type": "derived",
      "expr": "if N - 1023 < 1023 then close 2046 - N early opens"
    },
    {
      "id": "A2514_C13",
      "type": "derived",
      "expr": "\text{early opens: } M_1=1, M_2=3, \\dots, M_9=511"
    },
    {
      "id": "A2514_C14",
      "type": "derived",
      "expr": "\forall 2037 \\leq N \\leq 2045, 2046 - N \\geq 1 \\Rightarrow 1 \text{ closed}"
    },
    {
      "id": "A2514_C15",
      "type": "derived",
      "expr": "\forall N < 2046 \\land N > 2021, \text{last open } \neq 1"
    },
    {
      "id": "A2514_C16",
      "type": "derived",
      "expr": "for N=2046, close exactly 1024 to 2046, 1 open"
    },
    {
      "id": "A2514_C17",
      "type": "derived",
      "expr": "after step at 1023 for N=2046, open = \\{M_k \\mid k=1..10\\}, \\#=10"
    },
    {
      "id": "A2514_C18",
      "type": "derived",
      "expr": "next at 1, 10 > 1, close next 1: 3"
    },
    {
      "id": "A2514_C19",
      "type": "derived",
      "expr": "now open = \\{1,7,15,\\dots,1023\\}, \\#=9"
    },
    {
      "id": "A2514_C20",
      "type": "derived",
      "expr": "at 7, 9 > 7, close next 7: 15 to 1023"
    },
    {
      "id": "A2514_C21",
      "type": "derived",
      "expr": "now open = \\{1,7\\}, \\#=2"
    },
    {
      "id": "A2514_C22",
      "type": "derived",
      "expr": "at 1, 2 > 1, close next 1: 7"
    },
    {
      "id": "A2514_C23",
      "type": "derived",
      "expr": "now open = \\{1\\}, last = 1"
    },
    {
      "id": "A2514_C24",
      "type": "final",
      "expr": "for N=2046, last open = 1"
    },
    {
      "id": "A2514_C25",
      "type": "derived",
      "expr": "2046 > 2021"
    },
    {
      "id": "A2514_C26",
      "type": "final",
      "expr": "\\min N = 2046"
    },
    {
      "id": "A647_C1",
      "type": "derived",
      "expr": "(p_{n-1} - p_{n-2} + p_{n-3} - ... + p_1) / (p_{n-1} + p_{n-2} + p_{n-3} + ... + p_1) = 1/(n-1)"
    },
    {
      "id": "A647_C2",
      "type": "context",
      "expr": "Total initial configurations: binom(2n+1, n)"
    },
    {
      "id": "A647_C3",
      "type": "context",
      "expr": "Process preserves E[b_j - b_k] = a_j - a_k for 1 ≤ k < j ≤ n"
    },
    {
      "id": "A647_C4",
      "type": "context",
      "expr": "n even positive integer"
    },
    {
      "id": "A647_C5",
      "type": "context",
      "expr": "Initial positions uniform over subsets of size n from {-n, ..., n}"
    },
    {
      "id": "A647_C6",
      "type": "derived",
      "expr": "E[b_{i+1} - b_i] = E[a_{i+1} - a_i] for i=1 to n-1"
    },
    {
      "id": "A647_C7",
      "type": "derived",
      "expr": "In final config, b_{i+1} - b_i = 3n+2 if split after i stones, else 1"
    },
    {
      "id": "A647_C8",
      "type": "derived",
      "expr": "E[b_{i+1} - b_i] = (3n+2) q_i + 1*(1 - q_i) where q_i = P(split after i)"
    },
    {
      "id": "A647_C9",
      "type": "derived",
      "expr": "q_i = p_{n-i} for i=1 to n-1"
    },
    {
      "id": "A647_C10",
      "type": "derived",
      "expr": "E[a_{i+1} - a_i] = (1/binom(2n+1,n)) sum_g g sum_j binom(j, i-1) binom(2n - j - g, n - i + 1)"
    },
    {
      "id": "A647_C11",
      "type": "derived",
      "expr": "sum_j binom(j, i-1) binom(2n - j - g, n - i + 1) = binom(2n - g + 1, n - 1)"
    },
    {
      "id": "A647_C12",
      "type": "derived",
      "expr": "E[a_{i+1} - a_i] independent of i for i=1 to n-1"
    },
    {
      "id": "A647_C13",
      "type": "derived",
      "expr": "q_i = q constant for i=1 to n-1"
    },
    {
      "id": "A647_C14",
      "type": "derived",
      "expr": "p_k = q for k=1 to n-1"
    },
    {
      "id": "A647_C15",
      "type": "derived",
      "expr": "Numerator = sum_{k=1}^{n-1} (-1)^{(n-1)-k} p_k = q sum_{m=1}^{n-1} (-1)^{m-1}"
    },
    {
      "id": "A647_C16",
      "type": "derived",
      "expr": "sum_{m=1}^N (-1)^{m-1} = (1 - (-1)^N)/2 where N = n-1"
    },
    {
      "id": "A647_C17",
      "type": "derived",
      "expr": "n even ⇒ N odd ⇒ (-1)^N = -1 ⇒ sum = 1, sum = 1"
    },
    {
      "id": "A647_C18",
      "type": "derived",
      "expr": "Numerator = q * 1 = q"
    },
    {
      "id": "A647_C19",
      "type": "derived",
      "expr": "Denominator = sum_{k=1}^{n-1} p_k = (n-1) q"
    },
    {
      "id": "A647_C20",
      "type": "final",
      "expr": "Fraction = q / ((n-1) q) = 1/(n-1)"
    },
    {
      "id": "E1429_C1",
      "type": "goal",
      "expr": "(p_{n-1} - p_{n-2} + p_{n-3} - ... + p_1) / (p_{n-1} + p_{n-2} + p_{n-3} + ... + p_1) = (last + 0)/(n-(last + 0))"
    }
  ],
  "Steps": [
    {
      "id": "A2514_S1",
      "rule": "problem setup",
      "premises": [
        "A2514_C1: \\min\\{N \\in \\mathbb{N} \\mid N > 2021 \\land \text{last open locker = 1}\\}"
      ],
      "conclusions": [
        "A2514_C2: M_k = 2^k - 1 \\quad \forall k \\in \\mathbb{N}"
      ]
    },
    {
      "id": "A2514_S2",
      "rule": "evaluation",
      "premises": [
        "A2514_C2: M_k = 2^k - 1 \\quad \forall k \\in \\mathbb{N}"
      ],
      "conclusions": [
        "A2514_C3: M_{10} = 1023"
      ]
    },
    {
      "id": "A2514_S3",
      "rule": "summation formula",
      "premises": [
        "A2514_C2: M_k = 2^k - 1 \\quad \forall k \\in \\mathbb{N}"
      ],
      "conclusions": [
        "A2514_C4: \\sum_{k=1}^9 M_k = 2^{10} - 2 - 9 = 1013"
      ]
    },
    {
      "id": "A2514_S4",
      "rule": "open count derivation",
      "premises": [
        "A2514_C4: \\sum_{k=1}^9 M_k = 2^{10} - 2 - 9 = 1013"
      ],
      "conclusions": [
        "A2514_C5: \\# \text{open at } M_{10} = N - 1013"
      ]
    },
    {
      "id": "A2514_S5",
      "rule": "arithmetic",
      "premises": [
        "A2514_C4: \\sum_{k=1}^9 M_k = 2^{10} - 2 - 9 = 1013",
        "A2514_C3: M_{10} = 1023"
      ],
      "conclusions": [
        "A2514_C6: 1013 + 1023 = 2036"
      ]
    },
    {
      "id": "A2514_S6",
      "rule": "case analysis",
      "premises": [
        "A2514_C5: \\# \text{open at } M_{10} = N - 1013",
        "A2514_C3: M_{10} = 1023",
        "A2514_C6: 1013 + 1023 = 2036"
      ],
      "conclusions": [
        "A2514_C7: if N \\leq 2036 then last open = 1023"
      ]
    },
    {
      "id": "A2514_S7",
      "rule": "comparison",
      "premises": [
        "A2514_C1: \\min\\{N \\in \\mathbb{N} \\mid N > 2021 \\land \text{last open locker = 1}\\}",
        "A2514_C6: 1013 + 1023 = 2036"
      ],
      "conclusions": [
        "A2514_C8: 2036 > 2021"
      ]
    },
    {
      "id": "A2514_S8",
      "rule": "implication",
      "premises": [
        "A2514_C7: if N \\leq 2036 then last open = 1023",
        "A2514_C8: 2036 > 2021"
      ],
      "conclusions": [
        "A2514_C9: \forall 2022 \\leq N \\leq 2036, \text{last open } \neq 1"
      ]
    },
    {
      "id": "A2514_S9",
      "rule": "conditional derivation",
      "premises": [
        "A2514_C5: \\# \text{open at } M_{10} = N - 1013",
        "A2514_C6: 1013 + 1023 = 2036"
      ],
      "conclusions": [
        "A2514_C10: if N > 2036 then close next 1023 open after M_{10}"
      ]
    },
    {
      "id": "A2514_S10",
      "rule": "tail count",
      "premises": [
        "A2514_C3: M_{10} = 1023"
      ],
      "conclusions": [
        "A2514_C11: \\# \text{tail open after 1023} = N - 1023"
      ]
    },
    {
      "id": "A2514_S11",
      "rule": "additional close calculation",
      "premises": [
        "A2514_C3: M_{10} = 1023",
        "A2514_C11: \\# \text{tail open after 1023} = N - 1023"
      ],
      "conclusions": [
        "A2514_C12: if N - 1023 < 1023 then close 2046 - N early opens"
      ]
    },
    {
      "id": "A2514_S12",
      "rule": "early opens list",
      "premises": [
        "A2514_C2: M_k = 2^k - 1 \\quad \forall k \\in \\mathbb{N}"
      ],
      "conclusions": [
        "A2514_C13: \text{early opens: } M_1=1, M_2=3, \\dots, M_9=511"
      ]
    },
    {
      "id": "A2514_S13",
      "rule": "closing implication",
      "premises": [
        "A2514_C12: if N - 1023 < 1023 then close 2046 - N early opens",
        "A2514_C13: \text{early opens: } M_1=1, M_2=3, \\dots, M_9=511"
      ],
      "conclusions": [
        "A2514_C14: \forall 2037 \\leq N \\leq 2045, 2046 - N \\geq 1 \\Rightarrow 1 \text{ closed}"
      ]
    },
    {
      "id": "A2514_S14",
      "rule": "combination",
      "premises": [
        "A2514_C9: \forall 2022 \\leq N \\leq 2036, \text{last open } \neq 1",
        "A2514_C14: \forall 2037 \\leq N \\leq 2045, 2046 - N \\geq 1 \\Rightarrow 1 \text{ closed}"
      ],
      "conclusions": [
        "A2514_C15: \forall N < 2046 \\land N > 2021, \text{last open } \neq 1"
      ]
    },
    {
      "id": "A2514_S15",
      "rule": "specific case N=2046",
      "premises": [
        "A2514_C11: \\# \text{tail open after 1023} = N - 1023",
        "A2514_C3: M_{10} = 1023"
      ],
      "conclusions": [
        "A2514_C16: for N=2046, close exactly 1024 to 2046, 1 open"
      ]
    },
    {
      "id": "A2514_S16",
      "rule": "post-step opens",
      "premises": [
        "A2514_C2: M_k = 2^k - 1 \\quad \forall k \\in \\mathbb{N}",
        "A2514_C16: for N=2046, close exactly 1024 to 2046, 1 open"
      ],
      "conclusions": [
        "A2514_C17: after step at 1023 for N=2046, open = \\{M_k \\mid k=1..10\\}, \\#=10"
      ]
    },
    {
      "id": "A2514_S17",
      "rule": "process at 1",
      "premises": [
        "A2514_C17: after step at 1023 for N=2046, open = \\{M_k \\mid k=1..10\\}, \\#=10"
      ],
      "conclusions": [
        "A2514_C18: next at 1, 10 > 1, close next 1: 3"
      ]
    },
    {
      "id": "A2514_S18",
      "rule": "after close 3",
      "premises": [
        "A2514_C2: M_k = 2^k - 1 \\quad \forall k \\in \\mathbb{N}",
        "A2514_C18: next at 1, 10 > 1, close next 1: 3"
      ],
      "conclusions": [
        "A2514_C19: now open = \\{1,7,15,\\dots,1023\\}, \\#=9"
      ]
    },
    {
      "id": "A2514_S19",
      "rule": "process at 7",
      "premises": [
        "A2514_C19: now open = \\{1,7,15,\\dots,1023\\}, \\#=9"
      ],
      "conclusions": [
        "A2514_C20: at 7, 9 > 7, close next 7: 15 to 1023"
      ]
    },
    {
      "id": "A2514_S20",
      "rule": "after close 15-1023",
      "premises": [
        "A2514_C2: M_k = 2^k - 1 \\quad \forall k \\in \\mathbb{N}",
        "A2514_C20: at 7, 9 > 7, close next 7: 15 to 1023"
      ],
      "conclusions": [
        "A2514_C21: now open = \\{1,7\\}, \\#=2"
      ]
    },
    {
      "id": "A2514_S21",
      "rule": "process at 1 again",
      "premises": [
        "A2514_C21: now open = \\{1,7\\}, \\#=2"
      ],
      "conclusions": [
        "A2514_C22: at 1, 2 > 1, close next 1: 7"
      ]
    },
    {
      "id": "A2514_S22",
      "rule": "final state",
      "premises": [
        "A2514_C22: at 1, 2 > 1, close next 1: 7"
      ],
      "conclusions": [
        "A2514_C23: now open = \\{1\\}, last = 1"
      ]
    },
    {
      "id": "A2514_S23",
      "rule": "verification",
      "premises": [
        "A2514_C17: after step at 1023 for N=2046, open = \\{M_k \\mid k=1..10\\}, \\#=10",
        "A2514_C23: now open = \\{1\\}, last = 1"
      ],
      "conclusions": [
        "A2514_C24: for N=2046, last open = 1"
      ]
    },
    {
      "id": "A2514_S24",
      "rule": "comparison",
      "premises": [
        "A2514_C1: \\min\\{N \\in \\mathbb{N} \\mid N > 2021 \\land \text{last open locker = 1}\\}"
      ],
      "conclusions": [
        "A2514_C25: 2046 > 2021"
      ]
    },
    {
      "id": "A2514_S25",
      "rule": "minimality",
      "premises": [
        "A2514_C15: \forall N < 2046 \\land N > 2021, \text{last open } \neq 1",
        "A2514_C24: for N=2046, last open = 1",
        "A2514_C25: 2046 > 2021"
      ],
      "conclusions": [
        "A2514_C26: \\min N = 2046"
      ]
    },
    {
      "id": "A647_S1",
      "rule": "problem setup",
      "premises": [
        "A647_C1: (p_{n-1} - p_{n-2} + p_{n-3} - ... + p_1) / (p_{n-1} + p_{n-2} + p_{n-3} + ... + p_1) = 1/(n-1)"
      ],
      "conclusions": [
        "A647_C2: Total initial configurations: binom(2n+1, n)",
        "A647_C3: Process preserves E[b_j - b_k] = a_j - a_k for 1 ≤ k < j ≤ n",
        "A647_C4: n even positive integer",
        "A647_C5: Initial positions uniform over subsets of size n from {-n, ..., n}"
      ]
    },
    {
      "id": "A647_S2",
      "rule": "linearity of expectation",
      "premises": [
        "A647_C3: Process preserves E[b_j - b_k] = a_j - a_k for 1 ≤ k < j ≤ n"
      ],
      "conclusions": [
        "A647_C6: E[b_{i+1} - b_i] = E[a_{i+1} - a_i] for i=1 to n-1"
      ]
    },
    {
      "id": "A647_S3",
      "rule": "final position model",
      "premises": [
        "A647_C4: n even positive integer"
      ],
      "conclusions": [
        "A647_C7: In final config, b_{i+1} - b_i = 3n+2 if split after i stones, else 1"
      ]
    },
    {
      "id": "A647_S4",
      "rule": "expected value computation",
      "premises": [
        "A647_C7: In final config, b_{i+1} - b_i = 3n+2 if split after i stones, else 1"
      ],
      "conclusions": [
        "A647_C8: E[b_{i+1} - b_i] = (3n+2) q_i + 1*(1 - q_i) where q_i = P(split after i)"
      ]
    },
    {
      "id": "A647_S5",
      "rule": "definition of p_k",
      "premises": [
        "A647_C8: E[b_{i+1} - b_i] = (3n+2) q_i + 1*(1 - q_i) where q_i = P(split after i)"
      ],
      "conclusions": [
        "A647_C9: q_i = p_{n-i} for i=1 to n-1"
      ]
    },
    {
      "id": "A647_S6",
      "rule": "combinatorial probability",
      "premises": [
        "A647_C2: Total initial configurations: binom(2n+1, n)",
        "A647_C5: Initial positions uniform over subsets of size n from {-n, ..., n}"
      ],
      "conclusions": [
        "A647_C10: E[a_{i+1} - a_i] = (1/binom(2n+1,n)) sum_g g sum_j binom(j, i-1) binom(2n - j - g, n - i + 1)"
      ]
    },
    {
      "id": "A647_S7",
      "rule": "binomial sum identity",
      "premises": [
        "A647_C10: E[a_{i+1} - a_i] = (1/binom(2n+1,n)) sum_g g sum_j binom(j, i-1) binom(2n - j - g, n - i + 1)"
      ],
      "conclusions": [
        "A647_C11: sum_j binom(j, i-1) binom(2n - j - g, n - i + 1) = binom(2n - g + 1, n - 1)"
      ]
    },
    {
      "id": "A647_S8",
      "rule": "independence from i",
      "premises": [
        "A647_C11: sum_j binom(j, i-1) binom(2n - j - g, n - i + 1) = binom(2n - g + 1, n - 1)"
      ],
      "conclusions": [
        "A647_C12: E[a_{i+1} - a_i] independent of i for i=1 to n-1"
      ]
    },
    {
      "id": "A647_S9",
      "rule": "equality of expectations",
      "premises": [
        "A647_C6: E[b_{i+1} - b_i] = E[a_{i+1} - a_i] for i=1 to n-1",
        "A647_C8: E[b_{i+1} - b_i] = (3n+2) q_i + 1*(1 - q_i) where q_i = P(split after i)",
        "A647_C12: E[a_{i+1} - a_i] independent of i for i=1 to n-1"
      ],
      "conclusions": [
        "A647_C13: q_i = q constant for i=1 to n-1"
      ]
    },
    {
      "id": "A647_S10",
      "rule": "uniformity of p_k",
      "premises": [
        "A647_C9: q_i = p_{n-i} for i=1 to n-1",
        "A647_C13: q_i = q constant for i=1 to n-1"
      ],
      "conclusions": [
        "A647_C14: p_k = q for k=1 to n-1"
      ]
    },
    {
      "id": "A647_S11",
      "rule": "alternating sum expansion",
      "premises": [
        "A647_C14: p_k = q for k=1 to n-1"
      ],
      "conclusions": [
        "A647_C15: Numerator = sum_{k=1}^{n-1} (-1)^{(n-1)-k} p_k = q sum_{m=1}^{n-1} (-1)^{m-1}"
      ]
    },
    {
      "id": "A647_S12",
      "rule": "geometric series sum",
      "premises": [
        "A647_C15: Numerator = sum_{k=1}^{n-1} (-1)^{(n-1)-k} p_k = q sum_{m=1}^{n-1} (-1)^{m-1}"
      ],
      "conclusions": [
        "A647_C16: sum_{m=1}^N (-1)^{m-1} = (1 - (-1)^N)/2 where N = n-1"
      ]
    },
    {
      "id": "A647_S13",
      "rule": "parity evaluation",
      "premises": [
        "A647_C4: n even positive integer",
        "A647_C16: sum_{m=1}^N (-1)^{m-1} = (1 - (-1)^N)/2 where N = n-1"
      ],
      "conclusions": [
        "A647_C17: n even ⇒ N odd ⇒ (-1)^N = -1 ⇒ sum = 1, sum = 1"
      ]
    },
    {
      "id": "A647_S14",
      "rule": "numerator simplification",
      "premises": [
        "A647_C17: n even ⇒ N odd ⇒ (-1)^N = -1 ⇒ sum = 1, sum = 1"
      ],
      "conclusions": [
        "A647_C18: Numerator = q * 1 = q"
      ]
    },
    {
      "id": "A647_S15",
      "rule": "denominator computation",
      "premises": [
        "A647_C14: p_k = q for k=1 to n-1"
      ],
      "conclusions": [
        "A647_C19: Denominator = sum_{k=1}^{n-1} p_k = (n-1) q"
      ]
    },
    {
      "id": "A647_S16",
      "rule": "fraction simplification",
      "premises": [
        "A647_C18: Numerator = q * 1 = q",
        "A647_C19: Denominator = sum_{k=1}^{n-1} p_k = (n-1) q"
      ],
      "conclusions": [
        "A647_C20: Fraction = q / ((n-1) q) = 1/(n-1)"
      ]
    },
    {
      "id": "E1429_S1",
      "rule": "problem connection",
      "premises": [
        "E1429_C1: (p_{n-1} - p_{n-2} + p_{n-3} - ... + p_1) / (p_{n-1} + p_{n-2} + p_{n-3} + ... + p_1) = (last + 0)/(n-(last + 0))",
        "A2514_C23: now open = \\{1\\}, last = 1"
      ],
      "conclusions": [
        "A647_C1: (p_{n-1} - p_{n-2} + p_{n-3} - ... + p_1) / (p_{n-1} + p_{n-2} + p_{n-3} + ... + p_1) = 1/(n-1)"
      ]
    }
  ]
}
{
  "Chunk_Type": "T4",
  "Claims": [
    {
      "expr": "find all ordered prime triples (p, q, r) such that p | q^r + 1 ∧ q | r^p + 1 ∧ r | p^q + 1",
      "id": "A183_C1",
      "type": "goal"
    },
    {
      "expr": "p, q, r are prime numbers",
      "id": "A183_C2",
      "type": "context"
    },
    {
      "expr": "p | q^r + 1",
      "id": "A183_C3",
      "type": "context"
    },
    {
      "expr": "q | r^p + 1",
      "id": "A183_C4",
      "type": "context"
    },
    {
      "expr": "r | p^q + 1",
      "id": "A183_C5",
      "type": "context"
    },
    {
      "expr": "assume p = min(p, q, r) and p ≠ 2",
      "id": "A183_C6",
      "type": "derived"
    },
    {
      "expr": "q^r ≡ -1 mod p",
      "id": "A183_C7",
      "type": "derived"
    },
    {
      "expr": "q^{2r} ≡ 1 mod p",
      "id": "A183_C8",
      "type": "derived"
    },
    {
      "expr": "ord_p(q) | 2r",
      "id": "A183_C9",
      "type": "derived"
    },
    {
      "expr": "ord_p(q) does not divide r",
      "id": "A183_C10",
      "type": "derived"
    },
    {
      "expr": "r is odd",
      "id": "A183_C11",
      "type": "derived"
    },
    {
      "expr": "divisors of 2r are 1,2,r,2r",
      "id": "A183_C12",
      "type": "derived"
    },
    {
      "expr": "ord_p(q) = 2 or 2r",
      "id": "A183_C13",
      "type": "derived"
    },
    {
      "expr": "ord_p(q) | p-1",
      "id": "A183_C14",
      "type": "derived"
    },
    {
      "expr": "p ≤ q and p ≤ r",
      "id": "A183_C15",
      "type": "derived"
    },
    {
      "expr": "p-1 < p ≤ r",
      "id": "A183_C16",
      "type": "derived"
    },
    {
      "expr": "ord_p(q) ≤ p-1 < r < 2r",
      "id": "A183_C17",
      "type": "derived"
    },
    {
      "expr": "ord_p(q) ≠ 2r",
      "id": "A183_C18",
      "type": "derived"
    },
    {
      "expr": "ord_p(q) = 2",
      "id": "A183_C19",
      "type": "derived"
    },
    {
      "expr": "q^2 ≡ 1 mod p",
      "id": "A183_C20",
      "type": "derived"
    },
    {
      "expr": "(q-1)(q+1) ≡ 0 mod p",
      "id": "A183_C21",
      "type": "derived"
    },
    {
      "expr": "p | (q-1)(q+1)",
      "id": "A183_C22",
      "type": "derived"
    },
    {
      "expr": "p ≠ q",
      "id": "A183_C23",
      "type": "derived"
    },
    {
      "expr": "if p | q-1 then q ≡ 1 mod p",
      "id": "A183_C24",
      "type": "derived"
    },
    {
      "expr": "if q ≡ 1 mod p then q^r ≡ 1 mod p",
      "id": "A183_C25",
      "type": "derived"
    },
    {
      "expr": "q^r ≡ 1 mod p contradicts q^r ≡ -1 mod p",
      "id": "A183_C26",
      "type": "derived"
    },
    {
      "expr": "p does not divide q-1",
      "id": "A183_C27",
      "type": "derived"
    },
    {
      "expr": "p | q + 1",
      "id": "A183_C28",
      "type": "derived"
    },
    {
      "expr": "q | r + 1",
      "id": "A183_C29",
      "type": "derived"
    },
    {
      "expr": "r | p + 1",
      "id": "A183_C30",
      "type": "derived"
    },
    {
      "expr": "r ≥ p",
      "id": "A183_C31",
      "type": "derived"
    },
    {
      "expr": "if r = p then p | p^q + 1 ≡ 1 mod p, contradiction",
      "id": "A183_C32",
      "type": "derived"
    },
    {
      "expr": "if r > p then 0 < p + 1 < r",
      "id": "A183_C33",
      "type": "derived"
    },
    {
      "expr": "r cannot divide p + 1",
      "id": "A183_C34",
      "type": "derived"
    },
    {
      "expr": "contradiction for odd min case",
      "id": "A183_C35",
      "type": "derived"
    },
    {
      "expr": "min(p, q, r) = 2",
      "id": "A183_C36",
      "type": "derived"
    },
    {
      "expr": "case p = 2",
      "id": "A183_C37",
      "type": "derived"
    },
    {
      "expr": "2 | q^r + 1 always true",
      "id": "A183_C38",
      "type": "derived"
    },
    {
      "expr": "q | r^2 + 1",
      "id": "A183_C39",
      "type": "derived"
    },
    {
      "expr": "r | 2^q + 1",
      "id": "A183_C40",
      "type": "derived"
    },
    {
      "expr": "2^q ≡ -1 mod r",
      "id": "A183_C41",
      "type": "derived"
    },
    {
      "expr": "2^{2q} ≡ 1 mod r",
      "id": "A183_C42",
      "type": "derived"
    },
    {
      "expr": "ord_r(2) | 2q",
      "id": "A183_C43",
      "type": "derived"
    },
    {
      "expr": "ord_r(2) does not divide q",
      "id": "A183_C44",
      "type": "derived"
    },
    {
      "expr": "q is odd prime",
      "id": "A183_C45",
      "type": "derived"
    },
    {
      "expr": "divisors of 2q are 1,2,q,2q",
      "id": "A183_C46",
      "type": "derived"
    },
    {
      "expr": "ord_r(2) = 2 or 2q",
      "id": "A183_C47",
      "type": "derived"
    },
    {
      "expr": "assume ord_r(2) = 2q",
      "id": "A183_C48",
      "type": "derived"
    },
    {
      "expr": "2q | r - 1",
      "id": "A183_C49",
      "type": "derived"
    },
    {
      "expr": "r ≡ 1 mod 2q",
      "id": "A183_C50",
      "type": "derived"
    },
    {
      "expr": "r ≡ 1 mod q",
      "id": "A183_C51",
      "type": "derived"
    },
    {
      "expr": "r^2 ≡ 1 mod q",
      "id": "A183_C52",
      "type": "derived"
    },
    {
      "expr": "r^2 + 1 ≡ 2 mod q",
      "id": "A183_C53",
      "type": "derived"
    },
    {
      "expr": "q | 2",
      "id": "A183_C54",
      "type": "derived"
    },
    {
      "expr": "contradiction since q > 2",
      "id": "A183_C55",
      "type": "derived"
    },
    {
      "expr": "ord_r(2) ≠ 2q",
      "id": "A183_C56",
      "type": "derived"
    },
    {
      "expr": "ord_r(2) = 2",
      "id": "A183_C57",
      "type": "derived"
    },
    {
      "expr": "2^2 ≡ 1 mod r",
      "id": "A183_C58",
      "type": "derived"
    },
    {
      "expr": "r | 3",
      "id": "A183_C59",
      "type": "derived"
    },
    {
      "expr": "r = 3",
      "id": "A183_C60",
      "type": "derived"
    },
    {
      "expr": "q | 10",
      "id": "A183_C61",
      "type": "derived"
    },
    {
      "expr": "q = 5 (q = 2 leads to contradiction)",
      "id": "A183_C62",
      "type": "derived"
    },
    {
      "expr": "(p, q, r) = (2, 5, 3)",
      "id": "A183_C63",
      "type": "derived"
    },
    {
      "expr": "cyclic permutations: (3, 2, 5), (5, 3, 2)",
      "id": "A183_C64",
      "type": "derived"
    },
    {
      "expr": "other permutations: (2, 3, 5), (3, 5, 2), (5, 2, 3)",
      "id": "A183_C65",
      "type": "derived"
    },
    {
      "expr": "the ordered triples are (2, 3, 5), (2, 5, 3), (3, 2, 5), (3, 5, 2), (5, 2, 3), (5, 3, 2)",
      "id": "A183_C66",
      "type": "final"
    },
    {
      "expr": "all possible values of the ratio t/s are the rational numbers in [1, n-1)",
      "id": "A1887_C1",
      "type": "derived"
    },
    {
      "expr": "n ≥ 3 is a fixed integer",
      "id": "A1887_C2",
      "type": "context"
    },
    {
      "expr": "Initially, the blackboard has n copies of 1, buckets empty",
      "id": "A1887_C3",
      "type": "context"
    },
    {
      "expr": "A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second",
      "id": "A1887_C4",
      "type": "context"
    },
    {
      "expr": "s = number of moves",
      "id": "A1887_C5",
      "type": "derived"
    },
    {
      "expr": "t = sum of gcd(a,b) over all moves",
      "id": "A1887_C6",
      "type": "derived"
    },
    {
      "expr": "gcd(a,b) ≥ 1 for every move since a,b positive integers ≥1",
      "id": "A1887_C7",
      "type": "derived"
    },
    {
      "expr": "t ≥ s",
      "id": "A1887_C8",
      "type": "derived"
    },
    {
      "expr": "t/s ≥ 1",
      "id": "A1887_C9",
      "type": "derived"
    },
    {
      "expr": "Let p be the sum of numbers on the blackboard; each move increases p by 1",
      "id": "A1887_C10",
      "type": "derived"
    },
    {
      "expr": "p = n + s",
      "id": "A1887_C11",
      "type": "derived"
    },
    {
      "expr": "Define q = ∑_{i=1}^n (i-1) a_i where a_1, ..., a_n are the numbers left to right",
      "id": "A1887_C12",
      "type": "derived"
    },
    {
      "expr": "Since each a_i ≥ 1, q ≤ (n-1) p - ∑_{k=1}^{n-1} k = (n-1)p - n(n-1)/2",
      "id": "A1887_C13",
      "type": "derived"
    },
    {
      "expr": "q ≤ (n-1)s + n(n-1)/2",
      "id": "A1887_C14",
      "type": "derived"
    },
    {
      "expr": "When erasing a_i, a_j with i < j and replacing a+b in right position, Δq ≥ a_i ≥ gcd(a_i, a_j) = Δt",
      "id": "A1887_C15",
      "type": "derived"
    },
    {
      "expr": "q - t is non-decreasing",
      "id": "A1887_C16",
      "type": "derived"
    },
    {
      "expr": "First move on two rightmost 1s gives q = (n+2)(n-1)/2, t=1",
      "id": "A1887_C17",
      "type": "derived"
    },
    {
      "expr": "After first move, q - t = (n+2)(n-1)/2 - 1",
      "id": "A1887_C18",
      "type": "derived"
    },
    {
      "expr": "q - t ≥ (n+2)(n-1)/2 - 1 always",
      "id": "A1887_C19",
      "type": "derived"
    },
    {
      "expr": "t ≤ q - [(n+2)(n-1)/2 - 1] ≤ (n-1)s + n(n-1)/2 - (n+2)(n-1)/2 + 1 = (n-1)s - (n-1) + 1 < (n-1)s",
      "id": "A1887_C20",
      "type": "derived"
    },
    {
      "expr": "t/s < n-1",
      "id": "A1887_C21",
      "type": "derived"
    },
    {
      "expr": "After one move, t=1, s=1, ratio=1",
      "id": "A1887_C22",
      "type": "derived"
    },
    {
      "expr": "By induction, possible to reach n-1 ones and a^{n-1} with s = a^{n-1} -1, t = a^{n-2}(a-1)(n-1) for integer a ≥ 2",
      "id": "A1887_C23",
      "type": "derived"
    },
    {
      "expr": "Ratio = a^{n-2}(a-1)(n-1) / (a^{n-1} -1)",
      "id": "A1887_C24",
      "type": "derived"
    },
    {
      "expr": "As a → ∞, ratio → n-1 from below",
      "id": "A1887_C25",
      "type": "derived"
    },
    {
      "expr": "b additional moves combining 1 and a^{n-1} add b to s and b to t, ratio (t_0 + b)/(s_0 + b)",
      "id": "A1887_C26",
      "type": "derived"
    },
    {
      "expr": "For fixed a ≥ 2, varying b=0,1,... gives ratios from initial down approaching 1",
      "id": "A1887_C27",
      "type": "derived"
    },
    {
      "expr": "Varying a and b densely fills (1, n-1)",
      "id": "A1887_C28",
      "type": "derived"
    },
    {
      "expr": "For rational p/q ∈ (1, n-1), choose a ≡ 1 mod (p-q), large; then b = [q a^{n-2}(a-1)(n-1) - p (a^{n-1}-1)] / (p-q) is positive integer",
      "id": "A1887_C29",
      "type": "derived"
    },
    {
      "expr": "Numerator >0 for large a since q(n-1) - p >0",
      "id": "A1887_C30",
      "type": "derived"
    },
    {
      "expr": "Every rational in (1, n-1) is achievable",
      "id": "A1887_C31",
      "type": "derived"
    },
    {
      "expr": "All rationals in [1, n-1) are achievable and no others",
      "id": "A1887_C32",
      "type": "final"
    },
    {
      "expr": "all possible values of the ratio t/s are the rational numbers in [(r - 2), n-(r - 2))",
      "id": "B1227_C1",
      "type": "goal"
    }
  ],
  "Class_ID": "B1227",
  "Connecting_Point": [
    {
      "B1227": {
        "1": "(r - 2)"
      }
    }
  ],
  "Delta_Depth": [
    {
      "A183": {
        "r": 60
      }
    },
    {
      "A1887": {
        "ratio": 22
      }
    }
  ],
  "Delta_Factor": [
    {
      "A183": 0.91
    },
    {
      "A1887": 0.69
    }
  ],
  "Delta_Socket": [
    {
      "A183": {
        "1": 1.0
      }
    },
    {
      "A1887": {
        "1": 1.0
      }
    }
  ],
  "Delta_Socket_Order": [
    {
      "A183": 1
    },
    {
      "A1887": 1
    }
  ],
  "Delta_Source": [
    {
      "A183": "derived"
    },
    {
      "A1887": "derived"
    }
  ],
  "Delta_Value": [
    {
      "A183": {
        "r": "3"
      }
    },
    {
      "A1887": {
        "ratio": "1"
      }
    }
  ],
  "Delta_Value_Order": [
    {
      "A183": 4
    },
    {
      "A1887": 2
    }
  ],
  "Delta_Variable_Names": [
    {
      "A183": [
        "r"
      ]
    },
    {
      "A1887": [
        "ratio"
      ]
    }
  ],
  "Ground_Truth": [
    {
      "A183": "(2, 3, 5), (2, 5, 3), (3, 2, 5), (3, 5, 2), (5, 2, 3), (5, 3, 2)"
    },
    {
      "A1887": "[1, n-1)"
    }
  ],
  "Math_Problem": "Find all ordered triples of primes $(p, q, r)$ such that \\[ p \\mid q^r + 1, \\quad q \\mid r^p + 1, \\quad r \\mid p^q + 1. \\] Instead of finding all ordered triples of primes satisfying the divisibility conditions, simply find $k = r - 2$, where $r$ is the prime for which the multiplicative order of 2 modulo $r$ is 2, derived from the analysis of the conditions. Let $n \\geq 3$ be a fixed integer. The number 1 is written $n$ times on a blackboard. Below the blackboard, there are two buckets that are initially empty. A move consists of erasing two of the numbers $a$ and $b$, replacing them with the numbers 1 and $a+b$, then adding one stone to the first bucket and $\\gcd(a, b)$ stones to the second bucket. After some finite number of moves, there are $s$ stones in the first bucket and $t$ stones in the second bucket, where $s$ and $t$ are positive integers. Find all possible values of the ratio $\\frac{t}{s}$.",
  "Max_Delta_Depth": [
    {
      "A183": 60
    },
    {
      "A1887": 22
    }
  ],
  "Max_Delta_Factor": [
    {
      "A183": 0.91
    },
    {
      "A1887": 0.69
    }
  ],
  "Min_Delta_Depth": [
    {
      "A183": 19
    },
    {
      "A1887": 17
    }
  ],
  "Min_Delta_Factor": [
    {
      "A183": 0.29
    },
    {
      "A1887": 0.53
    }
  ],
  "Multiple_Synthesis_Class": "MP2",
  "Predicted_Answer": [
    {
      "A183": "(2, 3, 5), (2, 5, 3), (3, 2, 5), (3, 5, 2), (5, 2, 3), (5, 3, 2)"
    },
    {
      "A1887": "[1, n-1)"
    }
  ],
  "Problem_ID": 3,
  "Problem_Length": [
    {
      "A183": 142
    },
    {
      "A1887": 590
    }
  ],
  "Problem_Level": [
    {
      "A183": "KbsdJames_Omni-MATH_7.0"
    },
    {
      "A1887": "KbsdJames_Omni-MATH_7.0"
    }
  ],
  "Problem_Source": [
    {
      "A183": "usa_team_selection_test"
    },
    {
      "A1887": "apmoapmo_sol"
    }
  ],
  "Problem_Type": [
    {
      "A183": [
        "Mathematics -> Number Theory -> Prime Numbers",
        "Mathematics -> Number Theory -> Congruences"
      ]
    },
    {
      "A1887": [
        "Mathematics -> Number Theory -> Other",
        "Mathematics -> Algebra -> Other",
        "Mathematics -> Discrete Mathematics -> Algorithms"
      ]
    }
  ],
  "Source_Delta_Socket": [
    {
      "A183": "goal"
    },
    {
      "A1887": "goal"
    }
  ],
  "Steps": [
    {
      "conclusions": [
        "A183_C2: p, q, r are prime numbers",
        "A183_C3: p | q^r + 1",
        "A183_C4: q | r^p + 1",
        "A183_C5: r | p^q + 1"
      ],
      "id": "A183_S1",
      "premises": [
        "A183_C1: find all ordered prime triples (p, q, r) such that p | q^r + 1 ∧ q | r^p + 1 ∧ r | p^q + 1"
      ],
      "rule": "problem setup"
    },
    {
      "conclusions": [
        "A183_C6: assume p = min(p, q, r) and p ≠ 2"
      ],
      "id": "A183_S2",
      "premises": [
        "A183_C2: p, q, r are prime numbers"
      ],
      "rule": "case assumption odd min"
    },
    {
      "conclusions": [
        "A183_C7: q^r ≡ -1 mod p"
      ],
      "id": "A183_S3",
      "premises": [
        "A183_C3: p | q^r + 1"
      ],
      "rule": "divisibility to congruence"
    },
    {
      "conclusions": [
        "A183_C8: q^{2r} ≡ 1 mod p"
      ],
      "id": "A183_S4",
      "premises": [
        "A183_C7: q^r ≡ -1 mod p"
      ],
      "rule": "squaring congruence"
    },
    {
      "conclusions": [
        "A183_C9: ord_p(q) | 2r"
      ],
      "id": "A183_S5",
      "premises": [
        "A183_C8: q^{2r} ≡ 1 mod p"
      ],
      "rule": "order divides exponent for 1"
    },
    {
      "conclusions": [
        "A183_C10: ord_p(q) does not divide r"
      ],
      "id": "A183_S6",
      "premises": [
        "A183_C7: q^r ≡ -1 mod p"
      ],
      "rule": "order does not divide for -1"
    },
    {
      "conclusions": [
        "A183_C11: r is odd"
      ],
      "id": "A183_S7",
      "premises": [
        "A183_C6: assume p = min(p, q, r) and p ≠ 2"
      ],
      "rule": "min odd implies r odd"
    },
    {
      "conclusions": [
        "A183_C12: divisors of 2r are 1,2,r,2r"
      ],
      "id": "A183_S8",
      "premises": [
        "A183_C11: r is odd"
      ],
      "rule": "list divisors"
    },
    {
      "conclusions": [
        "A183_C13: ord_p(q) = 2 or 2r"
      ],
      "id": "A183_S9",
      "premises": [
        "A183_C9: ord_p(q) | 2r",
        "A183_C10: ord_p(q) does not divide r",
        "A183_C12: divisors of 2r are 1,2,r,2r"
      ],
      "rule": "possible orders from divisors and conditions"
    },
    {
      "conclusions": [
        "A183_C14: ord_p(q) | p-1"
      ],
      "id": "A183_S10",
      "premises": [
        "A183_C2: p, q, r are prime numbers"
      ],
      "rule": "order divides phi(p)"
    },
    {
      "conclusions": [
        "A183_C15: p ≤ q and p ≤ r"
      ],
      "id": "A183_S11",
      "premises": [
        "A183_C6: assume p = min(p, q, r) and p ≠ 2"
      ],
      "rule": "min definition"
    },
    {
      "conclusions": [
        "A183_C16: p-1 < p ≤ r"
      ],
      "id": "A183_S12",
      "premises": [
        "A183_C15: p ≤ q and p ≤ r"
      ],
      "rule": "inequality from min"
    },
    {
      "conclusions": [
        "A183_C17: ord_p(q) ≤ p-1 < r < 2r"
      ],
      "id": "A183_S13",
      "premises": [
        "A183_C14: ord_p(q) | p-1",
        "A183_C16: p-1 < p ≤ r"
      ],
      "rule": "combine order bound and inequality"
    },
    {
      "conclusions": [
        "A183_C18: ord_p(q) ≠ 2r"
      ],
      "id": "A183_S14",
      "premises": [
        "A183_C17: ord_p(q) ≤ p-1 < r < 2r"
      ],
      "rule": "eliminate 2r"
    },
    {
      "conclusions": [
        "A183_C19: ord_p(q) = 2"
      ],
      "id": "A183_S15",
      "premises": [
        "A183_C13: ord_p(q) = 2 or 2r",
        "A183_C18: ord_p(q) ≠ 2r"
      ],
      "rule": "deduce order=2"
    },
    {
      "conclusions": [
        "A183_C20: q^2 ≡ 1 mod p"
      ],
      "id": "A183_S16",
      "premises": [
        "A183_C19: ord_p(q) = 2"
      ],
      "rule": "order 2 implies square 1"
    },
    {
      "conclusions": [
        "A183_C21: (q-1)(q+1) ≡ 0 mod p"
      ],
      "id": "A183_S17",
      "premises": [
        "A183_C20: q^2 ≡ 1 mod p"
      ],
      "rule": "factorization"
    },
    {
      "conclusions": [
        "A183_C22: p | (q-1)(q+1)"
      ],
      "id": "A183_S18",
      "premises": [
        "A183_C21: (q-1)(q+1) ≡ 0 mod p"
      ],
      "rule": "divisibility of product"
    },
    {
      "conclusions": [
        "A183_C23: p ≠ q"
      ],
      "id": "A183_S19",
      "premises": [
        "A183_C7: q^r ≡ -1 mod p"
      ],
      "rule": "primes distinct from congruence ≠0"
    },
    {
      "conclusions": [
        "A183_C24: if p | q-1 then q ≡ 1 mod p"
      ],
      "id": "A183_S20",
      "premises": [
        "A183_C22: p | (q-1)(q+1)"
      ],
      "rule": "divisibility implies congruence"
    },
    {
      "conclusions": [
        "A183_C25: if q ≡ 1 mod p then q^r ≡ 1 mod p"
      ],
      "id": "A183_S21",
      "premises": [
        "A183_C24: if p | q-1 then q ≡ 1 mod p"
      ],
      "rule": "power congruence"
    },
    {
      "conclusions": [
        "A183_C26: q^r ≡ 1 mod p contradicts q^r ≡ -1 mod p"
      ],
      "id": "A183_S22",
      "premises": [
        "A183_C25: if q ≡ 1 mod p then q^r ≡ 1 mod p",
        "A183_C7: q^r ≡ -1 mod p"
      ],
      "rule": "contradiction with original"
    },
    {
      "conclusions": [
        "A183_C27: p does not divide q-1"
      ],
      "id": "A183_S23",
      "premises": [
        "A183_C22: p | (q-1)(q+1)",
        "A183_C26: q^r ≡ 1 mod p contradicts q^r ≡ -1 mod p"
      ],
      "rule": "eliminate one factor"
    },
    {
      "conclusions": [
        "A183_C28: p | q + 1"
      ],
      "id": "A183_S24",
      "premises": [
        "A183_C22: p | (q-1)(q+1)",
        "A183_C27: p does not divide q-1"
      ],
      "rule": "remaining factor"
    },
    {
      "conclusions": [
        "A183_C29: q | r + 1"
      ],
      "id": "A183_S25",
      "premises": [
        "A183_C4: q | r^p + 1"
      ],
      "rule": "similar order reasoning"
    },
    {
      "conclusions": [
        "A183_C30: r | p + 1"
      ],
      "id": "A183_S26",
      "premises": [
        "A183_C5: r | p^q + 1"
      ],
      "rule": "similar order reasoning"
    },
    {
      "conclusions": [
        "A183_C31: r ≥ p"
      ],
      "id": "A183_S27",
      "premises": [
        "A183_C6: assume p = min(p, q, r) and p ≠ 2"
      ],
      "rule": "from min"
    },
    {
      "conclusions": [
        "A183_C32: if r = p then p | p^q + 1 ≡ 1 mod p, contradiction"
      ],
      "id": "A183_S28",
      "premises": [
        "A183_C30: r | p + 1",
        "A183_C5: r | p^q + 1"
      ],
      "rule": "substitution in condition"
    },
    {
      "conclusions": [
        "A183_C33: if r > p then 0 < p + 1 < r"
      ],
      "id": "A183_S29",
      "premises": [
        "A183_C31: r ≥ p"
      ],
      "rule": "inequality"
    },
    {
      "conclusions": [
        "A183_C34: r cannot divide p + 1"
      ],
      "id": "A183_S30",
      "premises": [
        "A183_C33: if r > p then 0 < p + 1 < r",
        "A183_C30: r | p + 1"
      ],
      "rule": "prime cannot divide smaller positive integer"
    },
    {
      "conclusions": [
        "A183_C35: contradiction for odd min case"
      ],
      "id": "A183_S31",
      "premises": [
        "A183_C32: if r = p then p | p^q + 1 ≡ 1 mod p, contradiction",
        "A183_C34: r cannot divide p + 1"
      ],
      "rule": "case contradiction"
    },
    {
      "conclusions": [
        "A183_C36: min(p, q, r) = 2"
      ],
      "id": "A183_S32",
      "premises": [
        "A183_C6: assume p = min(p, q, r) and p ≠ 2",
        "A183_C35: contradiction for odd min case"
      ],
      "rule": "deduce min=2"
    },
    {
      "conclusions": [
        "A183_C37: case p = 2"
      ],
      "id": "A183_S33",
      "premises": [
        "A183_C36: min(p, q, r) = 2"
      ],
      "rule": "case p=2"
    },
    {
      "conclusions": [
        "A183_C38: 2 | q^r + 1 always true"
      ],
      "id": "A183_S34",
      "premises": [
        "A183_C3: p | q^r + 1",
        "A183_C37: case p = 2"
      ],
      "rule": "parity argument"
    },
    {
      "conclusions": [
        "A183_C39: q | r^2 + 1"
      ],
      "id": "A183_S35",
      "premises": [
        "A183_C4: q | r^p + 1",
        "A183_C37: case p = 2"
      ],
      "rule": "substitute p=2"
    },
    {
      "conclusions": [
        "A183_C40: r | 2^q + 1"
      ],
      "id": "A183_S36",
      "premises": [
        "A183_C5: r | p^q + 1",
        "A183_C37: case p = 2"
      ],
      "rule": "substitute p=2"
    },
    {
      "conclusions": [
        "A183_C41: 2^q ≡ -1 mod r"
      ],
      "id": "A183_S37",
      "premises": [
        "A183_C40: r | 2^q + 1"
      ],
      "rule": "divisibility to congruence"
    },
    {
      "conclusions": [
        "A183_C42: 2^{2q} ≡ 1 mod r"
      ],
      "id": "A183_S38",
      "premises": [
        "A183_C41: 2^q ≡ -1 mod r"
      ],
      "rule": "squaring"
    },
    {
      "conclusions": [
        "A183_C43: ord_r(2) | 2q"
      ],
      "id": "A183_S39",
      "premises": [
        "A183_C42: 2^{2q} ≡ 1 mod r"
      ],
      "rule": "order divides"
    },
    {
      "conclusions": [
        "A183_C44: ord_r(2) does not divide q"
      ],
      "id": "A183_S40",
      "premises": [
        "A183_C41: 2^q ≡ -1 mod r"
      ],
      "rule": "order not divides"
    },
    {
      "conclusions": [
        "A183_C45: q is odd prime"
      ],
      "id": "A183_S41",
      "premises": [
        "A183_C2: p, q, r are prime numbers",
        "A183_C37: case p = 2"
      ],
      "rule": "q >2 since min=2"
    },
    {
      "conclusions": [
        "A183_C46: divisors of 2q are 1,2,q,2q"
      ],
      "id": "A183_S42",
      "premises": [
        "A183_C45: q is odd prime"
      ],
      "rule": "list divisors"
    },
    {
      "conclusions": [
        "A183_C47: ord_r(2) = 2 or 2q"
      ],
      "id": "A183_S43",
      "premises": [
        "A183_C43: ord_r(2) | 2q",
        "A183_C44: ord_r(2) does not divide q",
        "A183_C46: divisors of 2q are 1,2,q,2q"
      ],
      "rule": "possible orders"
    },
    {
      "conclusions": [
        "A183_C48: assume ord_r(2) = 2q"
      ],
      "id": "A183_S44",
      "premises": [
        "A183_C47: ord_r(2) = 2 or 2q"
      ],
      "rule": "subcase assumption"
    },
    {
      "conclusions": [
        "A183_C49: 2q | r - 1"
      ],
      "id": "A183_S45",
      "premises": [
        "A183_C48: assume ord_r(2) = 2q"
      ],
      "rule": "order divides phi(r)"
    },
    {
      "conclusions": [
        "A183_C50: r ≡ 1 mod 2q"
      ],
      "id": "A183_S46",
      "premises": [
        "A183_C49: 2q | r - 1"
      ],
      "rule": "congruence from divisibility"
    },
    {
      "conclusions": [
        "A183_C51: r ≡ 1 mod q"
      ],
      "id": "A183_S47",
      "premises": [
        "A183_C50: r ≡ 1 mod 2q"
      ],
      "rule": "mod q reduction"
    },
    {
      "conclusions": [
        "A183_C52: r^2 ≡ 1 mod q"
      ],
      "id": "A183_S48",
      "premises": [
        "A183_C51: r ≡ 1 mod q"
      ],
      "rule": "squaring"
    },
    {
      "conclusions": [
        "A183_C53: r^2 + 1 ≡ 2 mod q"
      ],
      "id": "A183_S49",
      "premises": [
        "A183_C52: r^2 ≡ 1 mod q"
      ],
      "rule": "add 1"
    },
    {
      "conclusions": [
        "A183_C54: q | 2"
      ],
      "id": "A183_S50",
      "premises": [
        "A183_C39: q | r^2 + 1",
        "A183_C53: r^2 + 1 ≡ 2 mod q"
      ],
      "rule": "from condition and congruence"
    },
    {
      "conclusions": [
        "A183_C55: contradiction since q > 2"
      ],
      "id": "A183_S51",
      "premises": [
        "A183_C2: p, q, r are prime numbers",
        "A183_C45: q is odd prime"
      ],
      "rule": "prime cannot divide 2"
    },
    {
      "conclusions": [
        "A183_C56: ord_r(2) ≠ 2q"
      ],
      "id": "A183_S52",
      "premises": [
        "A183_C48: assume ord_r(2) = 2q",
        "A183_C55: contradiction since q > 2"
      ],
      "rule": "subcase contradiction"
    },
    {
      "conclusions": [
        "A183_C57: ord_r(2) = 2"
      ],
      "id": "A183_S53",
      "premises": [
        "A183_C47: ord_r(2) = 2 or 2q",
        "A183_C56: ord_r(2) ≠ 2q"
      ],
      "rule": "deduce order=2"
    },
    {
      "conclusions": [
        "A183_C58: 2^2 ≡ 1 mod r"
      ],
      "id": "A183_S54",
      "premises": [
        "A183_C57: ord_r(2) = 2"
      ],
      "rule": "power 2"
    },
    {
      "conclusions": [
        "A183_C59: r | 3"
      ],
      "id": "A183_S55",
      "premises": [
        "A183_C58: 2^2 ≡ 1 mod r"
      ],
      "rule": "subtract 1"
    },
    {
      "conclusions": [
        "A183_C60: r = 3"
      ],
      "id": "A183_S56",
      "premises": [
        "A183_C59: r | 3",
        "A183_C2: p, q, r are prime numbers"
      ],
      "rule": "prime divisor"
    },
    {
      "conclusions": [
        "A183_C61: q | 10"
      ],
      "id": "A183_S57",
      "premises": [
        "A183_C39: q | r^2 + 1",
        "A183_C60: r = 3"
      ],
      "rule": "substitute r=3"
    },
    {
      "conclusions": [
        "A183_C62: q = 5 (q = 2 leads to contradiction)"
      ],
      "id": "A183_S58",
      "premises": [
        "A183_C61: q | 10",
        "A183_C2: p, q, r are prime numbers"
      ],
      "rule": "possible primes dividing 10, discard q=2 by check"
    },
    {
      "conclusions": [
        "A183_C63: (p, q, r) = (2, 5, 3)"
      ],
      "id": "A183_S59",
      "premises": [
        "A183_C37: case p = 2",
        "A183_C62: q = 5 (q = 2 leads to contradiction)",
        "A183_C60: r = 3"
      ],
      "rule": "construct triple"
    },
    {
      "conclusions": [
        "A183_C64: cyclic permutations: (3, 2, 5), (5, 3, 2)"
      ],
      "id": "A183_S60",
      "premises": [
        "A183_C63: (p, q, r) = (2, 5, 3)"
      ],
      "rule": "cyclic symmetry"
    },
    {
      "conclusions": [
        "A183_C65: other permutations: (2, 3, 5), (3, 5, 2), (5, 2, 3)"
      ],
      "id": "A183_S61",
      "premises": [
        "A183_C63: (p, q, r) = (2, 5, 3)"
      ],
      "rule": "other symmetry"
    },
    {
      "conclusions": [
        "A183_C66: the ordered triples are (2, 3, 5), (2, 5, 3), (3, 2, 5), (3, 5, 2), (5, 2, 3), (5, 3, 2)"
      ],
      "id": "A183_S62",
      "premises": [
        "A183_C63: (p, q, r) = (2, 5, 3)",
        "A183_C64: cyclic permutations: (3, 2, 5), (5, 3, 2)",
        "A183_C65: other permutations: (2, 3, 5), (3, 5, 2), (5, 2, 3)"
      ],
      "rule": "combine all"
    },
    {
      "conclusions": [
        "A1887_C2: n ≥ 3 is a fixed integer",
        "A1887_C3: Initially, the blackboard has n copies of 1, buckets empty",
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second"
      ],
      "id": "A1887_S1",
      "premises": [
        "A1887_C1: all possible values of the ratio t/s are the rational numbers in [1, n-1)"
      ],
      "rule": "problem setup"
    },
    {
      "conclusions": [
        "A1887_C5: s = number of moves"
      ],
      "id": "A1887_S2",
      "premises": [
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second"
      ],
      "rule": "definition of s"
    },
    {
      "conclusions": [
        "A1887_C6: t = sum of gcd(a,b) over all moves"
      ],
      "id": "A1887_S3",
      "premises": [
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second"
      ],
      "rule": "definition of t"
    },
    {
      "conclusions": [
        "A1887_C7: gcd(a,b) ≥ 1 for every move since a,b positive integers ≥1"
      ],
      "id": "A1887_S4",
      "premises": [
        "A1887_C3: Initially, the blackboard has n copies of 1, buckets empty",
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second"
      ],
      "rule": "property of gcd"
    },
    {
      "conclusions": [
        "A1887_C8: t ≥ s"
      ],
      "id": "A1887_S5",
      "premises": [
        "A1887_C5: s = number of moves",
        "A1887_C7: gcd(a,b) ≥ 1 for every move since a,b positive integers ≥1"
      ],
      "rule": "summing inequalities"
    },
    {
      "conclusions": [
        "A1887_C9: t/s ≥ 1"
      ],
      "id": "A1887_S6",
      "premises": [
        "A1887_C8: t ≥ s",
        "A1887_C5: s = number of moves"
      ],
      "rule": "ratio bound"
    },
    {
      "conclusions": [
        "A1887_C10: Let p be the sum of numbers on the blackboard; each move increases p by 1",
        "A1887_C11: p = n + s"
      ],
      "id": "A1887_S7",
      "premises": [
        "A1887_C3: Initially, the blackboard has n copies of 1, buckets empty",
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second"
      ],
      "rule": "sum evolution"
    },
    {
      "conclusions": [
        "A1887_C12: Define q = ∑_{i=1}^n (i-1) a_i where a_1, ..., a_n are the numbers left to right"
      ],
      "id": "A1887_S8",
      "premises": [
        "A1887_C3: Initially, the blackboard has n copies of 1, buckets empty"
      ],
      "rule": "definition of q"
    },
    {
      "conclusions": [
        "A1887_C13: Since each a_i ≥ 1, q ≤ (n-1) p - ∑_{k=1}^{n-1} k = (n-1)p - n(n-1)/2"
      ],
      "id": "A1887_S9",
      "premises": [
        "A1887_C12: Define q = ∑_{i=1}^n (i-1) a_i where a_1, ..., a_n are the numbers left to right",
        "A1887_C3: Initially, the blackboard has n copies of 1, buckets empty"
      ],
      "rule": "upper bound on q"
    },
    {
      "conclusions": [
        "A1887_C14: q ≤ (n-1)s + n(n-1)/2"
      ],
      "id": "A1887_S10",
      "premises": [
        "A1887_C13: Since each a_i ≥ 1, q ≤ (n-1) p - ∑_{k=1}^{n-1} k = (n-1)p - n(n-1)/2",
        "A1887_C11: p = n + s"
      ],
      "rule": "substitution"
    },
    {
      "conclusions": [
        "A1887_C15: When erasing a_i, a_j with i < j and replacing a+b in right position, Δq ≥ a_i ≥ gcd(a_i, a_j) = Δt"
      ],
      "id": "A1887_S11",
      "premises": [
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second",
        "A1887_C12: Define q = ∑_{i=1}^n (i-1) a_i where a_1, ..., a_n are the numbers left to right"
      ],
      "rule": "change in q and t"
    },
    {
      "conclusions": [
        "A1887_C16: q - t is non-decreasing"
      ],
      "id": "A1887_S12",
      "premises": [
        "A1887_C15: When erasing a_i, a_j with i < j and replacing a+b in right position, Δq ≥ a_i ≥ gcd(a_i, a_j) = Δt"
      ],
      "rule": "non-decreasing property"
    },
    {
      "conclusions": [
        "A1887_C17: First move on two rightmost 1s gives q = (n+2)(n-1)/2, t=1"
      ],
      "id": "A1887_S13",
      "premises": [
        "A1887_C3: Initially, the blackboard has n copies of 1, buckets empty",
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second"
      ],
      "rule": "specific first move"
    },
    {
      "conclusions": [
        "A1887_C18: After first move, q - t = (n+2)(n-1)/2 - 1"
      ],
      "id": "A1887_S14",
      "premises": [
        "A1887_C17: First move on two rightmost 1s gives q = (n+2)(n-1)/2, t=1"
      ],
      "rule": "compute initial q-t"
    },
    {
      "conclusions": [
        "A1887_C19: q - t ≥ (n+2)(n-1)/2 - 1 always"
      ],
      "id": "A1887_S15",
      "premises": [
        "A1887_C16: q - t is non-decreasing",
        "A1887_C18: After first move, q - t = (n+2)(n-1)/2 - 1"
      ],
      "rule": "general bound"
    },
    {
      "conclusions": [
        "A1887_C20: t ≤ q - [(n+2)(n-1)/2 - 1] ≤ (n-1)s + n(n-1)/2 - (n+2)(n-1)/2 + 1 = (n-1)s - (n-1) + 1 < (n-1)s"
      ],
      "id": "A1887_S16",
      "premises": [
        "A1887_C19: q - t ≥ (n+2)(n-1)/2 - 1 always",
        "A1887_C14: q ≤ (n-1)s + n(n-1)/2"
      ],
      "rule": "inequality chaining"
    },
    {
      "conclusions": [
        "A1887_C21: t/s < n-1"
      ],
      "id": "A1887_S17",
      "premises": [
        "A1887_C20: t ≤ q - [(n+2)(n-1)/2 - 1] ≤ (n-1)s + n(n-1)/2 - (n+2)(n-1)/2 + 1 = (n-1)s - (n-1) + 1 < (n-1)s",
        "A1887_C5: s = number of moves"
      ],
      "rule": "upper ratio bound"
    },
    {
      "conclusions": [
        "A1887_C22: After one move, t=1, s=1, ratio=1"
      ],
      "id": "A1887_S18",
      "premises": [
        "A1887_C3: Initially, the blackboard has n copies of 1, buckets empty",
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second"
      ],
      "rule": "single move example"
    },
    {
      "conclusions": [
        "A1887_C23: By induction, possible to reach n-1 ones and a^{n-1} with s = a^{n-1} -1, t = a^{n-2}(a-1)(n-1) for integer a ≥ 2"
      ],
      "id": "A1887_S19",
      "premises": [
        "A1887_C2: n ≥ 3 is a fixed integer",
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second"
      ],
      "rule": "inductive construction"
    },
    {
      "conclusions": [
        "A1887_C24: Ratio = a^{n-2}(a-1)(n-1) / (a^{n-1} -1)"
      ],
      "id": "A1887_S20",
      "premises": [
        "A1887_C23: By induction, possible to reach n-1 ones and a^{n-1} with s = a^{n-1} -1, t = a^{n-2}(a-1)(n-1) for integer a ≥ 2"
      ],
      "rule": "compute ratio"
    },
    {
      "conclusions": [
        "A1887_C25: As a → ∞, ratio → n-1 from below"
      ],
      "id": "A1887_S21",
      "premises": [
        "A1887_C24: Ratio = a^{n-2}(a-1)(n-1) / (a^{n-1} -1)"
      ],
      "rule": "asymptotic limit"
    },
    {
      "conclusions": [
        "A1887_C26: b additional moves combining 1 and a^{n-1} add b to s and b to t, ratio (t_0 + b)/(s_0 + b)"
      ],
      "id": "A1887_S22",
      "premises": [
        "A1887_C23: By induction, possible to reach n-1 ones and a^{n-1} with s = a^{n-1} -1, t = a^{n-2}(a-1)(n-1) for integer a ≥ 2",
        "A1887_C4: A move erases a and b, writes 1 and a+b, adds 1 to first bucket, gcd(a,b) to second"
      ],
      "rule": "additional moves"
    },
    {
      "conclusions": [
        "A1887_C27: For fixed a ≥ 2, varying b=0,1,... gives ratios from initial down approaching 1"
      ],
      "id": "A1887_S23",
      "premises": [
        "A1887_C26: b additional moves combining 1 and a^{n-1} add b to s and b to t, ratio (t_0 + b)/(s_0 + b)"
      ],
      "rule": "effect of b"
    },
    {
      "conclusions": [
        "A1887_C28: Varying a and b densely fills (1, n-1)"
      ],
      "id": "A1887_S24",
      "premises": [
        "A1887_C25: As a → ∞, ratio → n-1 from below",
        "A1887_C27: For fixed a ≥ 2, varying b=0,1,... gives ratios from initial down approaching 1"
      ],
      "rule": "dense filling"
    },
    {
      "conclusions": [
        "A1887_C29: For rational p/q ∈ (1, n-1), choose a ≡ 1 mod (p-q), large; then b = [q a^{n-2}(a-1)(n-1) - p (a^{n-1}-1)] / (p-q) is positive integer"
      ],
      "id": "A1887_S25",
      "premises": [
        "A1887_C24: Ratio = a^{n-2}(a-1)(n-1) / (a^{n-1} -1)",
        "A1887_C26: b additional moves combining 1 and a^{n-1} add b to s and b to t, ratio (t_0 + b)/(s_0 + b)"
      ],
      "rule": "choice of a and b for rational"
    },
    {
      "conclusions": [
        "A1887_C30: Numerator >0 for large a since q(n-1) - p >0"
      ],
      "id": "A1887_S26",
      "premises": [
        "A1887_C29: For rational p/q ∈ (1, n-1), choose a ≡ 1 mod (p-q), large; then b = [q a^{n-2}(a-1)(n-1) - p (a^{n-1}-1)] / (p-q) is positive integer"
      ],
      "rule": "positivity of numerator"
    },
    {
      "conclusions": [
        "A1887_C31: Every rational in (1, n-1) is achievable"
      ],
      "id": "A1887_S27",
      "premises": [
        "A1887_C29: For rational p/q ∈ (1, n-1), choose a ≡ 1 mod (p-q), large; then b = [q a^{n-2}(a-1)(n-1) - p (a^{n-1}-1)] / (p-q) is positive integer",
        "A1887_C30: Numerator >0 for large a since q(n-1) - p >0"
      ],
      "rule": "achievability of rationals"
    },
    {
      "conclusions": [
        "A1887_C32: All rationals in [1, n-1) are achievable and no others"
      ],
      "id": "A1887_S28",
      "premises": [
        "A1887_C9: t/s ≥ 1",
        "A1887_C21: t/s < n-1",
        "A1887_C22: After one move, t=1, s=1, ratio=1",
        "A1887_C31: Every rational in (1, n-1) is achievable"
      ],
      "rule": "combine bounds and achievability"
    },
    {
      "conclusions": [
        "A1887_C1: all possible values of the ratio t/s are the rational numbers in [1, n-1)"
      ],
      "id": "B1227_S1",
      "premises": [
        "B1227_C1: all possible values of the ratio t/s are the rational numbers in [(r - 2), n-(r - 2))",
        "A183_C60: r = 3"
      ],
      "rule": "problem connection"
    }
  ],
  "Sub_Class_ID": [
    {
      "A183": "A183_DG_4"
    },
    {
      "A1887": "A1887_DG_2"
    }
  ],
  "Synthesis_Status": "Continuable",
  "Synthesis_Trace": "DG-DG",
  "Synthesised_By": [
    {
      "A183": "Find all ordered triples of primes $(p, q, r)$ such that \\[ p \\mid q^r + 1, \\quad q \\mid r^p + 1, \\quad r \\mid p^q + 1.  \\] [i]Reid Barton[/i]"
    },
    {
      "A1887": "Let \\(n \\geq 3\\) be a fixed integer. The number 1 is written \\(n\\) times on a blackboard. Below the blackboard, there are two buckets that are initially empty. A move consists of erasing two of the numbers \\(a\\) and \\(b\\), replacing them with the numbers 1 and \\(a+b\\), then adding one stone to the first bucket and \\(\\operatorname{gcd}(a, b)\\) stones to the second bucket. After some finite number of moves, there are \\(s\\) stones in the first bucket and \\(t\\) stones in the second bucket, where \\(s\\) and \\(t\\) are positive integers. Find all possible values of the ratio \\(\\frac{t}{s}\\)."
    }
  ],
  "Synthesised_Problem_Length": 916,
  "Total_Claims": [
    {
      "A183": 66
    },
    {
      "A1887": 32
    }
  ],
  "Total_Delta": [
    {
      "A183": 4
    },
    {
      "A1887": 2
    }
  ],
  "Total_Delta_Socket": [
    {
      "A183": 1
    },
    {
      "A1887": 1
    }
  ],
  "Variable_Names": [
    {
      "A183": [
        "p",
        "q",
        "r"
      ]
    },
    {
      "A1887": []
    }
  ]
}
